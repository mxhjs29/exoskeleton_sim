{"timers": {"training_iteration": 17.28369329399993, "restore_env_runners": 4.413400006342272e-05, "training_step": 17.283313837999913, "env_runner_sampling_timer": 13.961110178999888, "learner_update_timer": 3.318034647000104, "synch_weights": 0.0030564040000626846}, "env_runners": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 7.925899990368634e-05, "add_states_from_episodes_to_batch": 8.645999969303375e-06, "batch_individual_items": 5.6405999885100755e-05, "agent_to_module_mapping": 1.0039000017059152e-05, "numpy_to_tensor": 0.00010273399993820931, "add_time_dim_to_batch_and_zero_pad": 3.068799992433924e-05}}, "num_episodes_lifetime": 2, "episode_len_max": 1417, "num_agent_steps_sampled": {"human": 2834, "exo": 2834}, "env_to_module_connector": {"timers": {"connectors": {"agent_to_module_mapping": 8.940057867315607e-06, "numpy_to_tensor": 8.9800274086281e-05, "add_time_dim_to_batch_and_zero_pad": 1.87212006106006e-05, "add_observations_from_episodes_to_batch": 4.343507687937516e-05, "add_states_from_episodes_to_batch": 7.817268789235849e-06, "batch_individual_items": 4.588557961430762e-05}}, "connector_pipeline_timer": 0.0003025612438098394}, "episode_return_min": 892.5872645190041, "agent_steps": {"exo": 1417.0, "human": 1417.0}, "num_module_steps_sampled_lifetime": {"exo_policy": 2834, "human_policy": 2834}, "num_module_steps_sampled": {"human_policy": 2834, "exo_policy": 2834}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 4.80745030054286e-05, "module_to_agent_unmapping": 6.803872245209003e-06, "tensor_to_numpy": 8.490083755888427e-05, "normalize_and_clip_actions": 0.00017782652313513516, "remove_single_ts_time_rank_from_batch": 2.936069338705982e-06, "get_actions": 0.0003287113524825391, "listify_data_for_vector_env": 1.9821795679143933e-05}}, "connector_pipeline_timer": 0.0007790897136739013}, "module_episode_returns_mean": {"human_policy": 411.4132264127675, "exo_policy": 482.9589611806279}, "agent_episode_returns_mean": {"exo": 482.9589611806279, "human": 411.4132264127675}, "env_to_module_sum_episodes_length_out": 2621.8301293409154, "episode_return_max": 896.1571106677868, "custom": {"human": {"R_p_mean": 0.17770004824895785, "R_proprio_mean": 0.11248872192203813, "R_a_mean": 0.00015225058607320832}, "exo": {"R_eas_mean": 0.0181118006040692, "R_t_mean": 0.03237919076351056}}, "sample": 13.931637838999904, "num_agent_steps_sampled_lifetime": {"human": 2834, "exo": 2834}, "episode_len_min": 1417, "env_step_timer": 0.005449138871032891, "connector_pipeline_timer": 0.0006909329999871261, "num_episodes": 2, "episode_duration_sec_mean": 13.818984259000104, "weights_seq_no": 0.0, "env_reset_timer": 0.055012139999917054, "episode_len_mean": 1417.0, "env_to_module_sum_episodes_length_in": 2621.8301293409154, "episode_return_mean": 894.3721875933954, "rlmodule_inference_timer": 0.000510332842709385, "num_env_steps_sampled": 2834, "num_env_steps_sampled_lifetime": 2834, "num_env_steps_sampled_lifetime_throughput": NaN}, "learners": {"exo_policy": {"num_module_steps_trained": 28416, "curr_kl_coeff": 0.30000001192092896, "vf_loss": 8.978128433227539, "entropy": 2.961426258087158, "weights_seq_no": 1.0, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 0.0005, "vf_loss_unclipped": 1034.855224609375, "module_train_batch_size_mean": 128.0, "num_module_steps_trained_lifetime": 28416, "num_trainable_parameters": 135429, "mean_kl_loss": 0.03344551473855972, "vf_explained_var": -0.09877002239227295, "total_loss": 9.062992095947266, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.0781746432185173, "num_module_steps_trained_lifetime_throughput": NaN}, "human_policy": {"module_train_batch_size_mean": 128.0, "entropy": 139.3829345703125, "num_module_steps_trained_lifetime": 28416, "num_trainable_parameters": 309701, "default_optimizer_learning_rate": 0.0005, "total_loss": 7.716414451599121, "mean_kl_loss": 0.33561837673187256, "policy_loss": -0.11444541811943054, "vf_explained_var": 0.28967010974884033, "curr_kl_coeff": 0.30000001192092896, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 7.763736724853516, "num_module_steps_trained": 28416, "weights_seq_no": 1.0, "curr_entropy_coeff": 0.0, "vf_loss_unclipped": 373.5750732421875, "num_module_steps_trained_lifetime_throughput": NaN}, "__all_modules__": {"num_module_steps_trained_lifetime": 56832, "num_env_steps_trained_lifetime": 629148, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 3.388400000403635e-05, "add_observations_from_episodes_to_batch": 8.29359998988366e-05, "add_one_ts_to_episodes_and_truncate": 0.0082097239999257, "general_advantage_estimation": 0.02916842599984193, "agent_to_module_mapping": 0.004566844000009951, "add_columns_from_episodes_to_train_batch": 0.08510332800005926, "batch_individual_items": 0.21860333000017818, "numpy_to_tensor": 0.0003111260000423499, "add_states_from_episodes_to_batch": 9.658000180934323e-06}}, "connector_pipeline_timer": 0.34691445400017074}, "num_trainable_parameters": 445130, "num_env_steps_trained": 629148, "learner_connector_sum_episodes_length_out": 2834, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 2834, "num_module_steps_trained": 56832, "num_env_steps_trained_lifetime_throughput": NaN, "num_module_steps_trained_lifetime_throughput": NaN}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 2834, "fault_tolerance": {"num_healthy_workers": 1, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 1}, "done": false, "training_iteration": 1, "trial_id": "f23a0_00000", "date": "2025-11-20_15-03-27", "timestamp": 1763622207, "time_this_iter_s": 17.289777755737305, "time_total_s": 17.289777755737305, "pid": 26352, "hostname": "CS-ubuntu", "node_ip": "10.207.136.136", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MARL_EXO_ENV", "env_config": {"render_mode": "human", "render_bool": false, "frame_skip": 2, "model_path": "/home/chenshuo/PycharmProjects/move_sim/SMPL/data/xml/mj_fullbody_with_exo_carrying_policy_test.xml", "n_stacks": 1, "human_obs_keys": ["qpos", "local_body_pos", "local_body_vel", "local_body_rot_obs", "local_body_angle_vel"], "exo_obs_keys": ["exo_joint_t", "exo_joint_vel_t"], "weighted_reward_keys": {"w_pos_err": 0.4, "w_proprio_err": 0.4, "w_activation": 0.4, "w_exo_energy": 0.2, "w_exo_smooth": 0.2, "theta_pos_err": 0.5, "theta_proprio_err": 0.3, "theta_activation": 0.3, "theta_exo_energy": 0.1, "theta_exo_smooth": 4}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 2, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 120, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 128, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f94448009d0>", "policies_to_train": ["human_policy", "exo_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"human_policy": [null, "Box(-inf, inf, (248,), float32)", "Box(0.0, 1.0, (98,), float32)", {"model": {"custom_model": "human_model"}}], "exo_policy": [null, "Box(-10.0, 10.0, (4,), float32)", "Box(-0.261799, 2.0944, (2,), float32)", {"model": {"custom_model": "exo_model"}}]}, "callbacks": "<class 'SMPL.src.Custom_CallBack.RewardLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 17.289777755737305, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 17.31304347826087, "ram_util_percent": 62.813043478260894, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.0013162364130434783}}
{"timers": {"training_iteration": 17.27889225231993, "restore_env_runners": 4.387571006418511e-05, "training_step": 17.278511334169913, "env_runner_sampling_timer": 13.95949421444989, "learner_update_timer": 3.314847736510103, "synch_weights": 0.0030573458800631672, "synch_env_connectors": 0.0021352669998577767}, "env_runners": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 7.902866990434631e-05, "add_states_from_episodes_to_batch": 8.641799968245322e-06, "batch_individual_items": 5.62849698849277e-05, "agent_to_module_mapping": 1.0022670016951451e-05, "numpy_to_tensor": 0.00010259382993808685, "add_time_dim_to_batch_and_zero_pad": 3.0585009924379846e-05}}, "num_episodes_lifetime": 4, "episode_len_max": 1417, "num_agent_steps_sampled": {"human": 2834, "exo": 2834}, "env_to_module_connector": {"timers": {"connectors": {"agent_to_module_mapping": 8.409158090285346e-06, "numpy_to_tensor": 8.474085758960895e-05, "add_time_dim_to_batch_and_zero_pad": 1.7812184491881748e-05, "add_observations_from_episodes_to_batch": 4.178351675144232e-05, "add_states_from_episodes_to_batch": 7.4678054349216505e-06, "batch_individual_items": 4.4252783227243115e-05}}, "connector_pipeline_timer": 0.0002890401275101379}, "episode_return_min": 892.5872645190041, "agent_steps": {"exo": 1417.0, "human": 1417.0}, "num_module_steps_sampled_lifetime": {"exo_policy": 5668, "human_policy": 5668}, "num_module_steps_sampled": {"human_policy": 2834, "exo_policy": 2834}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 4.655327329842555e-05, "module_to_agent_unmapping": 6.00976294917635e-06, "tensor_to_numpy": 8.045775031358656e-05, "normalize_and_clip_actions": 0.00016894832433697507, "remove_single_ts_time_rank_from_batch": 2.5642214419933686e-06, "get_actions": 0.00031397175578203745, "listify_data_for_vector_env": 1.8896914306052642e-05}}, "connector_pipeline_timer": 0.0007435050491391601}, "module_episode_returns_mean": {"human_policy": 412.30780354366397, "exo_policy": 486.9801506740221}, "agent_episode_returns_mean": {"exo": 486.9801506740221, "human": 412.30780354366397}, "env_to_module_sum_episodes_length_out": 2621.8318248904784, "episode_return_max": 904.3743241764247, "custom": {"human": {"R_p_mean": 0.17783463799814395, "R_proprio_mean": 0.11298345835483035, "R_a_mean": 0.00015424206880656626}, "exo": {"R_eas_mean": 0.01871524637032561, "R_t_mean": 0.033982246311649186}}, "sample": 13.930049305839907, "num_agent_steps_sampled_lifetime": {"human": 5668, "exo": 5668}, "episode_len_min": 1417, "env_step_timer": 0.0052324330233192344, "connector_pipeline_timer": 0.0006871481599887375, "num_episodes": 2, "episode_duration_sec_mean": 13.752769015500064, "weights_seq_no": 1.0, "env_reset_timer": 0.05482805078991759, "episode_len_mean": 1417.0, "env_to_module_sum_episodes_length_in": 2621.8318248904784, "episode_return_mean": 899.2879542176861, "rlmodule_inference_timer": 0.0004856890527829835, "num_env_steps_sampled": 2834, "num_env_steps_sampled_lifetime": 5668, "time_between_sampling": 3.39144347499996, "num_env_steps_sampled_lifetime_throughput": NaN}, "learners": {"exo_policy": {"num_module_steps_trained": 28416, "curr_kl_coeff": 0.45000001788139343, "vf_loss": 7.8817596435546875, "entropy": 2.9453887939453125, "weights_seq_no": 2.0, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 0.0005, "vf_loss_unclipped": 744.4807739257812, "module_train_batch_size_mean": 128.0, "num_module_steps_trained_lifetime": 56832, "num_trainable_parameters": 135429, "mean_kl_loss": 0.03919369354844093, "vf_explained_var": -0.05470848083496094, "total_loss": 7.933548927307129, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.040029995143413544, "num_module_steps_trained_lifetime_throughput": NaN}, "human_policy": {"module_train_batch_size_mean": 128.0, "entropy": 139.68984985351562, "num_module_steps_trained_lifetime": 56832, "num_trainable_parameters": 309701, "default_optimizer_learning_rate": 0.0005, "total_loss": 7.698354244232178, "mean_kl_loss": 0.11982457339763641, "policy_loss": -0.17805086076259613, "vf_explained_var": 0.4362446069717407, "curr_kl_coeff": 0.45000001788139343, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 7.840457916259766, "num_module_steps_trained": 28416, "weights_seq_no": 2.0, "curr_entropy_coeff": 0.0, "vf_loss_unclipped": 250.11056518554688, "num_module_steps_trained_lifetime_throughput": NaN}, "__all_modules__": {"num_module_steps_trained_lifetime": 113664, "num_env_steps_trained_lifetime": 1258296, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 3.383331000350153e-05, "add_observations_from_episodes_to_batch": 8.303217990032863e-05, "add_one_ts_to_episodes_and_truncate": 0.00817370826992601, "general_advantage_estimation": 0.02911241410984303, "agent_to_module_mapping": 0.004566428510011065, "add_columns_from_episodes_to_train_batch": 0.08507429371005855, "batch_individual_items": 0.2169322343701765, "numpy_to_tensor": 0.0003101281200406447, "add_states_from_episodes_to_batch": 9.65660017754999e-06}}, "connector_pipeline_timer": 0.3451153604501701}, "num_trainable_parameters": 445130, "num_env_steps_trained": 629148, "learner_connector_sum_episodes_length_out": 2834.0, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 2834.0, "num_module_steps_trained": 56832, "num_env_steps_trained_lifetime_throughput": NaN, "num_module_steps_trained_lifetime_throughput": NaN}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 5668, "fault_tolerance": {"num_healthy_workers": 1, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 1}, "done": false, "training_iteration": 2, "trial_id": "f23a0_00000", "date": "2025-11-20_15-03-44", "timestamp": 1763622224, "time_this_iter_s": 16.809961080551147, "time_total_s": 34.09973883628845, "pid": 26352, "hostname": "CS-ubuntu", "node_ip": "10.207.136.136", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MARL_EXO_ENV", "env_config": {"render_mode": "human", "render_bool": false, "frame_skip": 2, "model_path": "/home/chenshuo/PycharmProjects/move_sim/SMPL/data/xml/mj_fullbody_with_exo_carrying_policy_test.xml", "n_stacks": 1, "human_obs_keys": ["qpos", "local_body_pos", "local_body_vel", "local_body_rot_obs", "local_body_angle_vel"], "exo_obs_keys": ["exo_joint_t", "exo_joint_vel_t"], "weighted_reward_keys": {"w_pos_err": 0.4, "w_proprio_err": 0.4, "w_activation": 0.4, "w_exo_energy": 0.2, "w_exo_smooth": 0.2, "theta_pos_err": 0.5, "theta_proprio_err": 0.3, "theta_activation": 0.3, "theta_exo_energy": 0.1, "theta_exo_smooth": 4}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 2, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 120, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 128, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f94448ca830>", "policies_to_train": ["human_policy", "exo_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"human_policy": [null, "Box(-inf, inf, (248,), float32)", "Box(0.0, 1.0, (98,), float32)", {"model": {"custom_model": "human_model"}}], "exo_policy": [null, "Box(-10.0, 10.0, (4,), float32)", "Box(-0.261799, 2.0944, (2,), float32)", {"model": {"custom_model": "exo_model"}}]}, "callbacks": "<class 'SMPL.src.Custom_CallBack.RewardLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 34.09973883628845, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 19.117391304347827, "ram_util_percent": 63.30869565217392, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.001953125}}
{"timers": {"training_iteration": 17.28425023120673, "restore_env_runners": 4.360707296298187e-05, "training_step": 17.283868660128217, "env_runner_sampling_timer": 13.967001414675394, "learner_update_timer": 3.3127022500150036, "synch_weights": 0.0030548164112632324, "synch_env_connectors": 0.002139825699857738}, "env_runners": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 7.876948320483734e-05, "add_states_from_episodes_to_batch": 8.634831969629884e-06, "batch_individual_items": 5.617878018613282e-05, "agent_to_module_mapping": 1.0006603315787288e-05, "numpy_to_tensor": 0.00010241479163864823, "add_time_dim_to_batch_and_zero_pad": 3.0479939825477232e-05}}, "num_episodes_lifetime": 6, "episode_len_max": 1417, "num_agent_steps_sampled": {"human": 2834, "exo": 2834}, "env_to_module_connector": {"timers": {"connectors": {"agent_to_module_mapping": 9.092128902441759e-06, "numpy_to_tensor": 0.00010054161365424069, "add_time_dim_to_batch_and_zero_pad": 1.9620688755787537e-05, "add_observations_from_episodes_to_batch": 4.375954970628036e-05, "add_states_from_episodes_to_batch": 7.649416294008435e-06, "batch_individual_items": 4.7880844584199895e-05}}, "connector_pipeline_timer": 0.0003163821986869249}, "episode_return_min": 892.5872645190041, "agent_steps": {"exo": 1417.0, "human": 1417.0}, "num_module_steps_sampled_lifetime": {"exo_policy": 8502, "human_policy": 8502}, "num_module_steps_sampled": {"human_policy": 2834, "exo_policy": 2834}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 4.79669166922878e-05, "module_to_agent_unmapping": 6.089848159143414e-06, "tensor_to_numpy": 8.495187183478406e-05, "normalize_and_clip_actions": 0.00017714101982677696, "remove_single_ts_time_rank_from_batch": 2.5776280819691342e-06, "get_actions": 0.00034013954638028936, "listify_data_for_vector_env": 1.9186222674123493e-05}}, "connector_pipeline_timer": 0.0007860897686688554}, "module_episode_returns_mean": {"human_policy": 412.3816518029452, "exo_policy": 487.69035462919004}, "agent_episode_returns_mean": {"exo": 487.69035462919004, "human": 412.3816518029452}, "env_to_module_sum_episodes_length_out": 2621.831824891575, "episode_return_max": 905.7297042353489, "custom": {"human": {"R_p_mean": 0.17775230413234808, "R_proprio_mean": 0.11311840539931055, "R_a_mean": 0.00015374481057488104}, "exo": {"R_eas_mean": 0.018551775809941422, "R_t_mean": 0.034594803460520816}}, "sample": 13.937658036141505, "num_agent_steps_sampled_lifetime": {"human": 8502, "exo": 8502}, "episode_len_min": 1417, "env_step_timer": 0.00547499898979792, "connector_pipeline_timer": 0.0006833598883880541, "num_episodes": 2, "episode_duration_sec_mean": 14.031913233500026, "weights_seq_no": 2.0, "env_reset_timer": 0.05466977432201876, "episode_len_mean": 1417.0, "env_to_module_sum_episodes_length_in": 2621.831824891575, "episode_return_mean": 900.0720064321353, "rlmodule_inference_timer": 0.0005693559773502546, "num_env_steps_sampled": 2834, "num_env_steps_sampled_lifetime": 8502, "time_between_sampling": 3.38839840148996, "num_env_steps_sampled_lifetime_throughput": 159.48212282578046}, "learners": {"exo_policy": {"num_module_steps_trained": 28416, "curr_kl_coeff": 0.675000011920929, "vf_loss": 8.00451946258545, "entropy": 2.888101816177368, "weights_seq_no": 3.0, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 0.0005, "vf_loss_unclipped": 753.7478637695312, "module_train_batch_size_mean": 128.0, "num_module_steps_trained_lifetime": 85248, "num_trainable_parameters": 135429, "mean_kl_loss": 0.02144426479935646, "vf_explained_var": -0.12722265720367432, "total_loss": 7.912077903747559, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.10209062695503235, "num_module_steps_trained_lifetime_throughput": 1590.030707471404}, "human_policy": {"module_train_batch_size_mean": 128.0, "entropy": 139.6597137451172, "num_module_steps_trained_lifetime": 85248, "num_trainable_parameters": 309701, "default_optimizer_learning_rate": 0.0005, "total_loss": 9.345785140991211, "mean_kl_loss": 0.0917910784482956, "policy_loss": -0.19382734596729279, "vf_explained_var": 0.23446613550186157, "curr_kl_coeff": 0.675000011920929, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 9.498308181762695, "num_module_steps_trained": 28416, "weights_seq_no": 3.0, "curr_entropy_coeff": 0.0, "vf_loss_unclipped": 124.86492156982422, "num_module_steps_trained_lifetime_throughput": 1590.0366271735847}, "__all_modules__": {"num_module_steps_trained_lifetime": 170496, "num_env_steps_trained_lifetime": 1887444, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 3.375807690185865e-05, "add_observations_from_episodes_to_batch": 8.337957809972067e-05, "add_one_ts_to_episodes_and_truncate": 0.008139057087227388, "general_advantage_estimation": 0.029078679248744695, "agent_to_module_mapping": 0.004564044744912144, "add_columns_from_episodes_to_train_batch": 0.08506416110295693, "batch_individual_items": 0.21526952119647433, "numpy_to_tensor": 0.00030921516883986434, "add_states_from_episodes_to_batch": 9.651904177371761e-06}}, "connector_pipeline_timer": 0.34336640978566885}, "num_trainable_parameters": 445130, "num_env_steps_trained": 629148, "learner_connector_sum_episodes_length_out": 2834.0, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 2834.0, "num_module_steps_trained": 56832, "num_env_steps_trained_lifetime_throughput": 35204.36005700496, "num_module_steps_trained_lifetime_throughput": 3180.073366807237}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 8502, "fault_tolerance": {"num_healthy_workers": 1, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 1}, "done": false, "training_iteration": 3, "trial_id": "f23a0_00000", "date": "2025-11-20_15-04-02", "timestamp": 1763622242, "time_this_iter_s": 17.8224036693573, "time_total_s": 51.92214250564575, "pid": 26352, "hostname": "CS-ubuntu", "node_ip": "10.207.136.136", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MARL_EXO_ENV", "env_config": {"render_mode": "human", "render_bool": false, "frame_skip": 2, "model_path": "/home/chenshuo/PycharmProjects/move_sim/SMPL/data/xml/mj_fullbody_with_exo_carrying_policy_test.xml", "n_stacks": 1, "human_obs_keys": ["qpos", "local_body_pos", "local_body_vel", "local_body_rot_obs", "local_body_angle_vel"], "exo_obs_keys": ["exo_joint_t", "exo_joint_vel_t"], "weighted_reward_keys": {"w_pos_err": 0.4, "w_proprio_err": 0.4, "w_activation": 0.4, "w_exo_energy": 0.2, "w_exo_smooth": 0.2, "theta_pos_err": 0.5, "theta_proprio_err": 0.3, "theta_activation": 0.3, "theta_exo_energy": 0.1, "theta_exo_smooth": 4}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 2, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 120, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 128, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f94448cbeb0>", "policies_to_train": ["human_policy", "exo_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"human_policy": [null, "Box(-inf, inf, (248,), float32)", "Box(0.0, 1.0, (98,), float32)", {"model": {"custom_model": "human_model"}}], "exo_policy": [null, "Box(-10.0, 10.0, (4,), float32)", "Box(-0.261799, 2.0944, (2,), float32)", {"model": {"custom_model": "exo_model"}}]}, "callbacks": "<class 'SMPL.src.Custom_CallBack.RewardLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 51.92214250564575, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 21.37391304347826, "ram_util_percent": 63.486956521739124, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.001953125}}
{"timers": {"training_iteration": 17.286027940814662, "restore_env_runners": 4.334031223226179e-05, "training_step": 17.285646075896935, "env_runner_sampling_timer": 13.971434637398639, "learner_update_timer": 3.310055505474854, "synch_weights": 0.003049670647149766, "synch_env_connectors": 0.0021495773828595927}, "env_runners": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 7.860465837270453e-05, "add_states_from_episodes_to_batch": 8.634043650049533e-06, "batch_individual_items": 5.613106238427985e-05, "agent_to_module_mapping": 1.0003127282059267e-05, "numpy_to_tensor": 0.00010247278372191476, "add_time_dim_to_batch_and_zero_pad": 3.047110042826239e-05}}, "num_episodes_lifetime": 8, "episode_len_max": 1417, "num_agent_steps_sampled": {"human": 2834, "exo": 2834}, "env_to_module_connector": {"timers": {"connectors": {"agent_to_module_mapping": 8.3580159145009e-06, "numpy_to_tensor": 8.683283898337134e-05, "add_time_dim_to_batch_and_zero_pad": 1.746382678293159e-05, "add_observations_from_episodes_to_batch": 4.158032906777997e-05, "add_states_from_episodes_to_batch": 7.432867327728955e-06, "batch_individual_items": 4.389318844053511e-05}}, "connector_pipeline_timer": 0.0002894997157667852}, "episode_return_min": 892.5872645190041, "agent_steps": {"exo": 1417.0, "human": 1417.0}, "num_module_steps_sampled_lifetime": {"exo_policy": 11336, "human_policy": 11336}, "num_module_steps_sampled": {"human_policy": 2834, "exo_policy": 2834}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 4.5926672790867004e-05, "module_to_agent_unmapping": 5.921341742413326e-06, "tensor_to_numpy": 8.167129934890329e-05, "normalize_and_clip_actions": 0.00016717794234397148, "remove_single_ts_time_rank_from_batch": 2.4707883177522127e-06, "get_actions": 0.00032493892604685653, "listify_data_for_vector_env": 1.909441881500111e-05}}, "connector_pipeline_timer": 0.0007522438244278414}, "module_episode_returns_mean": {"human_policy": 412.7281638205063, "exo_policy": 488.2790502107356}, "agent_episode_returns_mean": {"exo": 488.2790502107356, "human": 412.7281638205063}, "env_to_module_sum_episodes_length_out": 2621.831824891575, "episode_return_max": 905.7297042353489, "custom": {"human": {"R_p_mean": 0.17767196712333672, "R_proprio_mean": 0.11344776253763157, "R_a_mean": 0.00014926386091315198}, "exo": {"R_eas_mean": 0.018565371541280892, "R_t_mean": 0.03475212061837292}}, "sample": 13.942200316780092, "num_agent_steps_sampled_lifetime": {"human": 11336, "exo": 11336}, "episode_len_min": 1417, "env_step_timer": 0.005184696492144464, "connector_pipeline_timer": 0.0006801367995021713, "num_episodes": 2, "episode_duration_sec_mean": 14.099735137375035, "weights_seq_no": 3.0, "env_reset_timer": 0.05452296938879947, "episode_len_mean": 1417.0, "env_to_module_sum_episodes_length_in": 2621.831824891575, "episode_return_mean": 901.0072140312418, "rlmodule_inference_timer": 0.0004967473100308676, "num_env_steps_sampled": 2834, "num_env_steps_sampled_lifetime": 11336, "time_between_sampling": 3.3860166080550598, "num_env_steps_sampled_lifetime_throughput": 159.58601594770283}, "learners": {"exo_policy": {"num_module_steps_trained": 28416, "curr_kl_coeff": 0.675000011920929, "vf_loss": 7.93934965133667, "entropy": 2.8766255378723145, "weights_seq_no": 4.0, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 0.0005, "vf_loss_unclipped": 565.7002563476562, "module_train_batch_size_mean": 128.0, "num_module_steps_trained_lifetime": 113664, "num_trainable_parameters": 135429, "mean_kl_loss": 0.011236647143959999, "vf_explained_var": 0.10818606615066528, "total_loss": 7.995151519775391, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.04821779578924179, "num_module_steps_trained_lifetime_throughput": 1591.7680418019738}, "human_policy": {"module_train_batch_size_mean": 128.0, "entropy": 140.4280242919922, "num_module_steps_trained_lifetime": 113664, "num_trainable_parameters": 309701, "default_optimizer_learning_rate": 0.0005, "total_loss": 8.564773559570312, "mean_kl_loss": 0.08547953516244888, "policy_loss": -0.1209220141172409, "vf_explained_var": 0.2461819052696228, "curr_kl_coeff": 1.0125000476837158, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 8.627997398376465, "num_module_steps_trained": 28416, "weights_seq_no": 4.0, "curr_entropy_coeff": 0.0, "vf_loss_unclipped": 157.07821655273438, "num_module_steps_trained_lifetime_throughput": 1591.7738025310596}, "__all_modules__": {"num_module_steps_trained_lifetime": 227328, "num_env_steps_trained_lifetime": 2516592, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 3.3704736132768174e-05, "add_observations_from_episodes_to_batch": 8.319230231864184e-05, "add_one_ts_to_episodes_and_truncate": 0.008106681846355771, "general_advantage_estimation": 0.029015046296258184, "agent_to_module_mapping": 0.0045606312174628705, "add_columns_from_episodes_to_train_batch": 0.08501777756192719, "batch_individual_items": 0.2152314544645107, "numpy_to_tensor": 0.00030835061714961596, "add_states_from_episodes_to_batch": 9.643655134339497e-06}}, "connector_pipeline_timer": 0.3431758790678113}, "num_trainable_parameters": 445130, "num_env_steps_trained": 629148, "learner_connector_sum_episodes_length_out": 2834.0, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 2834.0, "num_module_steps_trained": 56832, "num_env_steps_trained_lifetime_throughput": 35242.82503486614, "num_module_steps_trained_lifetime_throughput": 3183.547669545059}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 11336, "fault_tolerance": {"num_healthy_workers": 1, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 1}, "done": false, "training_iteration": 4, "trial_id": "f23a0_00000", "date": "2025-11-20_15-04-19", "timestamp": 1763622259, "time_this_iter_s": 17.467424392700195, "time_total_s": 69.38956689834595, "pid": 26352, "hostname": "CS-ubuntu", "node_ip": "10.207.136.136", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MARL_EXO_ENV", "env_config": {"render_mode": "human", "render_bool": false, "frame_skip": 2, "model_path": "/home/chenshuo/PycharmProjects/move_sim/SMPL/data/xml/mj_fullbody_with_exo_carrying_policy_test.xml", "n_stacks": 1, "human_obs_keys": ["qpos", "local_body_pos", "local_body_vel", "local_body_rot_obs", "local_body_angle_vel"], "exo_obs_keys": ["exo_joint_t", "exo_joint_vel_t"], "weighted_reward_keys": {"w_pos_err": 0.4, "w_proprio_err": 0.4, "w_activation": 0.4, "w_exo_energy": 0.2, "w_exo_smooth": 0.2, "theta_pos_err": 0.5, "theta_proprio_err": 0.3, "theta_activation": 0.3, "theta_exo_energy": 0.1, "theta_exo_smooth": 4}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 2, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 120, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 128, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f9444793250>", "policies_to_train": ["human_policy", "exo_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"human_policy": [null, "Box(-inf, inf, (248,), float32)", "Box(0.0, 1.0, (98,), float32)", {"model": {"custom_model": "human_model"}}], "exo_policy": [null, "Box(-10.0, 10.0, (4,), float32)", "Box(-0.261799, 2.0944, (2,), float32)", {"model": {"custom_model": "exo_model"}}]}, "callbacks": "<class 'SMPL.src.Custom_CallBack.RewardLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 69.38956689834595, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 19.860869565217392, "ram_util_percent": 64.04347826086955, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.001953125}}
{"timers": {"training_iteration": 17.279768734956516, "restore_env_runners": 4.3068619109641166e-05, "training_step": 17.279386747857966, "env_runner_sampling_timer": 13.969801797794652, "learner_update_timer": 3.3054406606601074, "synch_weights": 0.0030415928106768144, "synch_env_connectors": 0.002145621979030548}, "env_runners": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 7.837015178835578e-05, "add_states_from_episodes_to_batch": 8.622753213399346e-06, "batch_individual_items": 5.619042176088113e-05, "agent_to_module_mapping": 9.98194600982972e-06, "numpy_to_tensor": 0.00010232710588569925, "add_time_dim_to_batch_and_zero_pad": 3.037206942479743e-05}}, "num_episodes_lifetime": 10, "episode_len_max": 1417, "num_agent_steps_sampled": {"human": 2834, "exo": 2834}, "env_to_module_connector": {"timers": {"connectors": {"agent_to_module_mapping": 8.495932778719956e-06, "numpy_to_tensor": 8.565693312283759e-05, "add_time_dim_to_batch_and_zero_pad": 1.7703390902584366e-05, "add_observations_from_episodes_to_batch": 4.174051309693792e-05, "add_states_from_episodes_to_batch": 7.51807484794821e-06, "batch_individual_items": 4.528311114564658e-05}}, "connector_pipeline_timer": 0.0002917820249715309}, "episode_return_min": 892.5872645190041, "agent_steps": {"exo": 1417.0, "human": 1417.0}, "num_module_steps_sampled_lifetime": {"exo_policy": 14170, "human_policy": 14170}, "num_module_steps_sampled": {"human_policy": 2834, "exo_policy": 2834}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 4.6286524215446886e-05, "module_to_agent_unmapping": 5.952221026618756e-06, "tensor_to_numpy": 7.977030154369761e-05, "normalize_and_clip_actions": 0.00016778633217972682, "remove_single_ts_time_rank_from_batch": 2.4730415777367482e-06, "get_actions": 0.00031694553270771486, "listify_data_for_vector_env": 1.8805504472200813e-05}}, "connector_pipeline_timer": 0.0007425208680237036}, "module_episode_returns_mean": {"human_policy": 412.8965332690012, "exo_policy": 487.43680707345845}, "agent_episode_returns_mean": {"exo": 487.43680707345845, "human": 412.8965332690012}, "env_to_module_sum_episodes_length_out": 2621.831824891575, "episode_return_max": 905.7297042353489, "custom": {"human": {"R_p_mean": 0.17760617536525386, "R_proprio_mean": 0.11363254017918387, "R_a_mean": 0.00014909904201323214}, "exo": {"R_eas_mean": 0.01840978398396704, "R_t_mean": 0.034194502398853854}}, "sample": 13.94065882390229, "num_agent_steps_sampled_lifetime": {"human": 14170, "exo": 14170}, "episode_len_min": 1417, "env_step_timer": 0.005147188362356358, "connector_pipeline_timer": 0.0006766530815077035, "num_episodes": 2, "episode_duration_sec_mean": 14.020354134400032, "weights_seq_no": 4.0, "env_reset_timer": 0.05434233829491297, "episode_len_mean": 1417.0, "env_to_module_sum_episodes_length_in": 2621.831824891575, "episode_return_mean": 900.3333403424597, "rlmodule_inference_timer": 0.00048184047847667894, "num_env_steps_sampled": 2834, "num_env_steps_sampled_lifetime": 14170, "time_between_sampling": 3.3830969407445104, "num_env_steps_sampled_lifetime_throughput": 159.9993384791436}, "learners": {"exo_policy": {"num_module_steps_trained": 28416, "curr_kl_coeff": 0.675000011920929, "vf_loss": 7.592256546020508, "entropy": 2.9854602813720703, "weights_seq_no": 5.0, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 0.0005, "vf_loss_unclipped": 603.221435546875, "module_train_batch_size_mean": 128.0, "num_module_steps_trained_lifetime": 142080, "num_trainable_parameters": 135429, "mean_kl_loss": 0.01633620634675026, "vf_explained_var": 0.06045389175415039, "total_loss": 7.611667633056641, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.008383981883525848, "num_module_steps_trained_lifetime_throughput": 1597.3367580391139}, "human_policy": {"module_train_batch_size_mean": 128.0, "entropy": 139.80783081054688, "num_module_steps_trained_lifetime": 142080, "num_trainable_parameters": 309701, "default_optimizer_learning_rate": 0.0005, "total_loss": 8.436789512634277, "mean_kl_loss": 0.05732114985585213, "policy_loss": -0.15783792734146118, "vf_explained_var": 0.13636207580566406, "curr_kl_coeff": 1.5187500715255737, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 8.536589622497559, "num_module_steps_trained": 28416, "weights_seq_no": 5.0, "curr_entropy_coeff": 0.0, "vf_loss_unclipped": 151.958740234375, "num_module_steps_trained_lifetime_throughput": 1597.3422454056906}, "__all_modules__": {"num_module_steps_trained_lifetime": 284160, "num_env_steps_trained_lifetime": 3145740, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 3.3640508771631625e-05, "add_observations_from_episodes_to_batch": 8.308844929696986e-05, "add_one_ts_to_episodes_and_truncate": 0.008079502637891705, "general_advantage_estimation": 0.02895770571329457, "agent_to_module_mapping": 0.004559891905289673, "add_columns_from_episodes_to_train_batch": 0.08501654209630927, "batch_individual_items": 0.21357250716986437, "numpy_to_tensor": 0.00030722880097803617, "add_states_from_episodes_to_batch": 9.636788583905692e-06}}, "connector_pipeline_timer": 0.3414239971471336}, "num_trainable_parameters": 445130, "num_env_steps_trained": 629148, "learner_connector_sum_episodes_length_out": 2834.0, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 2834.0, "num_module_steps_trained": 56832, "num_env_steps_trained_lifetime_throughput": 35366.1158788817, "num_module_steps_trained_lifetime_throughput": 3194.6845256825904}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 14170, "fault_tolerance": {"num_healthy_workers": 1, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 1}, "done": false, "training_iteration": 5, "trial_id": "f23a0_00000", "date": "2025-11-20_15-04-36", "timestamp": 1763622276, "time_this_iter_s": 16.665355920791626, "time_total_s": 86.05492281913757, "pid": 26352, "hostname": "CS-ubuntu", "node_ip": "10.207.136.136", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MARL_EXO_ENV", "env_config": {"render_mode": "human", "render_bool": false, "frame_skip": 2, "model_path": "/home/chenshuo/PycharmProjects/move_sim/SMPL/data/xml/mj_fullbody_with_exo_carrying_policy_test.xml", "n_stacks": 1, "human_obs_keys": ["qpos", "local_body_pos", "local_body_vel", "local_body_rot_obs", "local_body_angle_vel"], "exo_obs_keys": ["exo_joint_t", "exo_joint_vel_t"], "weighted_reward_keys": {"w_pos_err": 0.4, "w_proprio_err": 0.4, "w_activation": 0.4, "w_exo_energy": 0.2, "w_exo_smooth": 0.2, "theta_pos_err": 0.5, "theta_proprio_err": 0.3, "theta_activation": 0.3, "theta_exo_energy": 0.1, "theta_exo_smooth": 4}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 2, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 120, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 128, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f9444793e20>", "policies_to_train": ["human_policy", "exo_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"human_policy": [null, "Box(-inf, inf, (248,), float32)", "Box(0.0, 1.0, (98,), float32)", {"model": {"custom_model": "human_model"}}], "exo_policy": [null, "Box(-10.0, 10.0, (4,), float32)", "Box(-0.261799, 2.0944, (2,), float32)", {"model": {"custom_model": "exo_model"}}]}, "callbacks": "<class 'SMPL.src.Custom_CallBack.RewardLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 86.05492281913757, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 17.681818181818183, "ram_util_percent": 63.28181818181818, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.001953125}}
{"timers": {"training_iteration": 17.272984149086952, "restore_env_runners": 4.280765291993979e-05, "training_step": 17.272601669129386, "env_runner_sampling_timer": 13.967485538046704, "learner_update_timer": 3.3009661515235056, "synch_weights": 0.0030490714325706473, "synch_env_connectors": 0.0021410234492402944}, "env_runners": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 7.826603027092331e-05, "add_states_from_episodes_to_batch": 8.623185681117043e-06, "batch_individual_items": 5.614608754264657e-05, "agent_to_module_mapping": 9.974006548949203e-06, "numpy_to_tensor": 0.0001026572848267391, "add_time_dim_to_batch_and_zero_pad": 3.038584873116893e-05}}, "num_episodes_lifetime": 12, "episode_len_max": 1417, "num_agent_steps_sampled": {"human": 2834, "exo": 2834}, "env_to_module_connector": {"timers": {"connectors": {"agent_to_module_mapping": 8.242359214683686e-06, "numpy_to_tensor": 8.636094145066458e-05, "add_time_dim_to_batch_and_zero_pad": 1.7245415181187212e-05, "add_observations_from_episodes_to_batch": 4.21205779024349e-05, "add_states_from_episodes_to_batch": 7.466030307900762e-06, "batch_individual_items": 4.376853449936594e-05}}, "connector_pipeline_timer": 0.0002889539657467239}, "episode_return_min": 892.5872645190041, "agent_steps": {"exo": 1417.0, "human": 1417.0}, "num_module_steps_sampled_lifetime": {"exo_policy": 17004, "human_policy": 17004}, "num_module_steps_sampled": {"human_policy": 2834, "exo_policy": 2834}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 4.680832980529462e-05, "module_to_agent_unmapping": 5.942724930035235e-06, "tensor_to_numpy": 8.050423622644459e-05, "normalize_and_clip_actions": 0.00016791928154929542, "remove_single_ts_time_rank_from_batch": 2.4641284816751214e-06, "get_actions": 0.0003170191432097933, "listify_data_for_vector_env": 1.874782788362344e-05}}, "connector_pipeline_timer": 0.0007448648932561326}, "module_episode_returns_mean": {"human_policy": 413.5245468925057, "exo_policy": 488.5361299269153}, "agent_episode_returns_mean": {"exo": 488.5361299269153, "human": 413.5245468925057}, "env_to_module_sum_episodes_length_out": 2621.831824891575, "episode_return_max": 910.7517508325805, "custom": {"human": {"R_p_mean": 0.17766563247537745, "R_proprio_mean": 0.11401335167307036, "R_a_mean": 0.00015202989001777574}, "exo": {"R_eas_mean": 0.018595788354845034, "R_t_mean": 0.034341108634858175}}, "sample": 13.938434094293266, "num_agent_steps_sampled_lifetime": {"human": 17004, "exo": 17004}, "episode_len_min": 1417, "env_step_timer": 0.005193273373177772, "connector_pipeline_timer": 0.0006740667306938118, "num_episodes": 2, "episode_duration_sec_mean": 13.954998434916698, "weights_seq_no": 5.0, "env_reset_timer": 0.054182597041963966, "episode_len_mean": 1417.0, "env_to_module_sum_episodes_length_in": 2621.831824891575, "episode_return_mean": 902.060676819421, "rlmodule_inference_timer": 0.0005017816573437542, "num_env_steps_sampled": 2834, "num_env_steps_sampled_lifetime": 17004, "time_between_sampling": 3.3782419430670667, "num_env_steps_sampled_lifetime_throughput": 160.52742609319998}, "learners": {"exo_policy": {"num_module_steps_trained": 28416, "curr_kl_coeff": 0.675000011920929, "vf_loss": 7.370782375335693, "entropy": 2.9147489070892334, "weights_seq_no": 6.0, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 0.0005, "vf_loss_unclipped": 641.145263671875, "module_train_batch_size_mean": 128.0, "num_module_steps_trained_lifetime": 170496, "num_trainable_parameters": 135429, "mean_kl_loss": 0.011152024380862713, "vf_explained_var": -0.06451690196990967, "total_loss": 7.387441158294678, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.009130815044045448, "num_module_steps_trained_lifetime_throughput": 1602.9306089342576}, "human_policy": {"module_train_batch_size_mean": 128.0, "entropy": 140.2162322998047, "num_module_steps_trained_lifetime": 170496, "num_trainable_parameters": 309701, "default_optimizer_learning_rate": 0.0005, "total_loss": 7.905162334442139, "mean_kl_loss": 0.04310411959886551, "policy_loss": -0.15244221687316895, "vf_explained_var": 0.3254762887954712, "curr_kl_coeff": 2.278125047683716, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 7.9921393394470215, "num_module_steps_trained": 28416, "weights_seq_no": 6.0, "curr_entropy_coeff": 0.0, "vf_loss_unclipped": 127.80469512939453, "num_module_steps_trained_lifetime_throughput": 1602.9354256788097}, "__all_modules__": {"num_module_steps_trained_lifetime": 340992, "num_env_steps_trained_lifetime": 3774888, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 3.3568103684158265e-05, "add_observations_from_episodes_to_batch": 8.305977480361981e-05, "add_one_ts_to_episodes_and_truncate": 0.008053554231513504, "general_advantage_estimation": 0.028931657416160814, "agent_to_module_mapping": 0.004556998906236892, "add_columns_from_episodes_to_train_batch": 0.08499396711534503, "batch_individual_items": 0.21192617699816638, "numpy_to_tensor": 0.0003073580429690073, "add_states_from_episodes_to_batch": 9.631290696596887e-06}}, "connector_pipeline_timer": 0.33969540821566435}, "num_trainable_parameters": 445130, "num_env_steps_trained": 629148, "learner_connector_sum_episodes_length_out": 2834.0, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 2834.0, "num_module_steps_trained": 56832, "num_env_steps_trained_lifetime_throughput": 35489.955096437254, "num_module_steps_trained_lifetime_throughput": 3205.8709547441044}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 17004, "fault_tolerance": {"num_healthy_workers": 1, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 1}, "done": false, "training_iteration": 6, "trial_id": "f23a0_00000", "date": "2025-11-20_15-04-53", "timestamp": 1763622293, "time_this_iter_s": 16.606841325759888, "time_total_s": 102.66176414489746, "pid": 26352, "hostname": "CS-ubuntu", "node_ip": "10.207.136.136", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MARL_EXO_ENV", "env_config": {"render_mode": "human", "render_bool": false, "frame_skip": 2, "model_path": "/home/chenshuo/PycharmProjects/move_sim/SMPL/data/xml/mj_fullbody_with_exo_carrying_policy_test.xml", "n_stacks": 1, "human_obs_keys": ["qpos", "local_body_pos", "local_body_vel", "local_body_rot_obs", "local_body_angle_vel"], "exo_obs_keys": ["exo_joint_t", "exo_joint_vel_t"], "weighted_reward_keys": {"w_pos_err": 0.4, "w_proprio_err": 0.4, "w_activation": 0.4, "w_exo_energy": 0.2, "w_exo_smooth": 0.2, "theta_pos_err": 0.5, "theta_proprio_err": 0.3, "theta_activation": 0.3, "theta_exo_energy": 0.1, "theta_exo_smooth": 4}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 2, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 120, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 128, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f9444793a30>", "policies_to_train": ["human_policy", "exo_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"human_policy": [null, "Box(-inf, inf, (248,), float32)", "Box(0.0, 1.0, (98,), float32)", {"model": {"custom_model": "human_model"}}], "exo_policy": [null, "Box(-10.0, 10.0, (4,), float32)", "Box(-0.261799, 2.0944, (2,), float32)", {"model": {"custom_model": "exo_model"}}]}, "callbacks": "<class 'SMPL.src.Custom_CallBack.RewardLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 102.66176414489746, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 17.631818181818183, "ram_util_percent": 62.16818181818181, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.001953125}}
{"timers": {"training_iteration": 17.26774955601608, "restore_env_runners": 4.2618726390028596e-05, "training_step": 17.267365654268094, "env_runner_sampling_timer": 13.966662133956238, "learner_update_timer": 3.2965616186382722, "synch_weights": 0.0030430089782437263, "synch_env_connectors": 0.002136703634749187}, "env_runners": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 7.802118996944145e-05, "add_states_from_episodes_to_batch": 8.612303825531033e-06, "batch_individual_items": 5.606342666733001e-05, "agent_to_module_mapping": 1.0217716484769686e-05, "numpy_to_tensor": 0.0001025331119781033, "add_time_dim_to_batch_and_zero_pad": 3.027376024398584e-05}}, "num_episodes_lifetime": 14, "episode_len_max": 1417, "num_agent_steps_sampled": {"human": 2834, "exo": 2834}, "env_to_module_connector": {"timers": {"connectors": {"agent_to_module_mapping": 8.549007624457556e-06, "numpy_to_tensor": 8.807300054032914e-05, "add_time_dim_to_batch_and_zero_pad": 1.8365346195696264e-05, "add_observations_from_episodes_to_batch": 4.3220168193065435e-05, "add_states_from_episodes_to_batch": 7.593560274835674e-06, "batch_individual_items": 4.650553145656966e-05}}, "connector_pipeline_timer": 0.00029919598788210835}, "episode_return_min": 892.5872645190041, "agent_steps": {"exo": 1417.0, "human": 1417.0}, "num_module_steps_sampled_lifetime": {"exo_policy": 19838, "human_policy": 19838}, "num_module_steps_sampled": {"human_policy": 2834, "exo_policy": 2834}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 4.727167626206273e-05, "module_to_agent_unmapping": 5.971284377684525e-06, "tensor_to_numpy": 8.148365903904353e-05, "normalize_and_clip_actions": 0.00017199112055956044, "remove_single_ts_time_rank_from_batch": 2.8357995102534515e-06, "get_actions": 0.00031420633545059724, "listify_data_for_vector_env": 1.9271302212693007e-05}}, "connector_pipeline_timer": 0.00075013686148321}, "module_episode_returns_mean": {"human_policy": 413.20995631905953, "exo_policy": 488.92271913960366}, "agent_episode_returns_mean": {"exo": 488.92271913960366, "human": 413.20995631905953}, "env_to_module_sum_episodes_length_out": 2621.831824891575, "episode_return_max": 910.7517508325805, "custom": {"human": {"R_p_mean": 0.1776168661736754, "R_proprio_mean": 0.11383949993018169, "R_a_mean": 0.00015263623845732796}, "exo": {"R_eas_mean": 0.018702171147699054, "R_t_mean": 0.0347295598477447}}, "sample": 13.937713737510334, "num_agent_steps_sampled_lifetime": {"human": 19838, "exo": 19838}, "episode_len_min": 1417, "env_step_timer": 0.005301554489770872, "connector_pipeline_timer": 0.0006707946033878686, "num_episodes": 2, "episode_duration_sec_mean": 13.929623460642915, "weights_seq_no": 6.0, "env_reset_timer": 0.054019448121544855, "episode_len_mean": 1417.0, "env_to_module_sum_episodes_length_in": 2621.831824891575, "episode_return_mean": 902.1326754586631, "rlmodule_inference_timer": 0.0004934660804769015, "num_env_steps_sampled": 2834, "num_env_steps_sampled_lifetime": 19838, "time_between_sampling": 3.373526588586396, "num_env_steps_sampled_lifetime_throughput": 160.94978485201798}, "learners": {"exo_policy": {"num_module_steps_trained": 28416, "curr_kl_coeff": 0.675000011920929, "vf_loss": 7.889132499694824, "entropy": 2.9963576793670654, "weights_seq_no": 7.0, "curr_entropy_coeff": 0.0, "default_optimizer_learning_rate": 0.0005, "vf_loss_unclipped": 652.4264526367188, "module_train_batch_size_mean": 128.0, "num_module_steps_trained_lifetime": 198912, "num_trainable_parameters": 135429, "mean_kl_loss": 0.016155008226633072, "vf_explained_var": 0.004273056983947754, "total_loss": 7.862891674041748, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.037145644426345825, "num_module_steps_trained_lifetime_throughput": 1607.4850537066566}, "human_policy": {"module_train_batch_size_mean": 128.0, "entropy": 140.23487854003906, "num_module_steps_trained_lifetime": 198912, "num_trainable_parameters": 309701, "default_optimizer_learning_rate": 0.0005, "total_loss": 7.866288661956787, "mean_kl_loss": 0.02959987334907055, "policy_loss": -0.12852314114570618, "vf_explained_var": 0.5276792049407959, "curr_kl_coeff": 3.4171876907348633, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 7.927379131317139, "num_module_steps_trained": 28416, "weights_seq_no": 7.0, "curr_entropy_coeff": 0.0, "vf_loss_unclipped": 87.13436889648438, "num_module_steps_trained_lifetime_throughput": 1607.4896309318865}, "__all_modules__": {"num_module_steps_trained_lifetime": 397824, "num_env_steps_trained_lifetime": 4404036, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 3.3500222648300385e-05, "add_observations_from_episodes_to_batch": 8.289463705756649e-05, "add_one_ts_to_episodes_and_truncate": 0.008024152589195154, "general_advantage_estimation": 0.028889939431998347, "agent_to_module_mapping": 0.0045543795971737175, "add_columns_from_episodes_to_train_batch": 0.08495585035419163, "batch_individual_items": 0.21030859322818524, "numpy_to_tensor": 0.0003060700225419623, "add_states_from_episodes_to_batch": 9.623037786045732e-06}}, "connector_pipeline_timer": 0.3379590483135103}, "num_trainable_parameters": 445130, "num_env_steps_trained": 629148, "learner_connector_sum_episodes_length_out": 2834.0, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 2834.0, "num_module_steps_trained": 56832, "num_env_steps_trained_lifetime_throughput": 35590.790976646356, "num_module_steps_trained_lifetime_throughput": 3214.9793751484845}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 19838, "fault_tolerance": {"num_healthy_workers": 1, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 1}, "done": true, "training_iteration": 7, "trial_id": "f23a0_00000", "date": "2025-11-20_15-05-09", "timestamp": 1763622309, "time_this_iter_s": 16.755198001861572, "time_total_s": 119.41696214675903, "pid": 26352, "hostname": "CS-ubuntu", "node_ip": "10.207.136.136", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MARL_EXO_ENV", "env_config": {"render_mode": "human", "render_bool": false, "frame_skip": 2, "model_path": "/home/chenshuo/PycharmProjects/move_sim/SMPL/data/xml/mj_fullbody_with_exo_carrying_policy_test.xml", "n_stacks": 1, "human_obs_keys": ["qpos", "local_body_pos", "local_body_vel", "local_body_rot_obs", "local_body_angle_vel"], "exo_obs_keys": ["exo_joint_t", "exo_joint_vel_t"], "weighted_reward_keys": {"w_pos_err": 0.4, "w_proprio_err": 0.4, "w_activation": 0.4, "w_exo_energy": 0.2, "w_exo_smooth": 0.2, "theta_pos_err": 0.5, "theta_proprio_err": 0.3, "theta_activation": 0.3, "theta_exo_energy": 0.1, "theta_exo_smooth": 4}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 2, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 120, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 128, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f94448bb6d0>", "policies_to_train": ["human_policy", "exo_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"human_policy": [null, "Box(-inf, inf, (248,), float32)", "Box(0.0, 1.0, (98,), float32)", {"model": {"custom_model": "human_model"}}], "exo_policy": [null, "Box(-10.0, 10.0, (4,), float32)", "Box(-0.261799, 2.0944, (2,), float32)", {"model": {"custom_model": "exo_model"}}]}, "callbacks": "<class 'SMPL.src.Custom_CallBack.RewardLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 119.41696214675903, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 18.18260869565217, "ram_util_percent": 62.339130434782604, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.001953125}}
