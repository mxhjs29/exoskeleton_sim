{"timers": {"training_iteration": 19.031395498999927, "restore_env_runners": 2.1740999955000007e-05, "training_step": 19.030872601000056, "env_runner_sampling_timer": 14.828299938999862, "learner_update_timer": 4.195426953999913, "synch_weights": 0.004500991999975668}, "env_runners": {"num_agent_steps_sampled": {"human": 2834, "exo": 2834}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 7.89582114311525e-06, "add_time_dim_to_batch_and_zero_pad": 2.0338585176054827e-05, "agent_to_module_mapping": 9.307528757417509e-06, "batch_individual_items": 4.652203737251152e-05, "numpy_to_tensor": 9.95960135731292e-05, "add_observations_from_episodes_to_batch": 4.3816385883937605e-05}}, "connector_pipeline_timer": 0.000317995048967967}, "module_to_env_connector": {"timers": {"connectors": {"module_to_agent_unmapping": 6.832639970092643e-06, "listify_data_for_vector_env": 1.9918528911015132e-05, "remove_single_ts_time_rank_from_batch": 2.61339478648585e-06, "get_actions": 0.0003451802685187225, "tensor_to_numpy": 8.555550533823117e-05, "normalize_and_clip_actions": 0.0001787096416459704, "un_batch_to_individual_items": 4.887614935287014e-05}}, "connector_pipeline_timer": 0.000800724628445809}, "timers": {"connectors": {"numpy_to_tensor": 8.201300011023704e-05, "add_observations_from_episodes_to_batch": 5.895000003874884e-05, "add_states_from_episodes_to_batch": 8.896999815988238e-06, "add_time_dim_to_batch_and_zero_pad": 2.1058999891465646e-05, "agent_to_module_mapping": 9.007000016936217e-06, "batch_individual_items": 4.4182999999975436e-05}}, "episode_len_mean": 1417.0, "num_module_steps_sampled_lifetime": {"exo_policy": 2834, "human_policy": 2834}, "env_reset_timer": 0.09078207400011706, "weights_seq_no": 0.0, "env_to_module_sum_episodes_length_out": 2621.8301293409154, "episode_duration_sec_mean": 14.65718208599992, "env_step_timer": 0.005524218546611126, "num_env_steps_sampled_lifetime": 2834, "num_module_steps_sampled": {"human_policy": 2834, "exo_policy": 2834}, "module_episode_returns_mean": {"exo_policy": 1748.3821352962088, "human_policy": 1316.2351072498961}, "custom": {"human": {"R_p_mean": 0.3913316335140633, "R_a_mean": 0.12092389498474014, "R_proprio_mean": 0.416633044013474}, "exo": {"R_t_mean": 0.11512453919345698, "R_eas_mean": 0.18984866337980527}}, "rlmodule_inference_timer": 0.0005662142637435409, "episode_return_min": 3063.546116453067, "agent_episode_returns_mean": {"exo": 1748.3821352962088, "human": 1316.2351072498961}, "num_episodes_lifetime": 2, "episode_len_max": 1417, "num_env_steps_sampled": 2834, "connector_pipeline_timer": 0.000528197999983604, "num_episodes": 2, "num_agent_steps_sampled_lifetime": {"exo": 2834, "human": 2834}, "agent_steps": {"exo": 1417.0, "human": 1417.0}, "sample": 14.799172908000173, "episode_len_min": 1417, "episode_return_max": 3065.688368639143, "env_to_module_sum_episodes_length_in": 2621.8301293409154, "episode_return_mean": 3064.617242546105, "num_env_steps_sampled_lifetime_throughput": NaN}, "learners": {"exo_policy": {"vf_loss_unclipped": 13922.6259765625, "mean_kl_loss": 0.07168573141098022, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 9.892014503479004, "num_trainable_parameters": 135429, "curr_kl_coeff": 0.30000001192092896, "num_module_steps_trained": 28416, "num_module_steps_trained_lifetime": 28416, "vf_loss": 9.95584487915039, "default_optimizer_learning_rate": 0.0005, "weights_seq_no": 1.0, "vf_explained_var": 0.047544240951538086, "policy_loss": -0.07816746085882187, "module_train_batch_size_mean": 128.0, "curr_entropy_coeff": 0.0, "entropy": 2.930406093597412, "num_module_steps_trained_lifetime_throughput": NaN}, "human_policy": {"num_module_steps_trained": 28416, "num_module_steps_trained_lifetime": 28416, "vf_loss": 9.93346881866455, "default_optimizer_learning_rate": 0.0005, "weights_seq_no": 1.0, "vf_explained_var": 0.00855952501296997, "policy_loss": -0.043503567576408386, "module_train_batch_size_mean": 128.0, "curr_entropy_coeff": 0.0, "entropy": 140.11802673339844, "vf_loss_unclipped": 7184.6103515625, "mean_kl_loss": 0.15987223386764526, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 9.921940803527832, "num_trainable_parameters": 309701, "curr_kl_coeff": 0.30000001192092896, "num_module_steps_trained_lifetime_throughput": NaN}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.04628531999992447, "add_observations_from_episodes_to_batch": 0.0001076020000709832, "agent_to_module_mapping": 0.004527058999883593, "add_one_ts_to_episodes_and_truncate": 0.007925655000008192, "add_columns_from_episodes_to_train_batch": 0.08503884199990352, "add_time_dim_to_batch_and_zero_pad": 8.325399994646432e-05, "numpy_to_tensor": 0.00026855900000555266, "add_states_from_episodes_to_batch": 1.0279999969498022e-05, "batch_individual_items": 0.22902929800011407}}, "connector_pipeline_timer": 0.37414417099989805}, "num_trainable_parameters": 445130, "num_env_steps_trained": 629148, "num_module_steps_trained": 56832, "num_env_steps_trained_lifetime": 629148, "learner_connector_sum_episodes_length_out": 2834, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 2834, "num_module_steps_trained_lifetime": 56832, "num_env_steps_trained_lifetime_throughput": NaN, "num_module_steps_trained_lifetime_throughput": NaN}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 2834, "fault_tolerance": {"num_healthy_workers": 1, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 1}, "done": false, "training_iteration": 1, "trial_id": "dc8cf_00001", "date": "2025-11-20_14-48-34", "timestamp": 1763621314, "time_this_iter_s": 19.040003299713135, "time_total_s": 19.040003299713135, "pid": 11835, "hostname": "CS-ubuntu", "node_ip": "10.207.136.136", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MARL_EXO_ENV", "env_config": {"render_mode": "human", "render_bool": false, "frame_skip": 2, "model_path": "/home/chenshuo/PycharmProjects/move_sim/SMPL/data/xml/mj_fullbody_with_exo_carrying_policy_test.xml", "n_stacks": 1, "human_obs_keys": ["qpos", "local_body_pos", "local_body_vel", "local_body_rot_obs", "local_body_angle_vel"], "exo_obs_keys": ["exo_joint_t", "exo_joint_vel_t"], "weighted_reward_keys": {"w_pos_err": 0.5, "w_proprio_err": 0.6, "w_activation": 0.4, "w_exo_energy": 0.2, "w_exo_smooth": 0.3, "theta_pos_err": 0.1, "theta_proprio_err": 0.03, "theta_activation": 0.03, "theta_exo_energy": 0.01, "theta_exo_smooth": 0.2}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 2, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 120, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 128, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7fcae561cf70>", "policies_to_train": ["human_policy", "exo_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"human_policy": [null, "Box(-inf, inf, (248,), float32)", "Box(0.0, 1.0, (98,), float32)", {"model": {"custom_model": "human_model"}}], "exo_policy": [null, "Box(-10.0, 10.0, (4,), float32)", "Box(-0.261799, 2.0944, (2,), float32)", {"model": {"custom_model": "exo_model"}}]}, "callbacks": "<class 'SMPL.src.Custom_CallBack.RewardLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 19.040003299713135, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 19.453846153846154, "ram_util_percent": 55.67307692307692, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.001361553485576923}}
{"timers": {"training_iteration": 19.021728980449925, "restore_env_runners": 2.1718079954098356e-05, "training_step": 19.021205915320053, "env_runner_sampling_timer": 14.826051231809863, "learner_update_timer": 4.188030186949914, "synch_weights": 0.004498553349976646, "synch_env_connectors": 0.0035696079999070207}, "env_runners": {"num_agent_steps_sampled": {"human": 2834, "exo": 2834}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 7.66957505616607e-06, "add_time_dim_to_batch_and_zero_pad": 1.9331730532535498e-05, "agent_to_module_mapping": 8.844559056686834e-06, "batch_individual_items": 4.362769725599059e-05, "numpy_to_tensor": 9.320636948151594e-05, "add_observations_from_episodes_to_batch": 4.261137374470727e-05}}, "connector_pipeline_timer": 0.00030250730358946735}, "module_to_env_connector": {"timers": {"connectors": {"module_to_agent_unmapping": 6.051020852744107e-06, "listify_data_for_vector_env": 1.9408894389282146e-05, "remove_single_ts_time_rank_from_batch": 2.5904149276807484e-06, "get_actions": 0.0003320898487458321, "tensor_to_numpy": 8.262535804954953e-05, "normalize_and_clip_actions": 0.00017167217623960854, "un_batch_to_individual_items": 4.685725913609701e-05}}, "connector_pipeline_timer": 0.0007696397167153072}, "timers": {"connectors": {"numpy_to_tensor": 8.202571010997417e-05, "add_observations_from_episodes_to_batch": 5.9363470038533704e-05, "add_states_from_episodes_to_batch": 8.91322981715348e-06, "add_time_dim_to_batch_and_zero_pad": 2.1259419893340236e-05, "agent_to_module_mapping": 9.059810015514814e-06, "batch_individual_items": 4.4381130001056585e-05}}, "episode_len_mean": 1417.0, "num_module_steps_sampled_lifetime": {"exo_policy": 5668, "human_policy": 5668}, "env_reset_timer": 0.09038301783011547, "weights_seq_no": 1.0, "env_to_module_sum_episodes_length_out": 2621.8318248904784, "episode_duration_sec_mean": 14.567469866749946, "env_step_timer": 0.005323087119600324, "num_env_steps_sampled_lifetime": 5668, "num_module_steps_sampled": {"human_policy": 2834, "exo_policy": 2834}, "module_episode_returns_mean": {"exo_policy": 1745.9093351825807, "human_policy": 1316.0817229397192}, "custom": {"human": {"R_p_mean": 0.39131489130338604, "R_a_mean": 0.12076310158756841, "R_proprio_mean": 0.4167023338131528}, "exo": {"R_t_mean": 0.11376611707410322, "R_eas_mean": 0.18957023595543865}}, "rlmodule_inference_timer": 0.0005192169870277722, "episode_return_min": 3053.8298942453657, "agent_episode_returns_mean": {"exo": 1745.9093351825807, "human": 1316.0817229397192}, "num_episodes_lifetime": 4, "episode_len_max": 1417, "num_env_steps_sampled": 2834, "connector_pipeline_timer": 0.000527697629981958, "num_episodes": 2, "num_agent_steps_sampled_lifetime": {"exo": 5668, "human": 5668}, "agent_steps": {"exo": 1417.0, "human": 1417.0}, "sample": 14.797000704570173, "episode_len_min": 1417, "episode_return_max": 3065.688368639143, "env_to_module_sum_episodes_length_in": 2621.8318248904784, "episode_return_mean": 3061.9910581222994, "time_between_sampling": 4.268083760000081, "num_env_steps_sampled_lifetime_throughput": NaN}, "learners": {"exo_policy": {"vf_loss_unclipped": 13914.572265625, "mean_kl_loss": 0.021061964333057404, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 9.830283164978027, "num_trainable_parameters": 135429, "curr_kl_coeff": 0.45000001788139343, "num_module_steps_trained": 28416, "num_module_steps_trained_lifetime": 56832, "vf_loss": 9.922340393066406, "default_optimizer_learning_rate": 0.0005, "weights_seq_no": 2.0, "vf_explained_var": 0.04400432109832764, "policy_loss": -0.09837657958269119, "module_train_batch_size_mean": 128.0, "curr_entropy_coeff": 0.0, "entropy": 2.8878328800201416, "num_module_steps_trained_lifetime_throughput": NaN}, "human_policy": {"num_module_steps_trained": 28416, "num_module_steps_trained_lifetime": 56832, "vf_loss": 9.960111618041992, "default_optimizer_learning_rate": 0.0005, "weights_seq_no": 2.0, "vf_explained_var": 0.01958930492401123, "policy_loss": -0.3135840892791748, "module_train_batch_size_mean": 128.0, "curr_entropy_coeff": 0.0, "entropy": 140.24574279785156, "vf_loss_unclipped": 7584.41064453125, "mean_kl_loss": 0.10983578115701675, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 9.679476737976074, "num_trainable_parameters": 309701, "curr_kl_coeff": 0.45000001788139343, "num_module_steps_trained_lifetime_throughput": NaN}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.04603838915992583, "add_observations_from_episodes_to_batch": 0.00010723587007078095, "agent_to_module_mapping": 0.004528610969884994, "add_one_ts_to_episodes_and_truncate": 0.007901700060008352, "add_columns_from_episodes_to_train_batch": 0.08505876042990394, "add_time_dim_to_batch_and_zero_pad": 8.312172994692446e-05, "numpy_to_tensor": 0.0002680358600036925, "add_states_from_episodes_to_batch": 1.0281509969445323e-05, "batch_individual_items": 0.22726658897011248}}, "connector_pipeline_timer": 0.3721265583398986}, "num_trainable_parameters": 445130, "num_env_steps_trained": 629148, "num_module_steps_trained": 56832, "num_env_steps_trained_lifetime": 1258296, "learner_connector_sum_episodes_length_out": 2834.0, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 2834.0, "num_module_steps_trained_lifetime": 113664, "num_env_steps_trained_lifetime_throughput": NaN, "num_module_steps_trained_lifetime_throughput": NaN}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 5668, "fault_tolerance": {"num_healthy_workers": 1, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 1}, "done": false, "training_iteration": 2, "trial_id": "dc8cf_00001", "date": "2025-11-20_14-48-52", "timestamp": 1763621332, "time_this_iter_s": 18.070507287979126, "time_total_s": 37.11051058769226, "pid": 11835, "hostname": "CS-ubuntu", "node_ip": "10.207.136.136", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MARL_EXO_ENV", "env_config": {"render_mode": "human", "render_bool": false, "frame_skip": 2, "model_path": "/home/chenshuo/PycharmProjects/move_sim/SMPL/data/xml/mj_fullbody_with_exo_carrying_policy_test.xml", "n_stacks": 1, "human_obs_keys": ["qpos", "local_body_pos", "local_body_vel", "local_body_rot_obs", "local_body_angle_vel"], "exo_obs_keys": ["exo_joint_t", "exo_joint_vel_t"], "weighted_reward_keys": {"w_pos_err": 0.5, "w_proprio_err": 0.6, "w_activation": 0.4, "w_exo_energy": 0.2, "w_exo_smooth": 0.3, "theta_pos_err": 0.1, "theta_proprio_err": 0.03, "theta_activation": 0.03, "theta_exo_energy": 0.01, "theta_exo_smooth": 0.2}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 2, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 120, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 128, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7fcae56d37f0>", "policies_to_train": ["human_policy", "exo_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"human_policy": [null, "Box(-inf, inf, (248,), float32)", "Box(0.0, 1.0, (98,), float32)", {"model": {"custom_model": "human_model"}}], "exo_policy": [null, "Box(-10.0, 10.0, (4,), float32)", "Box(-0.261799, 2.0944, (2,), float32)", {"model": {"custom_model": "exo_model"}}]}, "callbacks": "<class 'SMPL.src.Custom_CallBack.RewardLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 37.11051058769226, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 19.475, "ram_util_percent": 56.4125, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.001953125}}
{"timers": {"training_iteration": 19.015174727405427, "restore_env_runners": 2.169687915563827e-05, "training_step": 19.014651625096853, "env_runner_sampling_timer": 14.826128466731761, "learner_update_timer": 4.181433963510414, "synch_weights": 0.004480936096477125, "synch_env_connectors": 0.003552773539906866}, "env_runners": {"num_agent_steps_sampled": {"human": 2834, "exo": 2834}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 7.845397419968466e-06, "add_time_dim_to_batch_and_zero_pad": 2.0060838462940213e-05, "agent_to_module_mapping": 9.157103070273815e-06, "batch_individual_items": 4.5718030648608785e-05, "numpy_to_tensor": 0.00010270357941345169, "add_observations_from_episodes_to_batch": 4.4103334686441946e-05}}, "connector_pipeline_timer": 0.0003208300383325654}, "module_to_env_connector": {"timers": {"connectors": {"module_to_agent_unmapping": 6.301732881452944e-06, "listify_data_for_vector_env": 2.0212196352538533e-05, "remove_single_ts_time_rank_from_batch": 2.6293472643104586e-06, "get_actions": 0.0003522755256084982, "tensor_to_numpy": 8.606515400666278e-05, "normalize_and_clip_actions": 0.00017946013900962046, "un_batch_to_individual_items": 4.890037342127183e-05}}, "connector_pipeline_timer": 0.0008090448728478031}, "timers": {"connectors": {"numpy_to_tensor": 8.204580300759972e-05, "add_observations_from_episodes_to_batch": 5.9324425339377736e-05, "add_states_from_episodes_to_batch": 8.89833751830338e-06, "add_time_dim_to_batch_and_zero_pad": 2.1234595695909775e-05, "agent_to_module_mapping": 9.040451916848727e-06, "batch_individual_items": 4.4396918699567314e-05}}, "episode_len_mean": 1417.0, "num_module_steps_sampled_lifetime": {"exo_policy": 8502, "human_policy": 8502}, "env_reset_timer": 0.08987832487181369, "weights_seq_no": 2.0, "env_to_module_sum_episodes_length_out": 2621.831824891575, "episode_duration_sec_mean": 14.61265941399995, "env_step_timer": 0.005580024153496771, "num_env_steps_sampled_lifetime": 8502, "num_module_steps_sampled": {"human_policy": 2834, "exo_policy": 2834}, "module_episode_returns_mean": {"exo_policy": 1745.8942459864659, "human_policy": 1315.8487725210396}, "custom": {"human": {"R_p_mean": 0.39120433897285417, "R_a_mean": 0.12051781310273903, "R_proprio_mean": 0.41689377772048286}, "exo": {"R_t_mean": 0.11353582784647322, "R_eas_mean": 0.18995427339941687}}, "rlmodule_inference_timer": 0.0005725207608127555, "episode_return_min": 3053.8298942453657, "agent_episode_returns_mean": {"exo": 1745.8942459864659, "human": 1315.8487725210396}, "num_episodes_lifetime": 6, "episode_len_max": 1417, "num_env_steps_sampled": 2834, "connector_pipeline_timer": 0.0005255183336829305, "num_episodes": 2, "num_agent_steps_sampled_lifetime": {"exo": 8502, "human": 8502}, "agent_steps": {"exo": 1417.0, "human": 1417.0}, "sample": 14.797101472544473, "episode_len_min": 1417, "episode_return_max": 3065.688368639143, "env_to_module_sum_episodes_length_in": 2621.831824891575, "episode_return_mean": 3061.743018507505, "time_between_sampling": 4.26061215376008, "num_env_steps_sampled_lifetime_throughput": 154.5855807021012}, "learners": {"exo_policy": {"vf_loss_unclipped": 13623.6279296875, "mean_kl_loss": 0.009138226509094238, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 9.912710189819336, "num_trainable_parameters": 135429, "curr_kl_coeff": 0.45000001788139343, "num_module_steps_trained": 28416, "num_module_steps_trained_lifetime": 85248, "vf_loss": 9.925143241882324, "default_optimizer_learning_rate": 0.0005, "weights_seq_no": 3.0, "vf_explained_var": 0.03338027000427246, "policy_loss": -0.016544193029403687, "module_train_batch_size_mean": 128.0, "curr_entropy_coeff": 0.0, "entropy": 2.9231960773468018, "num_module_steps_trained_lifetime_throughput": 1543.8326565130333}, "human_policy": {"num_module_steps_trained": 28416, "num_module_steps_trained_lifetime": 85248, "vf_loss": 10.0, "default_optimizer_learning_rate": 0.0005, "weights_seq_no": 3.0, "vf_explained_var": 0.009108901023864746, "policy_loss": -0.10055205225944519, "module_train_batch_size_mean": 128.0, "curr_entropy_coeff": 0.0, "entropy": 140.68081665039062, "vf_loss_unclipped": 6639.267578125, "mean_kl_loss": 0.10443516820669174, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 9.946444511413574, "num_trainable_parameters": 309701, "curr_kl_coeff": 0.675000011920929, "num_module_steps_trained_lifetime_throughput": 1543.824253110226}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.045798069668324705, "add_observations_from_episodes_to_batch": 0.00010740143136847565, "agent_to_module_mapping": 0.004528135520187675, "add_one_ts_to_episodes_and_truncate": 0.007913886689407923, "add_columns_from_episodes_to_train_batch": 0.08513592974560522, "add_time_dim_to_batch_and_zero_pad": 8.267045264713033e-05, "numpy_to_tensor": 0.0002676288514045609, "add_states_from_episodes_to_batch": 1.0278794868440855e-05, "batch_individual_items": 0.2255076962104101}}, "connector_pipeline_timer": 0.37021060295649955}, "num_trainable_parameters": 445130, "num_env_steps_trained": 629148, "num_module_steps_trained": 56832, "num_env_steps_trained_lifetime": 1887444, "learner_connector_sum_episodes_length_out": 2834.0, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 2834.0, "num_module_steps_trained_lifetime": 170496, "num_env_steps_trained_lifetime_throughput": 34181.730138185434, "num_module_steps_trained_lifetime_throughput": 3087.6998432995765}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 8502, "fault_tolerance": {"num_healthy_workers": 1, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 1}, "done": false, "training_iteration": 3, "trial_id": "dc8cf_00001", "date": "2025-11-20_14-49-10", "timestamp": 1763621350, "time_this_iter_s": 18.371861219406128, "time_total_s": 55.48237180709839, "pid": 11835, "hostname": "CS-ubuntu", "node_ip": "10.207.136.136", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MARL_EXO_ENV", "env_config": {"render_mode": "human", "render_bool": false, "frame_skip": 2, "model_path": "/home/chenshuo/PycharmProjects/move_sim/SMPL/data/xml/mj_fullbody_with_exo_carrying_policy_test.xml", "n_stacks": 1, "human_obs_keys": ["qpos", "local_body_pos", "local_body_vel", "local_body_rot_obs", "local_body_angle_vel"], "exo_obs_keys": ["exo_joint_t", "exo_joint_vel_t"], "weighted_reward_keys": {"w_pos_err": 0.5, "w_proprio_err": 0.6, "w_activation": 0.4, "w_exo_energy": 0.2, "w_exo_smooth": 0.3, "theta_pos_err": 0.1, "theta_proprio_err": 0.03, "theta_activation": 0.03, "theta_exo_energy": 0.01, "theta_exo_smooth": 0.2}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 2, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 120, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 128, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7fcae53aeb90>", "policies_to_train": ["human_policy", "exo_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"human_policy": [null, "Box(-inf, inf, (248,), float32)", "Box(0.0, 1.0, (98,), float32)", {"model": {"custom_model": "human_model"}}], "exo_policy": [null, "Box(-10.0, 10.0, (4,), float32)", "Box(-0.261799, 2.0944, (2,), float32)", {"model": {"custom_model": "exo_model"}}]}, "callbacks": "<class 'SMPL.src.Custom_CallBack.RewardLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 55.48237180709839, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 19.241666666666667, "ram_util_percent": 56.51666666666667, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.001953125}}
{"timers": {"training_iteration": 19.006144342841374, "restore_env_runners": 2.1733010363636138e-05, "training_step": 19.00562139834588, "env_runner_sampling_timer": 14.821653147214445, "learner_update_timer": 4.176906400495308, "synch_weights": 0.00446266273551266, "synch_env_connectors": 0.003534977704507742}, "env_runners": {"num_agent_steps_sampled": {"human": 2834, "exo": 2834}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 7.813877724503497e-06, "add_time_dim_to_batch_and_zero_pad": 1.9366993724817674e-05, "agent_to_module_mapping": 8.831505407279296e-06, "batch_individual_items": 4.353203521732796e-05, "numpy_to_tensor": 9.711947126527498e-05, "add_observations_from_episodes_to_batch": 4.2386686893458586e-05}}, "connector_pipeline_timer": 0.00030860878643196847}, "module_to_env_connector": {"timers": {"connectors": {"module_to_agent_unmapping": 6.285992565667814e-06, "listify_data_for_vector_env": 2.011585253062415e-05, "remove_single_ts_time_rank_from_batch": 2.601897060329556e-06, "get_actions": 0.00034596893274148956, "tensor_to_numpy": 8.583286061955376e-05, "normalize_and_clip_actions": 0.0001793090578912659, "un_batch_to_individual_items": 4.9408439816481695e-05}}, "connector_pipeline_timer": 0.0008011983374781596}, "timers": {"connectors": {"numpy_to_tensor": 8.219424497874957e-05, "add_observations_from_episodes_to_batch": 5.955079108576433e-05, "add_states_from_episodes_to_batch": 8.891714142971523e-06, "add_time_dim_to_batch_and_zero_pad": 2.1417829736935574e-05, "agent_to_module_mapping": 9.032317398483204e-06, "batch_individual_items": 4.440462951299559e-05}}, "episode_len_mean": 1417.0, "num_module_steps_sampled_lifetime": {"exo_policy": 11336, "human_policy": 11336}, "env_reset_timer": 0.08937739266309529, "weights_seq_no": 3.0, "env_to_module_sum_episodes_length_out": 2621.831824891575, "episode_duration_sec_mean": 14.521864477624973, "env_step_timer": 0.005465567627443159, "num_env_steps_sampled_lifetime": 11336, "num_module_steps_sampled": {"human_policy": 2834, "exo_policy": 2834}, "module_episode_returns_mean": {"exo_policy": 1745.188607369922, "human_policy": 1315.7373854674443}, "custom": {"human": {"R_p_mean": 0.3911721821374399, "R_a_mean": 0.12050498550829003, "R_proprio_mean": 0.41686015449078717}, "exo": {"R_t_mean": 0.11331421486145563, "R_eas_mean": 0.1897565133689445}}, "rlmodule_inference_timer": 0.0005296029497639638, "episode_return_min": 3053.8298942453657, "agent_episode_returns_mean": {"exo": 1745.188607369922, "human": 1315.7373854674443}, "num_episodes_lifetime": 8, "episode_len_max": 1417, "num_env_steps_sampled": 2834, "connector_pipeline_timer": 0.0005242077703464124, "num_episodes": 2, "num_agent_steps_sampled_lifetime": {"exo": 11336, "human": 11336}, "agent_steps": {"exo": 1417.0, "human": 1417.0}, "sample": 14.792668136009027, "episode_len_min": 1417, "episode_return_max": 3065.688368639143, "env_to_module_sum_episodes_length_in": 2621.831824891575, "episode_return_mean": 3060.925992837366, "time_between_sampling": 4.25382528755248, "num_env_steps_sampled_lifetime_throughput": 154.75746265423516}, "learners": {"exo_policy": {"vf_loss_unclipped": 14410.490234375, "mean_kl_loss": 0.02829129435122013, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 9.883055686950684, "num_trainable_parameters": 135429, "curr_kl_coeff": 0.675000011920929, "num_module_steps_trained": 28416, "num_module_steps_trained_lifetime": 113664, "vf_loss": 10.0, "default_optimizer_learning_rate": 0.0005, "weights_seq_no": 4.0, "vf_explained_var": 0.03072655200958252, "policy_loss": -0.12967555224895477, "module_train_batch_size_mean": 128.0, "curr_entropy_coeff": 0.0, "entropy": 2.824812889099121, "num_module_steps_trained_lifetime_throughput": 1544.9908517817785}, "human_policy": {"num_module_steps_trained": 28416, "num_module_steps_trained_lifetime": 113664, "vf_loss": 10.0, "default_optimizer_learning_rate": 0.0005, "weights_seq_no": 4.0, "vf_explained_var": 0.011040806770324707, "policy_loss": -0.2572442889213562, "module_train_batch_size_mean": 128.0, "curr_entropy_coeff": 0.0, "entropy": 140.44105529785156, "vf_loss_unclipped": 7394.4755859375, "mean_kl_loss": 0.07219525426626205, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 9.791487693786621, "num_trainable_parameters": 309701, "curr_kl_coeff": 1.0125000476837158, "num_module_steps_trained_lifetime_throughput": 1544.9830334707349}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.045577680781639776, "add_observations_from_episodes_to_batch": 0.0001074758570558795, "agent_to_module_mapping": 0.004530404454986598, "add_one_ts_to_episodes_and_truncate": 0.007903503532512941, "add_columns_from_episodes_to_train_batch": 0.08515489884814809, "add_time_dim_to_batch_and_zero_pad": 8.211848812100901e-05, "numpy_to_tensor": 0.00026689946289222777, "add_states_from_episodes_to_batch": 1.0271196918075703e-05, "batch_individual_items": 0.22549780027830638}}, "connector_pipeline_timer": 0.3699850017269354}, "num_trainable_parameters": 445130, "num_env_steps_trained": 629148, "num_module_steps_trained": 56832, "num_env_steps_trained_lifetime": 2516592, "learner_connector_sum_episodes_length_out": 2834.0, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 2834.0, "num_module_steps_trained_lifetime": 227328, "num_env_steps_trained_lifetime_throughput": 34207.357344706696, "num_module_steps_trained_lifetime_throughput": 3090.014421309115}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 11336, "fault_tolerance": {"num_healthy_workers": 1, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 1}, "done": false, "training_iteration": 4, "trial_id": "dc8cf_00001", "date": "2025-11-20_14-49-29", "timestamp": 1763621369, "time_this_iter_s": 18.117950201034546, "time_total_s": 73.60032200813293, "pid": 11835, "hostname": "CS-ubuntu", "node_ip": "10.207.136.136", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MARL_EXO_ENV", "env_config": {"render_mode": "human", "render_bool": false, "frame_skip": 2, "model_path": "/home/chenshuo/PycharmProjects/move_sim/SMPL/data/xml/mj_fullbody_with_exo_carrying_policy_test.xml", "n_stacks": 1, "human_obs_keys": ["qpos", "local_body_pos", "local_body_vel", "local_body_rot_obs", "local_body_angle_vel"], "exo_obs_keys": ["exo_joint_t", "exo_joint_vel_t"], "weighted_reward_keys": {"w_pos_err": 0.5, "w_proprio_err": 0.6, "w_activation": 0.4, "w_exo_energy": 0.2, "w_exo_smooth": 0.3, "theta_pos_err": 0.1, "theta_proprio_err": 0.03, "theta_activation": 0.03, "theta_exo_energy": 0.01, "theta_exo_smooth": 0.2}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 2, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 120, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 128, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7fcae53aed40>", "policies_to_train": ["human_policy", "exo_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"human_policy": [null, "Box(-inf, inf, (248,), float32)", "Box(0.0, 1.0, (98,), float32)", {"model": {"custom_model": "human_model"}}], "exo_policy": [null, "Box(-10.0, 10.0, (4,), float32)", "Box(-0.261799, 2.0944, (2,), float32)", {"model": {"custom_model": "exo_model"}}]}, "callbacks": "<class 'SMPL.src.Custom_CallBack.RewardLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 73.60032200813293, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 19.25, "ram_util_percent": 56.6, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.001953125}}
{"timers": {"training_iteration": 18.996989247832964, "restore_env_runners": 2.197247025867937e-05, "training_step": 18.996466162612418, "env_runner_sampling_timer": 14.819386264302302, "learner_update_timer": 4.170056269790355, "synch_weights": 0.004441550408156157, "synch_env_connectors": 0.0035165721074620917}, "env_runners": {"num_agent_steps_sampled": {"human": 2834, "exo": 2834}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 8.027890702685468e-06, "add_time_dim_to_batch_and_zero_pad": 2.0858149051214285e-05, "agent_to_module_mapping": 9.32091677495684e-06, "batch_individual_items": 4.571498433446306e-05, "numpy_to_tensor": 0.00010326137284739345, "add_observations_from_episodes_to_batch": 4.454576708263916e-05}}, "connector_pipeline_timer": 0.000323994900747495}, "module_to_env_connector": {"timers": {"connectors": {"module_to_agent_unmapping": 6.586830387966079e-06, "listify_data_for_vector_env": 2.059021056005246e-05, "remove_single_ts_time_rank_from_batch": 2.748236511325538e-06, "get_actions": 0.0003535507918746123, "tensor_to_numpy": 8.637841051359277e-05, "normalize_and_clip_actions": 0.00018123383368542591, "un_batch_to_individual_items": 4.891141346763715e-05}}, "connector_pipeline_timer": 0.0008135989418252365}, "timers": {"connectors": {"numpy_to_tensor": 8.217387253080252e-05, "add_observations_from_episodes_to_batch": 5.951588317624253e-05, "add_states_from_episodes_to_batch": 8.877847001392116e-06, "add_time_dim_to_batch_and_zero_pad": 2.1423381439592394e-05, "agent_to_module_mapping": 9.029164225777818e-06, "batch_individual_items": 4.4399233217389105e-05}}, "episode_len_mean": 1417.0, "num_module_steps_sampled_lifetime": {"exo_policy": 14170, "human_policy": 14170}, "env_reset_timer": 0.08888354251646513, "weights_seq_no": 4.0, "env_to_module_sum_episodes_length_out": 2621.831824891575, "episode_duration_sec_mean": 14.511409533699975, "env_step_timer": 0.005546568145525343, "num_env_steps_sampled_lifetime": 14170, "num_module_steps_sampled": {"human_policy": 2834, "exo_policy": 2834}, "module_episode_returns_mean": {"exo_policy": 1746.0444615825577, "human_policy": 1316.0529838521227}, "custom": {"human": {"R_p_mean": 0.39119954906459614, "R_a_mean": 0.12048996960723106, "R_proprio_mean": 0.4170705263896569}, "exo": {"R_t_mean": 0.11336404784361757, "R_eas_mean": 0.19008794773184773}}, "rlmodule_inference_timer": 0.0005667213031923929, "episode_return_min": 3053.8298942453657, "agent_episode_returns_mean": {"exo": 1746.0444615825577, "human": 1316.0529838521227}, "num_episodes_lifetime": 10, "episode_len_max": 1417, "num_env_steps_sampled": 2834, "connector_pipeline_timer": 0.0005220404926424156, "num_episodes": 2, "num_agent_steps_sampled_lifetime": {"exo": 14170, "human": 14170}, "agent_steps": {"exo": 1417.0, "human": 1417.0}, "sample": 14.790461061898938, "episode_len_min": 1417, "episode_return_max": 3067.7517423217714, "env_to_module_sum_episodes_length_in": 2621.831824891575, "episode_return_mean": 3062.09744543468, "time_between_sampling": 4.249122235956955, "num_env_steps_sampled_lifetime_throughput": 154.74008840027176}, "learners": {"exo_policy": {"vf_loss_unclipped": 13516.185546875, "mean_kl_loss": 0.011472342535853386, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 9.981304168701172, "num_trainable_parameters": 135429, "curr_kl_coeff": 0.675000011920929, "num_module_steps_trained": 28416, "num_module_steps_trained_lifetime": 142080, "vf_loss": 9.975752830505371, "default_optimizer_learning_rate": 0.0005, "weights_seq_no": 5.0, "vf_explained_var": 0.008156418800354004, "policy_loss": -0.002193428110331297, "module_train_batch_size_mean": 128.0, "curr_entropy_coeff": 0.0, "entropy": 2.988712787628174, "num_module_steps_trained_lifetime_throughput": 1546.1649150332025}, "human_policy": {"num_module_steps_trained": 28416, "num_module_steps_trained_lifetime": 142080, "vf_loss": 9.984945297241211, "default_optimizer_learning_rate": 0.0005, "weights_seq_no": 5.0, "vf_explained_var": 0.015576362609863281, "policy_loss": 0.05970335006713867, "module_train_batch_size_mean": 128.0, "curr_entropy_coeff": 0.0, "entropy": 140.99325561523438, "vf_loss_unclipped": 6046.26904296875, "mean_kl_loss": 0.06900797039270401, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 10.114518165588379, "num_trainable_parameters": 309701, "curr_kl_coeff": 1.5187500715255737, "num_module_steps_trained_lifetime_throughput": 1546.157355693863}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.045377485013824215, "add_observations_from_episodes_to_batch": 0.00010711609848408393, "agent_to_module_mapping": 0.004531912030436703, "add_one_ts_to_episodes_and_truncate": 0.007879039637189183, "add_columns_from_episodes_to_train_batch": 0.08513951945966632, "add_time_dim_to_batch_and_zero_pad": 8.166201324137582e-05, "numpy_to_tensor": 0.00026670118826423433, "add_states_from_episodes_to_batch": 1.0281204948273842e-05, "batch_individual_items": 0.22379314656552324}}, "connector_pipeline_timer": 0.36803579269966485}, "num_trainable_parameters": 445130, "num_env_steps_trained": 629148, "num_module_steps_trained": 56832, "num_env_steps_trained_lifetime": 3145740, "learner_connector_sum_episodes_length_out": 2834.0, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 2834.0, "num_module_steps_trained_lifetime": 284160, "num_env_steps_trained_lifetime_throughput": 34233.334388036805, "num_module_steps_trained_lifetime_throughput": 3092.3607240839287}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 14170, "fault_tolerance": {"num_healthy_workers": 1, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 1}, "done": false, "training_iteration": 5, "trial_id": "dc8cf_00001", "date": "2025-11-20_14-49-47", "timestamp": 1763621387, "time_this_iter_s": 18.09605574607849, "time_total_s": 91.69637775421143, "pid": 11835, "hostname": "CS-ubuntu", "node_ip": "10.207.136.136", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MARL_EXO_ENV", "env_config": {"render_mode": "human", "render_bool": false, "frame_skip": 2, "model_path": "/home/chenshuo/PycharmProjects/move_sim/SMPL/data/xml/mj_fullbody_with_exo_carrying_policy_test.xml", "n_stacks": 1, "human_obs_keys": ["qpos", "local_body_pos", "local_body_vel", "local_body_rot_obs", "local_body_angle_vel"], "exo_obs_keys": ["exo_joint_t", "exo_joint_vel_t"], "weighted_reward_keys": {"w_pos_err": 0.5, "w_proprio_err": 0.6, "w_activation": 0.4, "w_exo_energy": 0.2, "w_exo_smooth": 0.3, "theta_pos_err": 0.1, "theta_proprio_err": 0.03, "theta_activation": 0.03, "theta_exo_energy": 0.01, "theta_exo_smooth": 0.2}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 2, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 120, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 128, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7fcae557f370>", "policies_to_train": ["human_policy", "exo_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"human_policy": [null, "Box(-inf, inf, (248,), float32)", "Box(0.0, 1.0, (98,), float32)", {"model": {"custom_model": "human_model"}}], "exo_policy": [null, "Box(-10.0, 10.0, (4,), float32)", "Box(-0.261799, 2.0944, (2,), float32)", {"model": {"custom_model": "exo_model"}}]}, "callbacks": "<class 'SMPL.src.Custom_CallBack.RewardLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 91.69637775421143, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 19.358333333333334, "ram_util_percent": 56.57500000000001, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.001953125}}
{"timers": {"training_iteration": 18.990196886794635, "restore_env_runners": 2.1940215556220663e-05, "training_step": 18.989674794586293, "env_runner_sampling_timer": 14.81654304850928, "learner_update_timer": 4.166138410132451, "synch_weights": 0.004428425404073299, "synch_env_connectors": 0.003497343326388682}, "env_runners": {"num_agent_steps_sampled": {"human": 2834, "exo": 2834}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 7.75922224696056e-06, "add_time_dim_to_batch_and_zero_pad": 2.0896191875829964e-05, "agent_to_module_mapping": 9.368599332294545e-06, "batch_individual_items": 4.5508469808036596e-05, "numpy_to_tensor": 0.0001053266169080401, "add_observations_from_episodes_to_batch": 4.415554358781881e-05}}, "connector_pipeline_timer": 0.00032410272990499684}, "module_to_env_connector": {"timers": {"connectors": {"module_to_agent_unmapping": 6.3585620638577095e-06, "listify_data_for_vector_env": 2.069929543667095e-05, "remove_single_ts_time_rank_from_batch": 2.662094109777933e-06, "get_actions": 0.0003503036317405402, "tensor_to_numpy": 8.652008484335403e-05, "normalize_and_clip_actions": 0.0001839154916998348, "un_batch_to_individual_items": 4.889769057057004e-05}}, "connector_pipeline_timer": 0.0008115812115760154}, "timers": {"connectors": {"numpy_to_tensor": 8.212404380722564e-05, "add_observations_from_episodes_to_batch": 5.952059434434005e-05, "add_states_from_episodes_to_batch": 8.866218531757527e-06, "add_time_dim_to_batch_and_zero_pad": 2.1411637625643612e-05, "agent_to_module_mapping": 9.01461258289453e-06, "batch_individual_items": 4.436794088404819e-05}}, "episode_len_mean": 1417.0, "num_module_steps_sampled_lifetime": {"exo_policy": 17004, "human_policy": 17004}, "env_reset_timer": 0.08837929143129997, "weights_seq_no": 5.0, "env_to_module_sum_episodes_length_out": 2621.831824891575, "episode_duration_sec_mean": 14.496603720499971, "env_step_timer": 0.005593885360633383, "num_env_steps_sampled_lifetime": 17004, "num_module_steps_sampled": {"human_policy": 2834, "exo_policy": 2834}, "module_episode_returns_mean": {"exo_policy": 1745.5730907626348, "human_policy": 1316.291992707989}, "custom": {"human": {"R_p_mean": 0.39122652574445677, "R_a_mean": 0.12045465045217953, "R_proprio_mean": 0.41724754131076613}, "exo": {"R_t_mean": 0.11305399918143337, "R_eas_mean": 0.18989666987618484}}, "rlmodule_inference_timer": 0.0005825540818429602, "episode_return_min": 3053.8298942453657, "agent_episode_returns_mean": {"exo": 1745.5730907626348, "human": 1316.291992707989}, "num_episodes_lifetime": 12, "episode_len_max": 1417, "num_env_steps_sampled": 2834, "connector_pipeline_timer": 0.0005198804477158271, "num_episodes": 2, "num_agent_steps_sampled_lifetime": {"exo": 17004, "human": 17004}, "agent_steps": {"exo": 1417.0, "human": 1417.0}, "sample": 14.78769518858995, "episode_len_min": 1417, "episode_return_max": 3067.7517423217714, "env_to_module_sum_episodes_length_in": 2621.831824891575, "episode_return_mean": 3061.865083470624, "time_between_sampling": 4.242167560087386, "num_env_steps_sampled_lifetime_throughput": 154.84651991023082}, "learners": {"exo_policy": {"vf_loss_unclipped": 13729.767578125, "mean_kl_loss": 0.01171477697789669, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 9.889779090881348, "num_trainable_parameters": 135429, "curr_kl_coeff": 0.675000011920929, "num_module_steps_trained": 28416, "num_module_steps_trained_lifetime": 170496, "vf_loss": 9.944540977478027, "default_optimizer_learning_rate": 0.0005, "weights_seq_no": 6.0, "vf_explained_var": 0.016551733016967773, "policy_loss": -0.06266926229000092, "module_train_batch_size_mean": 128.0, "curr_entropy_coeff": 0.0, "entropy": 2.9354496002197266, "num_module_steps_trained_lifetime_throughput": 1546.2758027678462}, "human_policy": {"num_module_steps_trained": 28416, "num_module_steps_trained_lifetime": 170496, "vf_loss": 10.0, "default_optimizer_learning_rate": 0.0005, "weights_seq_no": 6.0, "vf_explained_var": 0.01956111192703247, "policy_loss": -0.15094928443431854, "module_train_batch_size_mean": 128.0, "curr_entropy_coeff": 0.0, "entropy": 140.8423309326172, "vf_loss_unclipped": 6964.45654296875, "mean_kl_loss": 0.044124700129032135, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 9.916065216064453, "num_trainable_parameters": 309701, "curr_kl_coeff": 2.278125047683716, "num_module_steps_trained_lifetime_throughput": 1546.2691041276757}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.045189178093684494, "add_observations_from_episodes_to_batch": 0.00010691762749929416, "agent_to_module_mapping": 0.0045316383801335776, "add_one_ts_to_episodes_and_truncate": 0.007867638060817651, "add_columns_from_episodes_to_train_batch": 0.08515664906507027, "add_time_dim_to_batch_and_zero_pad": 8.111772310978765e-05, "numpy_to_tensor": 0.0002665770163815247, "add_states_from_episodes_to_batch": 1.0275872897903797e-05, "batch_individual_items": 0.22205970563986754}}, "connector_pipeline_timer": 0.3661133194826685}, "num_trainable_parameters": 445130, "num_env_steps_trained": 629148, "num_module_steps_trained": 56832, "num_env_steps_trained_lifetime": 3774888, "learner_connector_sum_episodes_length_out": 2834.0, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 2834.0, "num_module_steps_trained_lifetime": 340992, "num_env_steps_trained_lifetime_throughput": 34235.76289628116, "num_module_steps_trained_lifetime_throughput": 3092.5788948752147}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 17004, "fault_tolerance": {"num_healthy_workers": 1, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 1}, "done": false, "training_iteration": 6, "trial_id": "dc8cf_00001", "date": "2025-11-20_14-50-05", "timestamp": 1763621405, "time_this_iter_s": 18.324503183364868, "time_total_s": 110.0208809375763, "pid": 11835, "hostname": "CS-ubuntu", "node_ip": "10.207.136.136", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MARL_EXO_ENV", "env_config": {"render_mode": "human", "render_bool": false, "frame_skip": 2, "model_path": "/home/chenshuo/PycharmProjects/move_sim/SMPL/data/xml/mj_fullbody_with_exo_carrying_policy_test.xml", "n_stacks": 1, "human_obs_keys": ["qpos", "local_body_pos", "local_body_vel", "local_body_rot_obs", "local_body_angle_vel"], "exo_obs_keys": ["exo_joint_t", "exo_joint_vel_t"], "weighted_reward_keys": {"w_pos_err": 0.5, "w_proprio_err": 0.6, "w_activation": 0.4, "w_exo_energy": 0.2, "w_exo_smooth": 0.3, "theta_pos_err": 0.1, "theta_proprio_err": 0.03, "theta_activation": 0.03, "theta_exo_energy": 0.01, "theta_exo_smooth": 0.2}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 2, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 120, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 128, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7fcae557f400>", "policies_to_train": ["human_policy", "exo_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"human_policy": [null, "Box(-inf, inf, (248,), float32)", "Box(0.0, 1.0, (98,), float32)", {"model": {"custom_model": "human_model"}}], "exo_policy": [null, "Box(-10.0, 10.0, (4,), float32)", "Box(-0.261799, 2.0944, (2,), float32)", {"model": {"custom_model": "exo_model"}}]}, "callbacks": "<class 'SMPL.src.Custom_CallBack.RewardLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 110.0208809375763, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 19.666666666666668, "ram_util_percent": 55.36249999999999, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.001953125}}
{"timers": {"training_iteration": 18.98036344181669, "restore_env_runners": 2.1903873399675588e-05, "training_step": 18.97984240184043, "env_runner_sampling_timer": 14.813216144884185, "learner_update_timer": 4.159665122201126, "synch_weights": 0.0044084496900309664, "synch_env_connectors": 0.0034861113331246625}, "env_runners": {"num_agent_steps_sampled": {"human": 2834, "exo": 2834}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 7.95136409547434e-06, "add_time_dim_to_batch_and_zero_pad": 2.087785578320198e-05, "agent_to_module_mapping": 9.426880841636319e-06, "batch_individual_items": 4.5790500931262495e-05, "numpy_to_tensor": 0.00010355228432359817, "add_observations_from_episodes_to_batch": 4.5055587419331007e-05}}, "connector_pipeline_timer": 0.0003249007158237883}, "module_to_env_connector": {"timers": {"connectors": {"module_to_agent_unmapping": 6.550558624877089e-06, "listify_data_for_vector_env": 2.0778898741788168e-05, "remove_single_ts_time_rank_from_batch": 2.6444628082137344e-06, "get_actions": 0.00035478291668991814, "tensor_to_numpy": 8.760264466358206e-05, "normalize_and_clip_actions": 0.00018476228780258346, "un_batch_to_individual_items": 4.9898034358712824e-05}}, "connector_pipeline_timer": 0.0008210359181905815}, "timers": {"connectors": {"numpy_to_tensor": 8.225865336741654e-05, "add_observations_from_episodes_to_batch": 5.946824840111995e-05, "add_states_from_episodes_to_batch": 8.846186345972229e-06, "add_time_dim_to_batch_and_zero_pad": 2.138699125110183e-05, "agent_to_module_mapping": 9.000216456334322e-06, "batch_individual_items": 4.432785147488564e-05}}, "episode_len_mean": 1417.0, "num_module_steps_sampled_lifetime": {"exo_policy": 19838, "human_policy": 19838}, "env_reset_timer": 0.08786315928698736, "weights_seq_no": 6.0, "env_to_module_sum_episodes_length_out": 2621.831824891575, "episode_duration_sec_mean": 14.478481722357108, "env_step_timer": 0.005679108087747434, "num_env_steps_sampled_lifetime": 19838, "num_module_steps_sampled": {"human_policy": 2834, "exo_policy": 2834}, "module_episode_returns_mean": {"exo_policy": 1746.0092341740599, "human_policy": 1316.154175740258}, "custom": {"human": {"R_p_mean": 0.39119105998613674, "R_a_mean": 0.12040131493087156, "R_proprio_mean": 0.41723908290956785}, "exo": {"R_t_mean": 0.11311128088675579, "R_eas_mean": 0.19024444136716173}}, "rlmodule_inference_timer": 0.0005934406710539075, "episode_return_min": 3053.8298942453657, "agent_episode_returns_mean": {"exo": 1746.0092341740599, "human": 1316.154175740258}, "num_episodes_lifetime": 14, "episode_len_max": 1417, "num_env_steps_sampled": 2834, "connector_pipeline_timer": 0.0005177744532386671, "num_episodes": 2, "num_agent_steps_sampled_lifetime": {"exo": 19838, "human": 19838}, "agent_steps": {"exo": 1417.0, "human": 1417.0}, "sample": 14.78442722534405, "episode_len_min": 1417, "episode_return_max": 3067.7517423217714, "env_to_module_sum_episodes_length_in": 2621.831824891575, "episode_return_mean": 3062.1634099143184, "time_between_sampling": 4.238027526286511, "num_env_steps_sampled_lifetime_throughput": 154.85139075486532}, "learners": {"exo_policy": {"vf_loss_unclipped": 13787.642578125, "mean_kl_loss": 0.01319411676377058, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 9.878963470458984, "num_trainable_parameters": 135429, "curr_kl_coeff": 0.675000011920929, "num_module_steps_trained": 28416, "num_module_steps_trained_lifetime": 198912, "vf_loss": 9.857723236083984, "default_optimizer_learning_rate": 0.0005, "weights_seq_no": 7.0, "vf_explained_var": 0.0045188069343566895, "policy_loss": 0.01233319565653801, "module_train_batch_size_mean": 128.0, "curr_entropy_coeff": 0.0, "entropy": 2.959021806716919, "num_module_steps_trained_lifetime_throughput": 1547.7566687906246}, "human_policy": {"num_module_steps_trained": 28416, "num_module_steps_trained_lifetime": 198912, "vf_loss": 10.0, "default_optimizer_learning_rate": 0.0005, "weights_seq_no": 7.0, "vf_explained_var": 0.010313272476196289, "policy_loss": -0.04667085409164429, "module_train_batch_size_mean": 128.0, "curr_entropy_coeff": 0.0, "entropy": 140.95326232910156, "vf_loss_unclipped": 6486.58544921875, "mean_kl_loss": 0.03274320811033249, "diff_num_grad_updates_vs_sampler_policy": 1.0, "total_loss": 10.027922630310059, "num_trainable_parameters": 309701, "curr_kl_coeff": 3.4171876907348633, "num_module_steps_trained_lifetime_throughput": 1547.7497248179327}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.04501558006274775, "add_observations_from_episodes_to_batch": 0.00010667455122593308, "agent_to_module_mapping": 0.004531029316332967, "add_one_ts_to_episodes_and_truncate": 0.007853386450210116, "add_columns_from_episodes_to_train_batch": 0.0851400867844201, "add_time_dim_to_batch_and_zero_pad": 8.062515587893924e-05, "numpy_to_tensor": 0.0002669498362181243, "add_states_from_episodes_to_batch": 1.0260784169463979e-05, "batch_individual_items": 0.22036722626346741}}, "connector_pipeline_timer": 0.3642112229778422}, "num_trainable_parameters": 445130, "num_env_steps_trained": 629148, "num_module_steps_trained": 56832, "num_env_steps_trained_lifetime": 4404036, "learner_connector_sum_episodes_length_out": 2834.0, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 2834.0, "num_module_steps_trained_lifetime": 397824, "num_env_steps_trained_lifetime_throughput": 34268.5528382471, "num_module_steps_trained_lifetime_throughput": 3095.5410178530087}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 19838, "fault_tolerance": {"num_healthy_workers": 1, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 1}, "done": true, "training_iteration": 7, "trial_id": "dc8cf_00001", "date": "2025-11-20_14-50-23", "timestamp": 1763621423, "time_this_iter_s": 18.012158393859863, "time_total_s": 128.03303933143616, "pid": 11835, "hostname": "CS-ubuntu", "node_ip": "10.207.136.136", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MARL_EXO_ENV", "env_config": {"render_mode": "human", "render_bool": false, "frame_skip": 2, "model_path": "/home/chenshuo/PycharmProjects/move_sim/SMPL/data/xml/mj_fullbody_with_exo_carrying_policy_test.xml", "n_stacks": 1, "human_obs_keys": ["qpos", "local_body_pos", "local_body_vel", "local_body_rot_obs", "local_body_angle_vel"], "exo_obs_keys": ["exo_joint_t", "exo_joint_vel_t"], "weighted_reward_keys": {"w_pos_err": 0.5, "w_proprio_err": 0.6, "w_activation": 0.4, "w_exo_energy": 0.2, "w_exo_smooth": 0.3, "theta_pos_err": 0.1, "theta_proprio_err": 0.03, "theta_activation": 0.03, "theta_exo_energy": 0.01, "theta_exo_smooth": 0.2}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 2, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 120, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 128, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7fcae56d3f40>", "policies_to_train": ["human_policy", "exo_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"human_policy": [null, "Box(-inf, inf, (248,), float32)", "Box(0.0, 1.0, (98,), float32)", {"model": {"custom_model": "human_model"}}], "exo_policy": [null, "Box(-10.0, 10.0, (4,), float32)", "Box(-0.261799, 2.0944, (2,), float32)", {"model": {"custom_model": "exo_model"}}]}, "callbacks": "<class 'SMPL.src.Custom_CallBack.RewardLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 128.03303933143616, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 19.320833333333336, "ram_util_percent": 55.4, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.001953125}}
