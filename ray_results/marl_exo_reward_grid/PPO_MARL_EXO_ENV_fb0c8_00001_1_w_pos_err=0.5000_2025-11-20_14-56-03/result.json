{"timers": {"training_iteration": 19.096954608999795, "restore_env_runners": 2.06290001187881e-05, "training_step": 19.096621567000057, "env_runner_sampling_timer": 15.014242475999936, "learner_update_timer": 4.077996269999858, "synch_weights": 0.0033215789999303524}, "env_runners": {"episode_len_max": 1417, "episode_return_max": 631.905790791591, "num_env_steps_sampled_lifetime": 2834, "env_step_timer": 0.005692266320533039, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 7.98545067109349e-06, "add_observations_from_episodes_to_batch": 4.3403320074413226e-05, "batch_individual_items": 4.824935920029747e-05, "add_time_dim_to_batch_and_zero_pad": 2.3346880504567586e-05, "numpy_to_tensor": 0.00010125104496717878, "agent_to_module_mapping": 9.61340395102336e-06}}, "connector_pipeline_timer": 0.00032592382303083407}, "module_to_env_connector": {"timers": {"connectors": {"module_to_agent_unmapping": 6.976743007631876e-06, "remove_single_ts_time_rank_from_batch": 2.709606526365573e-06, "listify_data_for_vector_env": 1.9935150279477804e-05, "tensor_to_numpy": 8.820906178624502e-05, "normalize_and_clip_actions": 0.0001866139526415929, "get_actions": 0.0003553960952939919, "un_batch_to_individual_items": 5.0426945211674075e-05}}, "connector_pipeline_timer": 0.0008263862684780354}, "sample": 14.986452031999988, "env_reset_timer": 0.04683196699988912, "env_to_module_sum_episodes_length_in": 2621.8301293409154, "timers": {"connectors": {"batch_individual_items": 9.01809999049874e-05, "add_time_dim_to_batch_and_zero_pad": 4.2641000163712306e-05, "numpy_to_tensor": 0.00030169199999363627, "agent_to_module_mapping": 1.578999990670127e-05, "add_states_from_episodes_to_batch": 1.0348999921916402e-05, "add_observations_from_episodes_to_batch": 0.00010494000002836401}}, "connector_pipeline_timer": 0.0010678769999685755, "custom": {"exo": {"R_eas_mean": 0.04676637362169714, "R_t_mean": 0.01832284451559838}, "human": {"R_proprio_mean": 0.06651894185567558, "R_a_mean": 0.00015194512445561862, "R_p_mean": 0.12334881515743762}}, "num_module_steps_sampled_lifetime": {"human_policy": 2834, "exo_policy": 2834}, "num_agent_steps_sampled": {"human": 2834, "exo": 2834}, "module_episode_returns_mean": {"human_policy": 269.2579179289353, "exo_policy": 361.48934002948323}, "rlmodule_inference_timer": 0.0005770708906991006, "episode_return_min": 629.5887251252461, "num_agent_steps_sampled_lifetime": {"human": 2834, "exo": 2834}, "episode_len_mean": 1417.0, "num_module_steps_sampled": {"human_policy": 2834, "exo_policy": 2834}, "episode_duration_sec_mean": 14.887416328999961, "agent_steps": {"human": 1417.0, "exo": 1417.0}, "num_episodes_lifetime": 2, "episode_return_mean": 630.7472579584186, "agent_episode_returns_mean": {"exo": 361.48934002948323, "human": 269.2579179289353}, "num_episodes": 2, "weights_seq_no": 0.0, "env_to_module_sum_episodes_length_out": 2621.8301293409154, "episode_len_min": 1417, "num_env_steps_sampled": 2834, "num_env_steps_sampled_lifetime_throughput": NaN}, "learners": {"human_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 98.18849182128906, "policy_loss": -0.0374627485871315, "vf_explained_var": 0.44601672887802124, "vf_loss": 6.360076427459717, "curr_entropy_coeff": 0.0, "num_module_steps_trained_lifetime": 28416, "total_loss": 6.365122318267822, "curr_kl_coeff": 0.30000001192092896, "module_train_batch_size_mean": 128.0, "weights_seq_no": 1.0, "num_module_steps_trained": 28416, "entropy": 139.314453125, "mean_kl_loss": 0.2125447392463684, "num_trainable_parameters": 309701, "default_optimizer_learning_rate": 0.0005, "num_module_steps_trained_lifetime_throughput": NaN}, "exo_policy": {"policy_loss": 0.0828845202922821, "vf_explained_var": 0.39091604948043823, "vf_loss": 9.924488067626953, "num_module_steps_trained_lifetime": 28416, "curr_kl_coeff": 0.30000001192092896, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 533.719970703125, "weights_seq_no": 1.0, "curr_entropy_coeff": 0.0, "num_module_steps_trained": 28416, "total_loss": 10.027246475219727, "module_train_batch_size_mean": 128.0, "mean_kl_loss": 0.09936781972646713, "num_trainable_parameters": 135429, "entropy": 2.9164035320281982, "default_optimizer_learning_rate": 0.0005, "num_module_steps_trained_lifetime_throughput": NaN}, "__all_modules__": {"num_trainable_parameters": 445130, "num_env_steps_trained": 629148, "learner_connector": {"timers": {"connectors": {"agent_to_module_mapping": 0.004656632999967769, "batch_individual_items": 0.23829238799999075, "add_time_dim_to_batch_and_zero_pad": 3.3423000104448874e-05, "add_observations_from_episodes_to_batch": 7.474199992429931e-05, "general_advantage_estimation": 0.030018417999826852, "numpy_to_tensor": 0.00028097299991713953, "add_one_ts_to_episodes_and_truncate": 0.006343622000031246, "add_states_from_episodes_to_batch": 1.1172000085934997e-05, "add_columns_from_episodes_to_train_batch": 0.07861330199989425}}, "connector_pipeline_timer": 0.3590137069998036}, "learner_connector_sum_episodes_length_out": 2834, "learner_connector_sum_episodes_length_in": 2834, "num_env_steps_trained_lifetime": 629148, "num_module_steps_trained_lifetime": 56832, "num_module_steps_trained": 56832, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": NaN, "num_module_steps_trained_lifetime_throughput": NaN}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 2834, "fault_tolerance": {"num_healthy_workers": 1, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 1}, "done": false, "training_iteration": 1, "trial_id": "fb0c8_00001", "date": "2025-11-20_14-56-34", "timestamp": 1763621794, "time_this_iter_s": 19.10447072982788, "time_total_s": 19.10447072982788, "pid": 18831, "hostname": "CS-ubuntu", "node_ip": "10.207.136.136", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MARL_EXO_ENV", "env_config": {"render_mode": "human", "render_bool": false, "frame_skip": 2, "model_path": "/home/chenshuo/PycharmProjects/move_sim/SMPL/data/xml/mj_fullbody_with_exo_carrying_policy_test.xml", "n_stacks": 1, "human_obs_keys": ["qpos", "local_body_pos", "local_body_vel", "local_body_rot_obs", "local_body_angle_vel"], "exo_obs_keys": ["exo_joint_t", "exo_joint_vel_t"], "weighted_reward_keys": {"w_pos_err": 0.5, "w_proprio_err": 0.6, "w_activation": 0.4, "w_exo_energy": 0.2, "w_exo_smooth": 0.3, "theta_pos_err": 1, "theta_proprio_err": 0.7, "theta_activation": 0.3, "theta_exo_energy": 0.2, "theta_exo_smooth": 2}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 2, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 120, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 128, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f8b43f68d30>", "policies_to_train": ["human_policy", "exo_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"human_policy": [null, "Box(-inf, inf, (248,), float32)", "Box(0.0, 1.0, (98,), float32)", {"model": {"custom_model": "human_model"}}], "exo_policy": [null, "Box(-10.0, 10.0, (4,), float32)", "Box(-0.261799, 2.0944, (2,), float32)", {"model": {"custom_model": "exo_model"}}]}, "callbacks": "<class 'SMPL.src.Custom_CallBack.RewardLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 19.10447072982788, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 20.2, "ram_util_percent": 56.352, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.001337890625}}
{"timers": {"training_iteration": 19.114455358709797, "restore_env_runners": 2.065375011852666e-05, "training_step": 19.114120362610056, "env_runner_sampling_timer": 15.040087149999938, "learner_update_timer": 4.069644443569859, "synch_weights": 0.0033292124399304157, "synch_env_connectors": 0.003157978999979605}, "env_runners": {"episode_len_max": 1417, "episode_return_max": 632.1306040485606, "num_env_steps_sampled_lifetime": 5668, "env_step_timer": 0.005402653924112675, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 7.902492160380583e-06, "add_observations_from_episodes_to_batch": 4.287563655747708e-05, "batch_individual_items": 4.636753732082134e-05, "add_time_dim_to_batch_and_zero_pad": 2.160006095456009e-05, "numpy_to_tensor": 0.0001000828087450954, "agent_to_module_mapping": 9.49001190988813e-06}}, "connector_pipeline_timer": 0.00031808887947036156}, "module_to_env_connector": {"timers": {"connectors": {"module_to_agent_unmapping": 6.20633802647806e-06, "remove_single_ts_time_rank_from_batch": 2.6803217813352757e-06, "listify_data_for_vector_env": 1.916386130334631e-05, "tensor_to_numpy": 8.278053808355917e-05, "normalize_and_clip_actions": 0.00017737693163019598, "get_actions": 0.00034790342808845037, "un_batch_to_individual_items": 4.788793584036405e-05}}, "connector_pipeline_timer": 0.0007963149303813735}, "sample": 15.01233985155999, "env_reset_timer": 0.0470160911298899, "env_to_module_sum_episodes_length_in": 2621.8318248904784, "timers": {"connectors": {"batch_individual_items": 8.984876990552948e-05, "add_time_dim_to_batch_and_zero_pad": 4.24882101606272e-05, "numpy_to_tensor": 0.00029982936999203955, "agent_to_module_mapping": 1.5744509908017787e-05, "add_states_from_episodes_to_batch": 1.036352992286993e-05, "add_observations_from_episodes_to_batch": 0.00010462009002822015}}, "connector_pipeline_timer": 0.001061415029969339, "custom": {"exo": {"R_eas_mean": 0.0480118923806771, "R_t_mean": 0.016623767453856835}, "human": {"R_proprio_mean": 0.06581566853137633, "R_a_mean": 0.00015711515627277582, "R_p_mean": 0.12343916681094119}}, "num_module_steps_sampled_lifetime": {"human_policy": 5668, "exo_policy": 5668}, "num_agent_steps_sampled": {"human": 2834, "exo": 2834}, "module_episode_returns_mean": {"human_policy": 268.39673385650235, "exo_policy": 359.98546384203723}, "rlmodule_inference_timer": 0.000576976830575135, "episode_return_min": 619.9036708287606, "num_agent_steps_sampled_lifetime": {"human": 5668, "exo": 5668}, "episode_len_mean": 1417.0, "num_module_steps_sampled": {"human_policy": 2834, "exo_policy": 2834}, "episode_duration_sec_mean": 16.17277844824997, "agent_steps": {"human": 1417.0, "exo": 1417.0}, "num_episodes_lifetime": 4, "episode_return_mean": 628.3821976985396, "agent_episode_returns_mean": {"exo": 359.98546384203723, "human": 268.39673385650235}, "num_episodes": 2, "weights_seq_no": 1.0, "env_to_module_sum_episodes_length_out": 2621.8318248904784, "episode_len_min": 1417, "num_env_steps_sampled": 2834, "time_between_sampling": 4.158405096000024, "num_env_steps_sampled_lifetime_throughput": NaN}, "learners": {"human_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 38.126609802246094, "policy_loss": -0.08144231885671616, "vf_explained_var": 0.6738011837005615, "vf_loss": 5.609765529632568, "curr_entropy_coeff": 0.0, "num_module_steps_trained_lifetime": 56832, "total_loss": 5.5692644119262695, "curr_kl_coeff": 0.45000001788139343, "module_train_batch_size_mean": 128.0, "weights_seq_no": 2.0, "num_module_steps_trained": 28416, "entropy": 139.2539825439453, "mean_kl_loss": 0.1364714801311493, "num_trainable_parameters": 309701, "default_optimizer_learning_rate": 0.0005, "num_module_steps_trained_lifetime_throughput": NaN}, "exo_policy": {"policy_loss": -0.035410068929195404, "vf_explained_var": -0.2462294101715088, "vf_loss": 8.066903114318848, "num_module_steps_trained_lifetime": 56832, "curr_kl_coeff": 0.45000001788139343, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 345.6556701660156, "weights_seq_no": 2.0, "curr_entropy_coeff": 0.0, "num_module_steps_trained": 28416, "total_loss": 8.040948867797852, "module_train_batch_size_mean": 128.0, "mean_kl_loss": 0.03151741623878479, "num_trainable_parameters": 135429, "entropy": 2.9385645389556885, "default_optimizer_learning_rate": 0.0005, "num_module_steps_trained_lifetime_throughput": NaN}, "__all_modules__": {"num_trainable_parameters": 445130, "num_env_steps_trained": 629148, "learner_connector": {"timers": {"connectors": {"agent_to_module_mapping": 0.004654780729968025, "batch_individual_items": 0.23645695852999096, "add_time_dim_to_batch_and_zero_pad": 3.33747101035442e-05, "add_observations_from_episodes_to_batch": 7.481192992372598e-05, "general_advantage_estimation": 0.029953340509828195, "numpy_to_tensor": 0.0002805212399175616, "add_one_ts_to_episodes_and_truncate": 0.006324393080030859, "add_states_from_episodes_to_batch": 1.1152350086831575e-05, "add_columns_from_episodes_to_train_batch": 0.07865338415989527}}, "connector_pipeline_timer": 0.3571286306698039}, "learner_connector_sum_episodes_length_out": 2834.0, "learner_connector_sum_episodes_length_in": 2834.0, "num_env_steps_trained_lifetime": 1258296, "num_module_steps_trained_lifetime": 113664, "num_module_steps_trained": 56832, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": NaN, "num_module_steps_trained_lifetime_throughput": NaN}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 5668, "fault_tolerance": {"num_healthy_workers": 1, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 1}, "done": false, "training_iteration": 2, "trial_id": "fb0c8_00001", "date": "2025-11-20_14-56-55", "timestamp": 1763621815, "time_this_iter_s": 20.85348916053772, "time_total_s": 39.9579598903656, "pid": 18831, "hostname": "CS-ubuntu", "node_ip": "10.207.136.136", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MARL_EXO_ENV", "env_config": {"render_mode": "human", "render_bool": false, "frame_skip": 2, "model_path": "/home/chenshuo/PycharmProjects/move_sim/SMPL/data/xml/mj_fullbody_with_exo_carrying_policy_test.xml", "n_stacks": 1, "human_obs_keys": ["qpos", "local_body_pos", "local_body_vel", "local_body_rot_obs", "local_body_angle_vel"], "exo_obs_keys": ["exo_joint_t", "exo_joint_vel_t"], "weighted_reward_keys": {"w_pos_err": 0.5, "w_proprio_err": 0.6, "w_activation": 0.4, "w_exo_energy": 0.2, "w_exo_smooth": 0.3, "theta_pos_err": 1, "theta_proprio_err": 0.7, "theta_activation": 0.3, "theta_exo_energy": 0.2, "theta_exo_smooth": 2}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 2, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 120, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 128, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f8b43de7880>", "policies_to_train": ["human_policy", "exo_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"human_policy": [null, "Box(-inf, inf, (248,), float32)", "Box(0.0, 1.0, (98,), float32)", {"model": {"custom_model": "human_model"}}], "exo_policy": [null, "Box(-10.0, 10.0, (4,), float32)", "Box(-0.261799, 2.0944, (2,), float32)", {"model": {"custom_model": "exo_model"}}]}, "callbacks": "<class 'SMPL.src.Custom_CallBack.RewardLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 39.9579598903656, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 28.292857142857144, "ram_util_percent": 59.307142857142864, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.001953125}}
{"timers": {"training_iteration": 19.1024654148627, "restore_env_runners": 2.062775261799743e-05, "training_step": 19.102129481203956, "env_runner_sampling_timer": 15.036472325779938, "learner_update_timer": 4.061275166064163, "synch_weights": 0.0033257804855312315, "synch_env_connectors": 0.0031478174099811443}, "env_runners": {"episode_len_max": 1417, "episode_return_max": 632.1306040485606, "num_env_steps_sampled_lifetime": 8502, "env_step_timer": 0.005553826819033, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 8.057023196842397e-06, "add_observations_from_episodes_to_batch": 4.4071315964733075e-05, "batch_individual_items": 4.713548677478468e-05, "add_time_dim_to_batch_and_zero_pad": 2.1053740082704423e-05, "numpy_to_tensor": 0.00010048982371104426, "agent_to_module_mapping": 9.611341053567324e-06}}, "connector_pipeline_timer": 0.0003218732595078189}, "module_to_env_connector": {"timers": {"connectors": {"module_to_agent_unmapping": 6.382555183197105e-06, "remove_single_ts_time_rank_from_batch": 2.913868957978858e-06, "listify_data_for_vector_env": 1.987890470418607e-05, "tensor_to_numpy": 8.589626055042136e-05, "normalize_and_clip_actions": 0.0001823131587665863, "get_actions": 0.0003580956643090062, "un_batch_to_individual_items": 5.028466561847866e-05}}, "connector_pipeline_timer": 0.000821957643721828}, "sample": 15.008789891744389, "env_reset_timer": 0.04700936999858968, "env_to_module_sum_episodes_length_in": 2621.831824891575, "timers": {"connectors": {"batch_individual_items": 8.938300220504516e-05, "add_time_dim_to_batch_and_zero_pad": 4.226861805714179e-05, "numpy_to_tensor": 0.00029771815629233057, "agent_to_module_mapping": 1.566711480820686e-05, "add_states_from_episodes_to_batch": 1.0337044624020565e-05, "add_observations_from_episodes_to_batch": 0.0001040984791281062}}, "connector_pipeline_timer": 0.001053911279670069, "custom": {"exo": {"R_eas_mean": 0.0478127232492323, "R_t_mean": 0.01646266834327614}, "human": {"R_proprio_mean": 0.0654204794457194, "R_a_mean": 0.0001494072501279052, "R_p_mean": 0.12358391509045448}}, "num_module_steps_sampled_lifetime": {"human_policy": 8502, "exo_policy": 8502}, "num_agent_steps_sampled": {"human": 2834, "exo": 2834}, "module_episode_returns_mean": {"human_policy": 268.03093713118943, "exo_policy": 359.10916701777427}, "rlmodule_inference_timer": 0.0005654242571276997, "episode_return_min": 619.9036708287606, "num_agent_steps_sampled_lifetime": {"human": 8502, "exo": 8502}, "episode_len_mean": 1417.0, "num_module_steps_sampled": {"human_policy": 2834, "exo_policy": 2834}, "episode_duration_sec_mean": 15.63367398016669, "agent_steps": {"human": 1417.0, "exo": 1417.0}, "num_episodes_lifetime": 6, "episode_return_mean": 627.1401041489636, "agent_episode_returns_mean": {"exo": 359.10916701777427, "human": 268.03093713118943}, "num_episodes": 2, "weights_seq_no": 2.0, "env_to_module_sum_episodes_length_out": 2621.831824891575, "episode_len_min": 1417, "num_env_steps_sampled": 2834, "time_between_sampling": 4.149755509600025, "num_env_steps_sampled_lifetime_throughput": 157.85895708017134}, "learners": {"human_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 20.235595703125, "policy_loss": -0.050986096262931824, "vf_explained_var": 0.7961865067481995, "vf_loss": 2.7795612812042236, "curr_entropy_coeff": 0.0, "num_module_steps_trained_lifetime": 85248, "total_loss": 2.7801036834716797, "curr_kl_coeff": 0.675000011920929, "module_train_batch_size_mean": 128.0, "weights_seq_no": 3.0, "num_module_steps_trained": 28416, "entropy": 139.35226440429688, "mean_kl_loss": 0.11450768262147903, "num_trainable_parameters": 309701, "default_optimizer_learning_rate": 0.0005, "num_module_steps_trained_lifetime_throughput": 1583.6577946286438}, "exo_policy": {"policy_loss": -0.18712112307548523, "vf_explained_var": 0.4632266163825989, "vf_loss": 7.733255863189697, "num_module_steps_trained_lifetime": 85248, "curr_kl_coeff": 0.675000011920929, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 119.35163116455078, "weights_seq_no": 3.0, "curr_entropy_coeff": 0.0, "num_module_steps_trained": 28416, "total_loss": 7.558865070343018, "module_train_batch_size_mean": 128.0, "mean_kl_loss": 0.02829071506857872, "num_trainable_parameters": 135429, "entropy": 2.756302833557129, "default_optimizer_learning_rate": 0.0005, "num_module_steps_trained_lifetime_throughput": 1583.6578370813088}, "__all_modules__": {"num_trainable_parameters": 445130, "num_env_steps_trained": 629148, "learner_connector": {"timers": {"connectors": {"agent_to_module_mapping": 0.004652637452667501, "batch_individual_items": 0.23464392754469124, "add_time_dim_to_batch_and_zero_pad": 3.33344130028081e-05, "add_observations_from_episodes_to_batch": 7.521459062356824e-05, "general_advantage_estimation": 0.02993069498472969, "numpy_to_tensor": 0.0002800843175179807, "add_one_ts_to_episodes_and_truncate": 0.0063190945592316895, "add_states_from_episodes_to_batch": 1.1130196586714193e-05, "add_columns_from_episodes_to_train_batch": 0.07870130612829611}}, "connector_pipeline_timer": 0.35533035966310605}, "learner_connector_sum_episodes_length_out": 2834.0, "learner_connector_sum_episodes_length_in": 2834.0, "num_env_steps_trained_lifetime": 1887444, "num_module_steps_trained_lifetime": 170496, "num_module_steps_trained": 56832, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 35063.203157490294, "num_module_steps_trained_lifetime_throughput": 3167.31604555715}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 8502, "fault_tolerance": {"num_healthy_workers": 1, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 1}, "done": false, "training_iteration": 3, "trial_id": "fb0c8_00001", "date": "2025-11-20_14-57-12", "timestamp": 1763621832, "time_this_iter_s": 17.921539068222046, "time_total_s": 57.87949895858765, "pid": 18831, "hostname": "CS-ubuntu", "node_ip": "10.207.136.136", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MARL_EXO_ENV", "env_config": {"render_mode": "human", "render_bool": false, "frame_skip": 2, "model_path": "/home/chenshuo/PycharmProjects/move_sim/SMPL/data/xml/mj_fullbody_with_exo_carrying_policy_test.xml", "n_stacks": 1, "human_obs_keys": ["qpos", "local_body_pos", "local_body_vel", "local_body_rot_obs", "local_body_angle_vel"], "exo_obs_keys": ["exo_joint_t", "exo_joint_vel_t"], "weighted_reward_keys": {"w_pos_err": 0.5, "w_proprio_err": 0.6, "w_activation": 0.4, "w_exo_energy": 0.2, "w_exo_smooth": 0.3, "theta_pos_err": 1, "theta_proprio_err": 0.7, "theta_activation": 0.3, "theta_exo_energy": 0.2, "theta_exo_smooth": 2}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 2, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 120, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 128, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f8b43f68f70>", "policies_to_train": ["human_policy", "exo_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"human_policy": [null, "Box(-inf, inf, (248,), float32)", "Box(0.0, 1.0, (98,), float32)", {"model": {"custom_model": "human_model"}}], "exo_policy": [null, "Box(-10.0, 10.0, (4,), float32)", "Box(-0.261799, 2.0944, (2,), float32)", {"model": {"custom_model": "exo_model"}}]}, "callbacks": "<class 'SMPL.src.Custom_CallBack.RewardLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 57.87949895858765, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 19.129166666666666, "ram_util_percent": 59.85833333333333, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.001953125}}
{"timers": {"training_iteration": 19.090639890474073, "restore_env_runners": 2.062205509199998e-05, "training_step": 19.090302191241918, "env_runner_sampling_timer": 15.030672944672137, "learner_update_timer": 4.055256636573522, "synch_weights": 0.0033173461006748574, "synch_env_connectors": 0.003138256165881194}, "env_runners": {"episode_len_max": 1417, "episode_return_max": 632.1306040485606, "num_env_steps_sampled_lifetime": 11336, "env_step_timer": 0.005550600384081015, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 8.032145006599314e-06, "add_observations_from_episodes_to_batch": 4.3654953273826087e-05, "batch_individual_items": 4.687826440574592e-05, "add_time_dim_to_batch_and_zero_pad": 2.0950982434955807e-05, "numpy_to_tensor": 0.00010211182547363165, "agent_to_module_mapping": 9.52615150317251e-06}}, "connector_pipeline_timer": 0.0003225712949648801}, "module_to_env_connector": {"timers": {"connectors": {"module_to_agent_unmapping": 6.199839621050922e-06, "remove_single_ts_time_rank_from_batch": 2.667494984608379e-06, "listify_data_for_vector_env": 2.035699044462845e-05, "tensor_to_numpy": 8.45487970560015e-05, "normalize_and_clip_actions": 0.00018236060025094518, "get_actions": 0.00035600701378333546, "un_batch_to_individual_items": 4.950690457014119e-05}}, "connector_pipeline_timer": 0.0008157418581685019}, "sample": 15.003051523886944, "env_reset_timer": 0.046910777798602664, "env_to_module_sum_episodes_length_in": 2621.831824891575, "timers": {"connectors": {"batch_individual_items": 8.892340218151299e-05, "add_time_dim_to_batch_and_zero_pad": 4.203899187669913e-05, "numpy_to_tensor": 0.0002955287647291838, "agent_to_module_mapping": 1.5599213660399754e-05, "add_states_from_episodes_to_batch": 1.030871417773642e-05, "add_observations_from_episodes_to_batch": 0.00010360132433588524}}, "connector_pipeline_timer": 0.0010463829768742557, "custom": {"exo": {"R_eas_mean": 0.047307435532623635, "R_t_mean": 0.016207678619395205}, "human": {"R_proprio_mean": 0.06488605470660193, "R_a_mean": 0.0001486326347883807, "R_p_mean": 0.12365216856327188}}, "num_module_steps_sampled_lifetime": {"human_policy": 11336, "exo_policy": 11336}, "num_agent_steps_sampled": {"human": 2834, "exo": 2834}, "module_episode_returns_mean": {"human_policy": 267.36927481690606, "exo_policy": 357.3701915703171}, "rlmodule_inference_timer": 0.0005739876071528375, "episode_return_min": 614.1525426775344, "num_agent_steps_sampled_lifetime": {"human": 11336, "exo": 11336}, "episode_len_mean": 1417.0, "num_module_steps_sampled": {"human_policy": 2834, "exo_policy": 2834}, "episode_duration_sec_mean": 15.310546645500011, "agent_steps": {"human": 1417.0, "exo": 1417.0}, "num_episodes_lifetime": 8, "episode_return_mean": 624.7394663872232, "agent_episode_returns_mean": {"exo": 357.3701915703171, "human": 267.36927481690606}, "num_episodes": 2, "weights_seq_no": 3.0, "env_to_module_sum_episodes_length_out": 2621.831824891575, "episode_len_min": 1417, "num_env_steps_sampled": 2834, "time_between_sampling": 4.141077808474025, "num_env_steps_sampled_lifetime_throughput": 157.96377773744535}, "learners": {"human_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 7.747231483459473, "policy_loss": -0.12189406156539917, "vf_explained_var": 0.8954673409461975, "vf_loss": 1.6322959661483765, "curr_entropy_coeff": 0.0, "num_module_steps_trained_lifetime": 113664, "total_loss": 1.548563003540039, "curr_kl_coeff": 1.0125000476837158, "module_train_batch_size_mean": 128.0, "weights_seq_no": 4.0, "num_module_steps_trained": 28416, "entropy": 139.34104919433594, "mean_kl_loss": 0.05653483048081398, "num_trainable_parameters": 309701, "default_optimizer_learning_rate": 0.0005, "num_module_steps_trained_lifetime_throughput": 1583.6543113212037}, "exo_policy": {"policy_loss": -0.1141754686832428, "vf_explained_var": 0.5871356725692749, "vf_loss": 7.085228443145752, "num_module_steps_trained_lifetime": 113664, "curr_kl_coeff": 0.675000011920929, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 71.33759307861328, "weights_seq_no": 4.0, "curr_entropy_coeff": 0.0, "num_module_steps_trained": 28416, "total_loss": 6.978988170623779, "module_train_batch_size_mean": 128.0, "mean_kl_loss": 0.01175711490213871, "num_trainable_parameters": 135429, "entropy": 2.8060905933380127, "default_optimizer_learning_rate": 0.0005, "num_module_steps_trained_lifetime_throughput": 1583.654420968346}, "__all_modules__": {"num_trainable_parameters": 445130, "num_env_steps_trained": 629148, "learner_connector": {"timers": {"connectors": {"agent_to_module_mapping": 0.004671287228142033, "batch_individual_items": 0.2347536598692437, "add_time_dim_to_batch_and_zero_pad": 3.334692887361439e-05, "add_observations_from_episodes_to_batch": 7.524683471668571e-05, "general_advantage_estimation": 0.029921888774882364, "numpy_to_tensor": 0.0002811435843432607, "add_one_ts_to_episodes_and_truncate": 0.006309091153639099, "add_states_from_episodes_to_batch": 1.1127094620278286e-05, "add_columns_from_episodes_to_train_batch": 0.07889651471701238}}, "connector_pipeline_timer": 0.35563325189647377}, "learner_connector_sum_episodes_length_out": 2834.0, "learner_connector_sum_episodes_length_in": 2834.0, "num_env_steps_trained_lifetime": 2516592, "num_module_steps_trained_lifetime": 227328, "num_module_steps_trained": 56832, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 35063.12298387232, "num_module_steps_trained_lifetime_throughput": 3167.308994598435}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 11336, "fault_tolerance": {"num_healthy_workers": 1, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 1}, "done": false, "training_iteration": 4, "trial_id": "fb0c8_00001", "date": "2025-11-20_14-57-30", "timestamp": 1763621850, "time_this_iter_s": 17.925864696502686, "time_total_s": 75.80536365509033, "pid": 18831, "hostname": "CS-ubuntu", "node_ip": "10.207.136.136", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MARL_EXO_ENV", "env_config": {"render_mode": "human", "render_bool": false, "frame_skip": 2, "model_path": "/home/chenshuo/PycharmProjects/move_sim/SMPL/data/xml/mj_fullbody_with_exo_carrying_policy_test.xml", "n_stacks": 1, "human_obs_keys": ["qpos", "local_body_pos", "local_body_vel", "local_body_rot_obs", "local_body_angle_vel"], "exo_obs_keys": ["exo_joint_t", "exo_joint_vel_t"], "weighted_reward_keys": {"w_pos_err": 0.5, "w_proprio_err": 0.6, "w_activation": 0.4, "w_exo_energy": 0.2, "w_exo_smooth": 0.3, "theta_pos_err": 1, "theta_proprio_err": 0.7, "theta_activation": 0.3, "theta_exo_energy": 0.2, "theta_exo_smooth": 2}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 2, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 120, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 128, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f8b43d0a680>", "policies_to_train": ["human_policy", "exo_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"human_policy": [null, "Box(-inf, inf, (248,), float32)", "Box(0.0, 1.0, (98,), float32)", {"model": {"custom_model": "human_model"}}], "exo_policy": [null, "Box(-10.0, 10.0, (4,), float32)", "Box(-0.261799, 2.0944, (2,), float32)", {"model": {"custom_model": "exo_model"}}]}, "callbacks": "<class 'SMPL.src.Custom_CallBack.RewardLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 75.80536365509033, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 18.925, "ram_util_percent": 59.887499999999996, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.001953125}}
{"timers": {"training_iteration": 19.076142806109335, "restore_env_runners": 2.0609604540521408e-05, "training_step": 19.075804204769497, "env_runner_sampling_timer": 15.024625047665415, "learner_update_timer": 4.046815676797788, "synch_weights": 0.0033101378996674476, "synch_env_connectors": 0.0031263426742228506}, "env_runners": {"episode_len_max": 1417, "episode_return_max": 635.3895856333289, "num_env_steps_sampled_lifetime": 14170, "env_step_timer": 0.005526768185278037, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 7.997106260263997e-06, "add_observations_from_episodes_to_batch": 4.416445845210514e-05, "batch_individual_items": 4.828785149191048e-05, "add_time_dim_to_batch_and_zero_pad": 2.2099353011077828e-05, "numpy_to_tensor": 0.00010614223302649507, "agent_to_module_mapping": 9.79440329046955e-06}}, "connector_pipeline_timer": 0.00033116247921142843}, "module_to_env_connector": {"timers": {"connectors": {"module_to_agent_unmapping": 6.239001214190826e-06, "remove_single_ts_time_rank_from_batch": 2.696250173312928e-06, "listify_data_for_vector_env": 1.9831758041048545e-05, "tensor_to_numpy": 8.570864736047173e-05, "normalize_and_clip_actions": 0.00018183895665986464, "get_actions": 0.0003527948630844942, "un_batch_to_individual_items": 4.9154579001411504e-05}}, "connector_pipeline_timer": 0.0008128757511317557}, "sample": 14.997072625048073, "env_reset_timer": 0.04682129613061675, "env_to_module_sum_episodes_length_in": 2621.831824891575, "timers": {"connectors": {"batch_individual_items": 8.853551816007484e-05, "add_time_dim_to_batch_and_zero_pad": 4.192959195918537e-05, "numpy_to_tensor": 0.0002934488370832653, "agent_to_module_mapping": 1.5554331524284893e-05, "add_states_from_episodes_to_batch": 1.0289187036762174e-05, "add_observations_from_episodes_to_batch": 0.00010322736109191785}}, "connector_pipeline_timer": 0.0010394986271065213, "custom": {"exo": {"R_eas_mean": 0.04698043893244275, "R_t_mean": 0.01654965751331288}, "human": {"R_proprio_mean": 0.0653674918791892, "R_a_mean": 0.0001509970489589144, "R_p_mean": 0.12358970969824054}}, "num_module_steps_sampled_lifetime": {"human_policy": 14170, "exo_policy": 14170}, "num_agent_steps_sampled": {"human": 2834, "exo": 2834}, "module_episode_returns_mean": {"human_policy": 267.9663174535924, "exo_policy": 357.9884641172285}, "rlmodule_inference_timer": 0.000584164149818534, "episode_return_min": 614.1525426775344, "num_agent_steps_sampled_lifetime": {"human": 14170, "exo": 14170}, "episode_len_mean": 1417.0, "num_module_steps_sampled": {"human_policy": 2834, "exo_policy": 2834}, "episode_duration_sec_mean": 15.110489881199987, "agent_steps": {"human": 1417.0, "exo": 1417.0}, "num_episodes_lifetime": 10, "episode_return_mean": 625.954781570821, "agent_episode_returns_mean": {"exo": 357.9884641172285, "human": 267.9663174535924}, "num_episodes": 2, "weights_seq_no": 4.0, "env_to_module_sum_episodes_length_out": 2621.831824891575, "episode_len_min": 1417, "num_env_steps_sampled": 2834, "time_between_sampling": 4.134764327409283, "num_env_steps_sampled_lifetime_throughput": 157.97560612010625}, "learners": {"human_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 10.242216110229492, "policy_loss": -0.037150848656892776, "vf_explained_var": 0.8796166777610779, "vf_loss": 1.9209166765213013, "curr_entropy_coeff": 0.0, "num_module_steps_trained_lifetime": 142080, "total_loss": 1.9205238819122314, "curr_kl_coeff": 1.5187500715255737, "module_train_batch_size_mean": 128.0, "weights_seq_no": 5.0, "num_module_steps_trained": 28416, "entropy": 139.4130096435547, "mean_kl_loss": 0.03630443662405014, "num_trainable_parameters": 309701, "default_optimizer_learning_rate": 0.0005, "num_module_steps_trained_lifetime_throughput": 1584.8981153994873}, "exo_policy": {"policy_loss": -0.09875950217247009, "vf_explained_var": 0.7620786428451538, "vf_loss": 3.8348281383514404, "num_module_steps_trained_lifetime": 142080, "curr_kl_coeff": 0.675000011920929, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 26.598529815673828, "weights_seq_no": 5.0, "curr_entropy_coeff": 0.0, "num_module_steps_trained": 28416, "total_loss": 3.743952512741089, "module_train_batch_size_mean": 128.0, "mean_kl_loss": 0.011678877286612988, "num_trainable_parameters": 135429, "entropy": 2.9589333534240723, "default_optimizer_learning_rate": 0.0005, "num_module_steps_trained_lifetime_throughput": 1584.8983085097684}, "__all_modules__": {"num_trainable_parameters": 445130, "num_env_steps_trained": 629148, "learner_connector": {"timers": {"connectors": {"agent_to_module_mapping": 0.004674692645861294, "batch_individual_items": 0.23297794376055075, "add_time_dim_to_batch_and_zero_pad": 3.3352709585130165e-05, "add_observations_from_episodes_to_batch": 7.521903636833612e-05, "general_advantage_estimation": 0.029894422327134452, "numpy_to_tensor": 0.00028039404849954493, "add_one_ts_to_episodes_and_truncate": 0.0062970520121040305, "add_states_from_episodes_to_batch": 1.1107493675514118e-05, "add_columns_from_episodes_to_train_batch": 0.07894907480984271}}, "connector_pipeline_timer": 0.35386983408750844}, "learner_connector_sum_episodes_length_out": 2834.0, "learner_connector_sum_episodes_length_in": 2834.0, "num_env_steps_trained_lifetime": 3145740, "num_module_steps_trained_lifetime": 284160, "num_module_steps_trained": 56832, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 35090.65733874265, "num_module_steps_trained_lifetime_throughput": 3169.7962759151196}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 14170, "fault_tolerance": {"num_healthy_workers": 1, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 1}, "done": false, "training_iteration": 5, "trial_id": "fb0c8_00001", "date": "2025-11-20_14-57-48", "timestamp": 1763621868, "time_this_iter_s": 17.64707326889038, "time_total_s": 93.45243692398071, "pid": 18831, "hostname": "CS-ubuntu", "node_ip": "10.207.136.136", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MARL_EXO_ENV", "env_config": {"render_mode": "human", "render_bool": false, "frame_skip": 2, "model_path": "/home/chenshuo/PycharmProjects/move_sim/SMPL/data/xml/mj_fullbody_with_exo_carrying_policy_test.xml", "n_stacks": 1, "human_obs_keys": ["qpos", "local_body_pos", "local_body_vel", "local_body_rot_obs", "local_body_angle_vel"], "exo_obs_keys": ["exo_joint_t", "exo_joint_vel_t"], "weighted_reward_keys": {"w_pos_err": 0.5, "w_proprio_err": 0.6, "w_activation": 0.4, "w_exo_energy": 0.2, "w_exo_smooth": 0.3, "theta_pos_err": 1, "theta_proprio_err": 0.7, "theta_activation": 0.3, "theta_exo_energy": 0.2, "theta_exo_smooth": 2}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 2, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 120, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 128, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f8b43cfb1c0>", "policies_to_train": ["human_policy", "exo_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"human_policy": [null, "Box(-inf, inf, (248,), float32)", "Box(0.0, 1.0, (98,), float32)", {"model": {"custom_model": "human_model"}}], "exo_policy": [null, "Box(-10.0, 10.0, (4,), float32)", "Box(-0.261799, 2.0944, (2,), float32)", {"model": {"custom_model": "exo_model"}}]}, "callbacks": "<class 'SMPL.src.Custom_CallBack.RewardLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 93.45243692398071, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 18.87826086956522, "ram_util_percent": 59.83043478260869, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.001953125}}
{"timers": {"training_iteration": 19.062522495658243, "restore_env_runners": 2.0601988494769692e-05, "training_step": 19.0621832514018, "env_runner_sampling_timer": 15.019278987418762, "learner_update_timer": 4.03855176678981, "synch_weights": 0.0033013181806714974, "synch_env_connectors": 0.003113133227480499}, "env_runners": {"episode_len_max": 1417, "episode_return_max": 635.3895856333289, "num_env_steps_sampled_lifetime": 17004, "env_step_timer": 0.00566742196357969, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 8.351846939632601e-06, "add_observations_from_episodes_to_batch": 4.778501171088162e-05, "batch_individual_items": 5.1468071898094394e-05, "add_time_dim_to_batch_and_zero_pad": 2.4077494973830267e-05, "numpy_to_tensor": 0.00010998898191623192, "agent_to_module_mapping": 1.0557124996987747e-05}}, "connector_pipeline_timer": 0.00035004507565310796}, "module_to_env_connector": {"timers": {"connectors": {"module_to_agent_unmapping": 6.238426322587789e-06, "remove_single_ts_time_rank_from_batch": 2.6917537677791648e-06, "listify_data_for_vector_env": 2.0052415593041745e-05, "tensor_to_numpy": 8.4295433370496e-05, "normalize_and_clip_actions": 0.00018494531728951644, "get_actions": 0.00035363966232952965, "un_batch_to_individual_items": 5.0204608791421405e-05}}, "connector_pipeline_timer": 0.0008168963207210065}, "sample": 14.991787309897592, "env_reset_timer": 0.046778979409309605, "env_to_module_sum_episodes_length_in": 2621.831824891575, "timers": {"connectors": {"batch_individual_items": 8.809119298011295e-05, "add_time_dim_to_batch_and_zero_pad": 4.171768604051714e-05, "numpy_to_tensor": 0.00029136194871406707, "agent_to_module_mapping": 1.548845820889409e-05, "add_states_from_episodes_to_batch": 1.0264945166826943e-05, "add_observations_from_episodes_to_batch": 0.00010276696747900456}}, "connector_pipeline_timer": 0.0010322525008361484, "custom": {"exo": {"R_eas_mean": 0.04739469729251832, "R_t_mean": 0.016591130804670527}, "human": {"R_proprio_mean": 0.06472355200588521, "R_a_mean": 0.000153386584918173, "R_p_mean": 0.1236438670135675}}, "num_module_steps_sampled_lifetime": {"human_policy": 17004, "exo_policy": 17004}, "num_agent_steps_sampled": {"human": 2834, "exo": 2834}, "module_episode_returns_mean": {"human_policy": 267.13398154139327, "exo_policy": 357.8018999551102}, "rlmodule_inference_timer": 0.0005943829544132677, "episode_return_min": 614.1525426775344, "num_agent_steps_sampled_lifetime": {"human": 17004, "exo": 17004}, "episode_len_mean": 1417.0, "num_module_steps_sampled": {"human_policy": 2834, "exo_policy": 2834}, "episode_duration_sec_mean": 14.987440969416658, "agent_steps": {"human": 1417.0, "exo": 1417.0}, "num_episodes_lifetime": 12, "episode_return_mean": 624.9358814965034, "agent_episode_returns_mean": {"exo": 357.8018999551102, "human": 267.13398154139327}, "num_episodes": 2, "weights_seq_no": 5.0, "env_to_module_sum_episodes_length_out": 2621.831824891575, "episode_len_min": 1417, "num_env_steps_sampled": 2834, "time_between_sampling": 4.126188116395192, "num_env_steps_sampled_lifetime_throughput": 158.06150420868346}, "learners": {"human_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 14.146862983703613, "policy_loss": 0.019896864891052246, "vf_explained_var": 0.8255631923675537, "vf_loss": 1.593024730682373, "curr_entropy_coeff": 0.0, "num_module_steps_trained_lifetime": 170496, "total_loss": 1.6632864475250244, "curr_kl_coeff": 2.278125047683716, "module_train_batch_size_mean": 128.0, "weights_seq_no": 6.0, "num_module_steps_trained": 28416, "entropy": 139.31736755371094, "mean_kl_loss": 0.03316206857562065, "num_trainable_parameters": 309701, "default_optimizer_learning_rate": 0.0005, "num_module_steps_trained_lifetime_throughput": 1585.6725407409738}, "exo_policy": {"policy_loss": -0.0801720917224884, "vf_explained_var": 0.7621898055076599, "vf_loss": 3.029907464981079, "num_module_steps_trained_lifetime": 170496, "curr_kl_coeff": 0.675000011920929, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 23.381433486938477, "weights_seq_no": 6.0, "curr_entropy_coeff": 0.0, "num_module_steps_trained": 28416, "total_loss": 2.953794240951538, "module_train_batch_size_mean": 128.0, "mean_kl_loss": 0.006012733560055494, "num_trainable_parameters": 135429, "entropy": 2.908095121383667, "default_optimizer_learning_rate": 0.0005, "num_module_steps_trained_lifetime_throughput": 1585.6726605298993}, "__all_modules__": {"num_trainable_parameters": 445130, "num_env_steps_trained": 629148, "learner_connector": {"timers": {"connectors": {"agent_to_module_mapping": 0.0046741646994013656, "batch_individual_items": 0.23118952507294613, "add_time_dim_to_batch_and_zero_pad": 3.3334972487518644e-05, "add_observations_from_episodes_to_batch": 7.520714600643302e-05, "general_advantage_estimation": 0.029868909043861996, "numpy_to_tensor": 0.000279957188013298, "add_one_ts_to_episodes_and_truncate": 0.006294776561984192, "add_states_from_episodes_to_batch": 1.1095008739775394e-05, "add_columns_from_episodes_to_train_batch": 0.07899669880174412}}, "connector_pipeline_timer": 0.35209715955663173}, "learner_connector_sum_episodes_length_out": 2834.0, "learner_connector_sum_episodes_length_in": 2834.0, "num_env_steps_trained_lifetime": 3774888, "num_module_steps_trained_lifetime": 340992, "num_module_steps_trained": 56832, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 35107.79966547245, "num_module_steps_trained_lifetime_throughput": 3171.3449064355095}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 17004, "fault_tolerance": {"num_healthy_workers": 1, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 1}, "done": false, "training_iteration": 6, "trial_id": "fb0c8_00001", "date": "2025-11-20_14-58-06", "timestamp": 1763621886, "time_this_iter_s": 17.71996569633484, "time_total_s": 111.17240262031555, "pid": 18831, "hostname": "CS-ubuntu", "node_ip": "10.207.136.136", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MARL_EXO_ENV", "env_config": {"render_mode": "human", "render_bool": false, "frame_skip": 2, "model_path": "/home/chenshuo/PycharmProjects/move_sim/SMPL/data/xml/mj_fullbody_with_exo_carrying_policy_test.xml", "n_stacks": 1, "human_obs_keys": ["qpos", "local_body_pos", "local_body_vel", "local_body_rot_obs", "local_body_angle_vel"], "exo_obs_keys": ["exo_joint_t", "exo_joint_vel_t"], "weighted_reward_keys": {"w_pos_err": 0.5, "w_proprio_err": 0.6, "w_activation": 0.4, "w_exo_energy": 0.2, "w_exo_smooth": 0.3, "theta_pos_err": 1, "theta_proprio_err": 0.7, "theta_activation": 0.3, "theta_exo_energy": 0.2, "theta_exo_smooth": 2}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 2, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 120, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 128, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f8b43cfb370>", "policies_to_train": ["human_policy", "exo_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"human_policy": [null, "Box(-inf, inf, (248,), float32)", "Box(0.0, 1.0, (98,), float32)", {"model": {"custom_model": "human_model"}}], "exo_policy": [null, "Box(-10.0, 10.0, (4,), float32)", "Box(-0.261799, 2.0944, (2,), float32)", {"model": {"custom_model": "exo_model"}}]}, "callbacks": "<class 'SMPL.src.Custom_CallBack.RewardLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 111.17240262031555, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 18.817391304347826, "ram_util_percent": 58.63478260869565, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.001953125}}
{"timers": {"training_iteration": 19.05067892981166, "restore_env_runners": 2.058000860984392e-05, "training_step": 19.050337903207783, "env_runner_sampling_timer": 15.015677983354575, "learner_update_timer": 4.030319318991911, "synch_weights": 0.0032918846088662167, "synch_env_connectors": 0.003101951645206854}, "env_runners": {"episode_len_max": 1417, "episode_return_max": 635.3895856333289, "num_env_steps_sampled_lifetime": 19838, "env_step_timer": 0.005830197216291323, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 8.393427427984505e-06, "add_observations_from_episodes_to_batch": 4.612621385799011e-05, "batch_individual_items": 4.87616029677032e-05, "add_time_dim_to_batch_and_zero_pad": 2.207261573876739e-05, "numpy_to_tensor": 0.00010035615010221978, "agent_to_module_mapping": 9.761098232149057e-06}}, "connector_pipeline_timer": 0.0003299823824830824}, "module_to_env_connector": {"timers": {"connectors": {"module_to_agent_unmapping": 6.3795159888031774e-06, "remove_single_ts_time_rank_from_batch": 2.849801853345616e-06, "listify_data_for_vector_env": 2.0311133083251084e-05, "tensor_to_numpy": 8.785312774428755e-05, "normalize_and_clip_actions": 0.0001895728742574001, "get_actions": 0.00036149104161659507, "un_batch_to_individual_items": 5.134153285333486e-05}}, "connector_pipeline_timer": 0.0008380289626244875}, "sample": 14.988239479848614, "env_reset_timer": 0.04673209773521621, "env_to_module_sum_episodes_length_in": 2621.831824891575, "timers": {"connectors": {"batch_individual_items": 8.790089105007682e-05, "add_time_dim_to_batch_and_zero_pad": 4.149967918156339e-05, "numpy_to_tensor": 0.00028983825922756785, "agent_to_module_mapping": 1.54341636271344e-05, "add_states_from_episodes_to_batch": 1.0246855716755074e-05, "add_observations_from_episodes_to_batch": 0.00010228573780523141}}, "connector_pipeline_timer": 0.0010259398658290576, "custom": {"exo": {"R_eas_mean": 0.04723064894526141, "R_t_mean": 0.016131871840475605}, "human": {"R_proprio_mean": 0.06443079751713045, "R_a_mean": 0.00015307463640888626, "R_p_mean": 0.12363132271557077}}, "num_module_steps_sampled_lifetime": {"human_policy": 19838, "exo_policy": 19838}, "num_agent_steps_sampled": {"human": 2834, "exo": 2834}, "module_episode_returns_mean": {"human_policy": 266.7009311295288, "exo_policy": 356.4856230829184}, "rlmodule_inference_timer": 0.0005720625606556622, "episode_return_min": 608.3927978122761, "num_agent_steps_sampled_lifetime": {"human": 19838, "exo": 19838}, "episode_len_mean": 1417.0, "num_module_steps_sampled": {"human_policy": 2834, "exo_policy": 2834}, "episode_duration_sec_mean": 14.923547384571407, "agent_steps": {"human": 1417.0, "exo": 1417.0}, "num_episodes_lifetime": 14, "episode_return_mean": 623.1865542124472, "agent_episode_returns_mean": {"exo": 356.4856230829184, "human": 266.7009311295288}, "num_episodes": 2, "weights_seq_no": 6.0, "env_to_module_sum_episodes_length_out": 2621.831824891575, "episode_len_min": 1417, "num_env_steps_sampled": 2834, "time_between_sampling": 4.1176367678212396, "num_env_steps_sampled_lifetime_throughput": 158.0707773906854}, "learners": {"human_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 5.911283016204834, "policy_loss": -0.1344919502735138, "vf_explained_var": 0.9321781396865845, "vf_loss": 1.1021709442138672, "curr_entropy_coeff": 0.0, "num_module_steps_trained_lifetime": 198912, "total_loss": 1.0139970779418945, "curr_kl_coeff": 3.4171876907348633, "module_train_batch_size_mean": 128.0, "weights_seq_no": 7.0, "num_module_steps_trained": 28416, "entropy": 139.3349151611328, "mean_kl_loss": 0.02033163420855999, "num_trainable_parameters": 309701, "default_optimizer_learning_rate": 0.0005, "num_module_steps_trained_lifetime_throughput": 1585.7459030541738}, "exo_policy": {"policy_loss": -0.05931932106614113, "vf_explained_var": 0.7257179021835327, "vf_loss": 2.836665391921997, "num_module_steps_trained_lifetime": 198912, "curr_kl_coeff": 0.3375000059604645, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 20.307817459106445, "weights_seq_no": 7.0, "curr_entropy_coeff": 0.0, "num_module_steps_trained": 28416, "total_loss": 2.7796709537506104, "module_train_batch_size_mean": 128.0, "mean_kl_loss": 0.00344429281540215, "num_trainable_parameters": 135429, "entropy": 2.9060282707214355, "default_optimizer_learning_rate": 0.0005, "num_module_steps_trained_lifetime_throughput": 1585.7459145366233}, "__all_modules__": {"num_trainable_parameters": 445130, "num_env_steps_trained": 629148, "learner_connector": {"timers": {"connectors": {"agent_to_module_mapping": 0.004674398932407343, "batch_individual_items": 0.22943248766221877, "add_time_dim_to_batch_and_zero_pad": 3.3645732763037457e-05, "add_observations_from_episodes_to_batch": 7.527311454683629e-05, "general_advantage_estimation": 0.02983282743342251, "numpy_to_tensor": 0.00027924516613219753, "add_one_ts_to_episodes_and_truncate": 0.00628330669636345, "add_states_from_episodes_to_batch": 1.1108598651810823e-05, "add_columns_from_episodes_to_train_batch": 0.07908066008372698}}, "connector_pipeline_timer": 0.350373931181065}, "learner_connector_sum_episodes_length_out": 2834.0, "learner_connector_sum_episodes_length_in": 2834.0, "num_env_steps_trained_lifetime": 4404036, "num_module_steps_trained_lifetime": 397824, "num_module_steps_trained": 56832, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 35109.42905470048, "num_module_steps_trained_lifetime_throughput": 3171.4922391546497}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 19838, "fault_tolerance": {"num_healthy_workers": 1, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 1}, "done": true, "training_iteration": 7, "trial_id": "fb0c8_00001", "date": "2025-11-20_14-58-24", "timestamp": 1763621904, "time_this_iter_s": 17.883304595947266, "time_total_s": 129.05570721626282, "pid": 18831, "hostname": "CS-ubuntu", "node_ip": "10.207.136.136", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MARL_EXO_ENV", "env_config": {"render_mode": "human", "render_bool": false, "frame_skip": 2, "model_path": "/home/chenshuo/PycharmProjects/move_sim/SMPL/data/xml/mj_fullbody_with_exo_carrying_policy_test.xml", "n_stacks": 1, "human_obs_keys": ["qpos", "local_body_pos", "local_body_vel", "local_body_rot_obs", "local_body_angle_vel"], "exo_obs_keys": ["exo_joint_t", "exo_joint_vel_t"], "weighted_reward_keys": {"w_pos_err": 0.5, "w_proprio_err": 0.6, "w_activation": 0.4, "w_exo_energy": 0.2, "w_exo_smooth": 0.3, "theta_pos_err": 1, "theta_proprio_err": 0.7, "theta_activation": 0.3, "theta_exo_energy": 0.2, "theta_exo_smooth": 2}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 2, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 120, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 128, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f8b43f69360>", "policies_to_train": ["human_policy", "exo_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"human_policy": [null, "Box(-inf, inf, (248,), float32)", "Box(0.0, 1.0, (98,), float32)", {"model": {"custom_model": "human_model"}}], "exo_policy": [null, "Box(-10.0, 10.0, (4,), float32)", "Box(-0.261799, 2.0944, (2,), float32)", {"model": {"custom_model": "exo_model"}}]}, "callbacks": "<class 'SMPL.src.Custom_CallBack.RewardLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 129.05570721626282, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 18.720833333333335, "ram_util_percent": 58.449999999999996, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.001953125}}
