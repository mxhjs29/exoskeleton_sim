{"timers": {"training_iteration": 19.137962685000048, "restore_env_runners": 4.503500008468109e-05, "training_step": 19.137558549000005, "env_runner_sampling_timer": 15.013216478000004, "learner_update_timer": 4.116728670999919, "synch_weights": 0.005607183999927656}, "env_runners": {"num_episodes_lifetime": 2, "num_module_steps_sampled_lifetime": {"human_policy": 2834, "exo_policy": 2834}, "module_to_env_connector": {"connector_pipeline_timer": 0.0008268091383507324, "timers": {"connectors": {"tensor_to_numpy": 8.94275397079502e-05, "module_to_agent_unmapping": 6.90154868905722e-06, "listify_data_for_vector_env": 1.9576367333544154e-05, "un_batch_to_individual_items": 4.932614337526665e-05, "remove_single_ts_time_rank_from_batch": 2.830027458020579e-06, "normalize_and_clip_actions": 0.00018381057250154106, "get_actions": 0.00036286422832685174}}}, "num_agent_steps_sampled_lifetime": {"human": 2834, "exo": 2834}, "rlmodule_inference_timer": 0.0005726506600876965, "sample": 14.982443396999997, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.0001058321750103259, "agent_to_module_mapping": 9.340570105262342e-06, "add_states_from_episodes_to_batch": 7.867548681737473e-06, "add_time_dim_to_batch_and_zero_pad": 2.2236066208350253e-05, "batch_individual_items": 4.6087216216044446e-05, "add_observations_from_episodes_to_batch": 4.402575078798151e-05}}, "connector_pipeline_timer": 0.0003245820343986954}, "custom": {"human": {"R_p_mean": 0.09904428430002271, "R_a_mean": 0.00016456321420070058, "R_proprio_mean": 0.0634712831661704}, "exo": {"R_t_mean": 0.016265205529488246, "R_eas_mean": 0.04341405302404501}}, "num_env_steps_sampled_lifetime": 2834, "module_episode_returns_mean": {"exo_policy": 315.08325454447436, "human_policy": 230.5177451741176}, "num_env_steps_sampled": 2834, "agent_steps": {"exo": 1417.0, "human": 1417.0}, "episode_return_max": 550.383818628534, "timers": {"connectors": {"numpy_to_tensor": 0.00012251199996171636, "agent_to_module_mapping": 7.995000032678945e-06, "add_states_from_episodes_to_batch": 8.245999879363808e-06, "add_time_dim_to_batch_and_zero_pad": 2.1250000145300874e-05, "batch_individual_items": 4.811100006918423e-05, "add_observations_from_episodes_to_batch": 5.6846999996196246e-05}}, "num_agent_steps_sampled": {"exo": 2834, "human": 2834}, "num_module_steps_sampled": {"human_policy": 2834, "exo_policy": 2834}, "episode_duration_sec_mean": 14.87635743049998, "episode_len_mean": 1417.0, "episode_len_min": 1417, "episode_len_max": 1417, "env_step_timer": 0.00567257248411795, "agent_episode_returns_mean": {"exo": 315.08325454447436, "human": 230.5177451741176}, "weights_seq_no": 0.0, "connector_pipeline_timer": 0.000576163000005181, "env_reset_timer": 0.04956544399988161, "num_episodes": 2, "env_to_module_sum_episodes_length_in": 2621.8301293409154, "episode_return_mean": 545.600999718592, "env_to_module_sum_episodes_length_out": 2621.8301293409154, "episode_return_min": 540.81818080865, "num_env_steps_sampled_lifetime_throughput": NaN}, "learners": {"__all_modules__": {"learner_connector_sum_episodes_length_in": 2834, "learner_connector": {"timers": {"connectors": {"agent_to_module_mapping": 0.004518991999930222, "general_advantage_estimation": 0.0284079529999417, "add_observations_from_episodes_to_batch": 7.327900016207423e-05, "add_columns_from_episodes_to_train_batch": 0.08135058400011985, "batch_individual_items": 0.24170081200009008, "add_one_ts_to_episodes_and_truncate": 0.0069965709999451065, "add_states_from_episodes_to_batch": 1.0369999927206663e-05, "add_time_dim_to_batch_and_zero_pad": 4.3021999999837135e-05, "numpy_to_tensor": 0.00026734699986263877}}, "connector_pipeline_timer": 0.3641094540000722}, "num_non_trainable_parameters": 0, "num_env_steps_trained": 629148, "num_trainable_parameters": 445130, "num_module_steps_trained": 56832, "learner_connector_sum_episodes_length_out": 2834, "num_env_steps_trained_lifetime": 629148, "num_module_steps_trained_lifetime": 56832, "num_env_steps_trained_lifetime_throughput": NaN, "num_module_steps_trained_lifetime_throughput": NaN}, "human_policy": {"curr_kl_coeff": 0.30000001192092896, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 128.0, "curr_entropy_coeff": 0.0, "num_trainable_parameters": 309701, "num_module_steps_trained": 28416, "vf_explained_var": 0.5294593572616577, "total_loss": 6.179261684417725, "policy_loss": -0.014464834704995155, "weights_seq_no": 1.0, "num_module_steps_trained_lifetime": 28416, "mean_kl_loss": 0.23744802176952362, "vf_loss_unclipped": 44.01766586303711, "default_optimizer_learning_rate": 0.0005, "vf_loss": 6.146237373352051, "entropy": 138.390625, "num_module_steps_trained_lifetime_throughput": NaN}, "exo_policy": {"num_module_steps_trained_lifetime": 28416, "vf_explained_var": 0.04327511787414551, "default_optimizer_learning_rate": 0.0005, "weights_seq_no": 1.0, "mean_kl_loss": 0.03709916025400162, "vf_loss_unclipped": 241.64842224121094, "curr_kl_coeff": 0.30000001192092896, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 128.0, "vf_loss": 8.473705291748047, "entropy": 2.7588789463043213, "curr_entropy_coeff": 0.0, "num_module_steps_trained": 28416, "total_loss": 8.415428161621094, "num_trainable_parameters": 135429, "policy_loss": -0.06569769233465195, "num_module_steps_trained_lifetime_throughput": NaN}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 2834, "fault_tolerance": {"num_healthy_workers": 1, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 1}, "done": false, "training_iteration": 1, "trial_id": "fb0c8_00000", "date": "2025-11-20_14-56-34", "timestamp": 1763621794, "time_this_iter_s": 19.146962642669678, "time_total_s": 19.146962642669678, "pid": 18830, "hostname": "CS-ubuntu", "node_ip": "10.207.136.136", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MARL_EXO_ENV", "env_config": {"render_mode": "human", "render_bool": false, "frame_skip": 2, "model_path": "/home/chenshuo/PycharmProjects/move_sim/SMPL/data/xml/mj_fullbody_with_exo_carrying_policy_test.xml", "n_stacks": 1, "human_obs_keys": ["qpos", "local_body_pos", "local_body_vel", "local_body_rot_obs", "local_body_angle_vel"], "exo_obs_keys": ["exo_joint_t", "exo_joint_vel_t"], "weighted_reward_keys": {"w_pos_err": 0.4, "w_proprio_err": 0.6, "w_activation": 0.4, "w_exo_energy": 0.2, "w_exo_smooth": 0.3, "theta_pos_err": 1, "theta_proprio_err": 0.7, "theta_activation": 0.3, "theta_exo_energy": 0.2, "theta_exo_smooth": 2}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 2, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 120, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 128, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f8b43f68f70>", "policies_to_train": ["human_policy", "exo_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"human_policy": [null, "Box(-inf, inf, (248,), float32)", "Box(0.0, 1.0, (98,), float32)", {"model": {"custom_model": "human_model"}}], "exo_policy": [null, "Box(-10.0, 10.0, (4,), float32)", "Box(-0.261799, 2.0944, (2,), float32)", {"model": {"custom_model": "exo_model"}}]}, "callbacks": "<class 'SMPL.src.Custom_CallBack.RewardLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 19.146962642669678, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 21.488461538461536, "ram_util_percent": 56.396153846153844, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.001361553485576923}}
{"timers": {"training_iteration": 19.155068991700045, "restore_env_runners": 4.479665008375378e-05, "training_step": 19.154663300240006, "env_runner_sampling_timer": 15.039022934010003, "learner_update_timer": 4.108056192519919, "synch_weights": 0.005590063989930059, "synch_env_connectors": 0.004106779000039751}, "env_runners": {"num_episodes_lifetime": 4, "num_module_steps_sampled_lifetime": {"human_policy": 5668, "exo_policy": 5668}, "module_to_env_connector": {"connector_pipeline_timer": 0.0007889812182089567, "timers": {"connectors": {"tensor_to_numpy": 8.511217912373347e-05, "module_to_agent_unmapping": 6.373258114339227e-06, "listify_data_for_vector_env": 1.906453616052137e-05, "un_batch_to_individual_items": 4.744666688583093e-05, "remove_single_ts_time_rank_from_batch": 2.612953400893718e-06, "normalize_and_clip_actions": 0.00017429513621132915, "get_actions": 0.0003463222529737398}}}, "num_agent_steps_sampled_lifetime": {"human": 5668, "exo": 5668}, "rlmodule_inference_timer": 0.0005650526429150096, "sample": 15.008366322839997, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00010340646524487785, "agent_to_module_mapping": 9.080565555764976e-06, "add_states_from_episodes_to_batch": 7.786312610256894e-06, "add_time_dim_to_batch_and_zero_pad": 2.2493071044965388e-05, "batch_individual_items": 4.58946249476215e-05, "add_observations_from_episodes_to_batch": 4.447509562063965e-05}}, "connector_pipeline_timer": 0.0003198654732544984}, "custom": {"human": {"R_p_mean": 0.09930543338645545, "R_a_mean": 0.00016255542734734232, "R_proprio_mean": 0.06315145072789495}, "exo": {"R_t_mean": 0.015904379245486974, "R_eas_mean": 0.04216410241781405}}, "num_env_steps_sampled_lifetime": 5668, "module_episode_returns_mean": {"exo_policy": 312.71478434748315, "human_policy": 230.4317458305856}, "num_env_steps_sampled": 2834, "agent_steps": {"exo": 1417.0, "human": 1417.0}, "episode_return_max": 550.383818628534, "timers": {"connectors": {"numpy_to_tensor": 0.00012222956996083668, "agent_to_module_mapping": 7.993600031568348e-06, "add_states_from_episodes_to_batch": 8.23937987888712e-06, "add_time_dim_to_batch_and_zero_pad": 2.123878014344882e-05, "batch_individual_items": 4.806922006991954e-05, "add_observations_from_episodes_to_batch": 5.685682999683195e-05}}, "num_agent_steps_sampled": {"exo": 2834, "human": 2834}, "num_module_steps_sampled": {"human_policy": 2834, "exo_policy": 2834}, "episode_duration_sec_mean": 16.17677387575003, "episode_len_mean": 1417.0, "episode_len_min": 1417, "episode_len_max": 1417, "env_step_timer": 0.005382371027556584, "agent_episode_returns_mean": {"exo": 312.71478434748315, "human": 230.4317458305856}, "weights_seq_no": 1.0, "connector_pipeline_timer": 0.0005736077500046122, "env_reset_timer": 0.049518985689880994, "num_episodes": 2, "env_to_module_sum_episodes_length_in": 2621.8318248904784, "episode_return_mean": 543.1465301780688, "env_to_module_sum_episodes_length_out": 2621.8318248904784, "episode_return_min": 536.8910323023963, "time_between_sampling": 4.188006911000002, "num_env_steps_sampled_lifetime_throughput": NaN}, "learners": {"__all_modules__": {"learner_connector_sum_episodes_length_in": 2834.0, "learner_connector": {"timers": {"connectors": {"agent_to_module_mapping": 0.0045158651099313826, "general_advantage_estimation": 0.02839662522994331, "add_observations_from_episodes_to_batch": 7.325024015926829e-05, "add_columns_from_episodes_to_train_batch": 0.08134852775011722, "batch_individual_items": 0.23978784531008843, "add_one_ts_to_episodes_and_truncate": 0.006975395179945281, "add_states_from_episodes_to_batch": 1.0367499926360323e-05, "add_time_dim_to_batch_and_zero_pad": 4.3038029998569984e-05, "numpy_to_tensor": 0.0002667452498644707}}, "connector_pipeline_timer": 0.36215386492007157}, "num_non_trainable_parameters": 0, "num_env_steps_trained": 629148, "num_trainable_parameters": 445130, "num_module_steps_trained": 56832, "learner_connector_sum_episodes_length_out": 2834.0, "num_env_steps_trained_lifetime": 1258296, "num_module_steps_trained_lifetime": 113664, "num_env_steps_trained_lifetime_throughput": NaN, "num_module_steps_trained_lifetime_throughput": NaN}, "human_policy": {"curr_kl_coeff": 0.45000001788139343, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 128.0, "curr_entropy_coeff": 0.0, "num_trainable_parameters": 309701, "num_module_steps_trained": 28416, "vf_explained_var": 0.6689121127128601, "total_loss": 4.574151039123535, "policy_loss": -0.1596079021692276, "weights_seq_no": 2.0, "num_module_steps_trained_lifetime": 56832, "mean_kl_loss": 0.11312983930110931, "vf_loss_unclipped": 22.697721481323242, "default_optimizer_learning_rate": 0.0005, "vf_loss": 4.699820041656494, "entropy": 138.3267822265625, "num_module_steps_trained_lifetime_throughput": NaN}, "exo_policy": {"num_module_steps_trained_lifetime": 56832, "vf_explained_var": 0.4401435852050781, "default_optimizer_learning_rate": 0.0005, "weights_seq_no": 2.0, "mean_kl_loss": 0.015824392437934875, "vf_loss_unclipped": 86.40642547607422, "curr_kl_coeff": 0.30000001192092896, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 128.0, "vf_loss": 7.291823863983154, "entropy": 2.775509834289551, "curr_entropy_coeff": 0.0, "num_module_steps_trained": 28416, "total_loss": 7.22136116027832, "num_trainable_parameters": 135429, "policy_loss": -0.07520967721939087, "num_module_steps_trained_lifetime_throughput": NaN}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 5668, "fault_tolerance": {"num_healthy_workers": 1, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 1}, "done": false, "training_iteration": 2, "trial_id": "fb0c8_00000", "date": "2025-11-20_14-56-55", "timestamp": 1763621815, "time_this_iter_s": 20.85413408279419, "time_total_s": 40.00109672546387, "pid": 18830, "hostname": "CS-ubuntu", "node_ip": "10.207.136.136", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MARL_EXO_ENV", "env_config": {"render_mode": "human", "render_bool": false, "frame_skip": 2, "model_path": "/home/chenshuo/PycharmProjects/move_sim/SMPL/data/xml/mj_fullbody_with_exo_carrying_policy_test.xml", "n_stacks": 1, "human_obs_keys": ["qpos", "local_body_pos", "local_body_vel", "local_body_rot_obs", "local_body_angle_vel"], "exo_obs_keys": ["exo_joint_t", "exo_joint_vel_t"], "weighted_reward_keys": {"w_pos_err": 0.4, "w_proprio_err": 0.6, "w_activation": 0.4, "w_exo_energy": 0.2, "w_exo_smooth": 0.3, "theta_pos_err": 1, "theta_proprio_err": 0.7, "theta_activation": 0.3, "theta_exo_energy": 0.2, "theta_exo_smooth": 2}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 2, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 120, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 128, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f8b43de7ac0>", "policies_to_train": ["human_policy", "exo_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"human_policy": [null, "Box(-inf, inf, (248,), float32)", "Box(0.0, 1.0, (98,), float32)", {"model": {"custom_model": "human_model"}}], "exo_policy": [null, "Box(-10.0, 10.0, (4,), float32)", "Box(-0.261799, 2.0944, (2,), float32)", {"model": {"custom_model": "exo_model"}}]}, "callbacks": "<class 'SMPL.src.Custom_CallBack.RewardLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 40.00109672546387, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 27.34444444444445, "ram_util_percent": 59.38148148148149, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.001953125}}
{"timers": {"training_iteration": 19.138584595703044, "restore_env_runners": 4.453443358304412e-05, "training_step": 19.138178836737605, "env_runner_sampling_timer": 15.0315676613899, "learner_update_timer": 4.09905972197472, "synch_weights": 0.005569960070029629, "synch_env_connectors": 0.004083864320039083}, "env_runners": {"num_episodes_lifetime": 6, "num_module_steps_sampled_lifetime": {"human_policy": 8502, "exo_policy": 8502}, "module_to_env_connector": {"connector_pipeline_timer": 0.0008154413670780473, "timers": {"connectors": {"tensor_to_numpy": 8.83981238347521e-05, "module_to_agent_unmapping": 6.411118433657355e-06, "listify_data_for_vector_env": 1.997358915604624e-05, "un_batch_to_individual_items": 5.018601644027705e-05, "remove_single_ts_time_rank_from_batch": 2.7325376869937177e-06, "normalize_and_clip_actions": 0.00018082179375496628, "get_actions": 0.00035475650392896964}}}, "num_agent_steps_sampled_lifetime": {"human": 8502, "exo": 8502}, "rlmodule_inference_timer": 0.000562020121349744, "sample": 15.001019844771596, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00010188277833479933, "agent_to_module_mapping": 9.42097157384575e-06, "add_states_from_episodes_to_batch": 8.154682154438634e-06, "add_time_dim_to_batch_and_zero_pad": 2.3068237988721405e-05, "batch_individual_items": 4.7887365237770885e-05, "add_observations_from_episodes_to_batch": 4.529266643137964e-05}}, "connector_pipeline_timer": 0.00032490681429136293}, "custom": {"human": {"R_p_mean": 0.09926260870516067, "R_a_mean": 0.00015333615023531785, "R_proprio_mean": 0.06385431875070145}, "exo": {"R_t_mean": 0.016050801401557353, "R_eas_mean": 0.043064205838091056}}, "num_env_steps_sampled_lifetime": 8502, "module_episode_returns_mean": {"exo_policy": 315.1199287884218, "human_policy": 231.35396352984003}, "num_env_steps_sampled": 2834, "agent_steps": {"exo": 1417.0, "human": 1417.0}, "episode_return_max": 559.2237145281133, "timers": {"connectors": {"numpy_to_tensor": 0.00012180999426227573, "agent_to_module_mapping": 7.997824032531753e-06, "add_states_from_episodes_to_batch": 8.232426078097887e-06, "add_time_dim_to_batch_and_zero_pad": 2.1205332343674853e-05, "batch_individual_items": 4.801643786863679e-05, "add_observations_from_episodes_to_batch": 5.682909169581763e-05}}, "num_agent_steps_sampled": {"exo": 2834, "human": 2834}, "num_module_steps_sampled": {"human_policy": 2834, "exo_policy": 2834}, "episode_duration_sec_mean": 15.512654746666689, "episode_len_mean": 1417.0, "episode_len_min": 1417, "episode_len_max": 1417, "env_step_timer": 0.005554246632330095, "agent_episode_returns_mean": {"exo": 315.1199287884218, "human": 231.35396352984003}, "weights_seq_no": 2.0, "connector_pipeline_timer": 0.0005708644425029662, "env_reset_timer": 0.04939828178298106, "num_episodes": 2, "env_to_module_sum_episodes_length_in": 2621.831824891575, "episode_return_mean": 546.4738923182618, "env_to_module_sum_episodes_length_out": 2621.831824891575, "episode_return_min": 536.8910323023963, "time_between_sampling": 4.1790942332400025, "num_env_steps_sampled_lifetime_throughput": 161.2855175741967}, "learners": {"__all_modules__": {"learner_connector_sum_episodes_length_in": 2834.0, "learner_connector": {"timers": {"connectors": {"agent_to_module_mapping": 0.00451585921883327, "general_advantage_estimation": 0.02834222487764309, "add_observations_from_episodes_to_batch": 7.320303775675257e-05, "add_columns_from_episodes_to_train_batch": 0.08137759733261679, "batch_individual_items": 0.2379040229369885, "add_one_ts_to_episodes_and_truncate": 0.0069604322581455335, "add_states_from_episodes_to_batch": 1.0352894928746535e-05, "add_time_dim_to_batch_and_zero_pad": 4.286393969850906e-05, "numpy_to_tensor": 0.00026609271736442676}}, "connector_pipeline_timer": 0.3602242777408707}, "num_non_trainable_parameters": 0, "num_env_steps_trained": 629148, "num_trainable_parameters": 445130, "num_module_steps_trained": 56832, "learner_connector_sum_episodes_length_out": 2834.0, "num_env_steps_trained_lifetime": 1887444, "num_module_steps_trained_lifetime": 170496, "num_env_steps_trained_lifetime_throughput": 35888.8989806901, "num_module_steps_trained_lifetime_throughput": 3241.903257981642}, "human_policy": {"curr_kl_coeff": 0.675000011920929, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 128.0, "curr_entropy_coeff": 0.0, "num_trainable_parameters": 309701, "num_module_steps_trained": 28416, "vf_explained_var": 0.8337610363960266, "total_loss": 2.0136797428131104, "policy_loss": -0.0162535160779953, "weights_seq_no": 3.0, "num_module_steps_trained_lifetime": 85248, "mean_kl_loss": 0.08361021429300308, "vf_loss_unclipped": 10.640344619750977, "default_optimizer_learning_rate": 0.0005, "vf_loss": 1.9923087358474731, "entropy": 138.59622192382812, "num_module_steps_trained_lifetime_throughput": 1620.9500438656412}, "exo_policy": {"num_module_steps_trained_lifetime": 85248, "vf_explained_var": 0.6783562898635864, "default_optimizer_learning_rate": 0.0005, "weights_seq_no": 3.0, "mean_kl_loss": 0.025846466422080994, "vf_loss_unclipped": 26.299198150634766, "curr_kl_coeff": 0.45000001788139343, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 128.0, "vf_loss": 4.484186172485352, "entropy": 2.8906102180480957, "curr_entropy_coeff": 0.0, "num_module_steps_trained": 28416, "total_loss": 4.4301066398620605, "num_trainable_parameters": 135429, "policy_loss": -0.061833158135414124, "num_module_steps_trained_lifetime_throughput": 1620.9228718826532}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 8502, "fault_tolerance": {"num_healthy_workers": 1, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 1}, "done": false, "training_iteration": 3, "trial_id": "fb0c8_00000", "date": "2025-11-20_14-57-12", "timestamp": 1763621832, "time_this_iter_s": 17.512036561965942, "time_total_s": 57.51313328742981, "pid": 18830, "hostname": "CS-ubuntu", "node_ip": "10.207.136.136", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MARL_EXO_ENV", "env_config": {"render_mode": "human", "render_bool": false, "frame_skip": 2, "model_path": "/home/chenshuo/PycharmProjects/move_sim/SMPL/data/xml/mj_fullbody_with_exo_carrying_policy_test.xml", "n_stacks": 1, "human_obs_keys": ["qpos", "local_body_pos", "local_body_vel", "local_body_rot_obs", "local_body_angle_vel"], "exo_obs_keys": ["exo_joint_t", "exo_joint_vel_t"], "weighted_reward_keys": {"w_pos_err": 0.4, "w_proprio_err": 0.6, "w_activation": 0.4, "w_exo_energy": 0.2, "w_exo_smooth": 0.3, "theta_pos_err": 1, "theta_proprio_err": 0.7, "theta_activation": 0.3, "theta_exo_energy": 0.2, "theta_exo_smooth": 2}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 2, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 120, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 128, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f8b43e0e950>", "policies_to_train": ["human_policy", "exo_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"human_policy": [null, "Box(-inf, inf, (248,), float32)", "Box(0.0, 1.0, (98,), float32)", {"model": {"custom_model": "human_model"}}], "exo_policy": [null, "Box(-10.0, 10.0, (4,), float32)", "Box(-0.261799, 2.0944, (2,), float32)", {"model": {"custom_model": "exo_model"}}]}, "callbacks": "<class 'SMPL.src.Custom_CallBack.RewardLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 57.51313328742981, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 18.678260869565214, "ram_util_percent": 59.82173913043478, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.001953125}}
{"timers": {"training_iteration": 19.124197635646016, "restore_env_runners": 4.452911924578552e-05, "training_step": 19.123789347090227, "env_runner_sampling_timer": 15.024349717866, "learner_update_timer": 4.0919283145849725, "synch_weights": 0.005542249879329706, "synch_env_connectors": 0.0040609986368381895}, "env_runners": {"num_episodes_lifetime": 8, "num_module_steps_sampled_lifetime": {"human_policy": 11336, "exo_policy": 11336}, "module_to_env_connector": {"connector_pipeline_timer": 0.0007933561287610635, "timers": {"connectors": {"tensor_to_numpy": 8.651182463928737e-05, "module_to_agent_unmapping": 6.174072904828705e-06, "listify_data_for_vector_env": 1.950778017798822e-05, "un_batch_to_individual_items": 4.809494458020346e-05, "remove_single_ts_time_rank_from_batch": 2.709990751867414e-06, "normalize_and_clip_actions": 0.00017667893284750466, "get_actions": 0.0003448777534717906}}}, "num_agent_steps_sampled_lifetime": {"human": 11336, "exo": 11336}, "rlmodule_inference_timer": 0.0005418331197095994, "sample": 14.99391437992388, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00010055861344923283, "agent_to_module_mapping": 9.103832934739765e-06, "add_states_from_episodes_to_batch": 7.839191715130901e-06, "add_time_dim_to_batch_and_zero_pad": 2.1839000582199083e-05, "batch_individual_items": 4.635179740807727e-05, "add_observations_from_episodes_to_batch": 4.436855905250257e-05}}, "connector_pipeline_timer": 0.00031691331156407873}, "custom": {"human": {"R_p_mean": 0.09926332159801918, "R_a_mean": 0.00015385964067168807, "R_proprio_mean": 0.06397353754544538}, "exo": {"R_t_mean": 0.016640619908928116, "R_eas_mean": 0.04407869232609683}}, "num_env_steps_sampled_lifetime": 11336, "module_episode_returns_mean": {"exo_policy": 317.56391395415136, "human_policy": 231.52464851712108}, "num_env_steps_sampled": 2834, "agent_steps": {"exo": 1417.0, "human": 1417.0}, "episode_return_max": 559.4618705612268, "timers": {"connectors": {"numpy_to_tensor": 0.0001214136543194336, "agent_to_module_mapping": 8.002105792427982e-06, "add_states_from_episodes_to_batch": 8.603761817265195e-06, "add_time_dim_to_batch_and_zero_pad": 2.119225901915138e-05, "batch_individual_items": 4.801708348926741e-05, "add_observations_from_episodes_to_batch": 5.6817450778767126e-05}}, "num_agent_steps_sampled": {"exo": 2834, "human": 2834}, "num_module_steps_sampled": {"human_policy": 2834, "exo_policy": 2834}, "episode_duration_sec_mean": 15.184779189375035, "episode_len_mean": 1417.0, "episode_len_min": 1417, "episode_len_max": 1417, "env_step_timer": 0.005411155567448165, "agent_episode_returns_mean": {"exo": 317.56391395415136, "human": 231.52464851712108}, "weights_seq_no": 3.0, "connector_pipeline_timer": 0.0005687124380771968, "env_reset_timer": 0.04930216843515164, "num_episodes": 2, "env_to_module_sum_episodes_length_in": 2621.831824891575, "episode_return_mean": 549.0885624712726, "env_to_module_sum_episodes_length_out": 2621.831824891575, "episode_return_min": 536.8910323023963, "time_between_sampling": 4.169881152987602, "num_env_steps_sampled_lifetime_throughput": 161.2963835163461}, "learners": {"__all_modules__": {"learner_connector_sum_episodes_length_in": 2834.0, "learner_connector": {"timers": {"connectors": {"agent_to_module_mapping": 0.00451729357664504, "general_advantage_estimation": 0.02831868807886684, "add_observations_from_episodes_to_batch": 7.352740738047418e-05, "add_columns_from_episodes_to_train_batch": 0.081418874559291, "batch_individual_items": 0.2378235233376181, "add_one_ts_to_episodes_and_truncate": 0.00694478654556305, "add_states_from_episodes_to_batch": 1.0339835979945745e-05, "add_time_dim_to_batch_and_zero_pad": 4.269249030102584e-05, "numpy_to_tensor": 0.00026538389018979883}}, "connector_pipeline_timer": 0.36014253675346314}, "num_non_trainable_parameters": 0, "num_env_steps_trained": 629148, "num_trainable_parameters": 445130, "num_module_steps_trained": 56832, "learner_connector_sum_episodes_length_out": 2834.0, "num_env_steps_trained_lifetime": 2516592, "num_module_steps_trained_lifetime": 227328, "num_env_steps_trained_lifetime_throughput": 35869.18431972047, "num_module_steps_trained_lifetime_throughput": 3240.122455358169}, "human_policy": {"curr_kl_coeff": 1.0125000476837158, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 128.0, "curr_entropy_coeff": 0.0, "num_trainable_parameters": 309701, "num_module_steps_trained": 28416, "vf_explained_var": 0.7444089651107788, "total_loss": 1.6810585260391235, "policy_loss": -0.00934119988232851, "weights_seq_no": 4.0, "num_module_steps_trained_lifetime": 113664, "mean_kl_loss": 0.04664679989218712, "vf_loss_unclipped": 17.401611328125, "default_optimizer_learning_rate": 0.0005, "vf_loss": 1.6589131355285645, "entropy": 138.4748077392578, "num_module_steps_trained_lifetime_throughput": 1620.059823112595}, "exo_policy": {"num_module_steps_trained_lifetime": 113664, "vf_explained_var": 0.6129931807518005, "default_optimizer_learning_rate": 0.0005, "weights_seq_no": 4.0, "mean_kl_loss": 0.012454427778720856, "vf_loss_unclipped": 35.86820602416992, "curr_kl_coeff": 0.45000001788139343, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 128.0, "vf_loss": 2.875227212905884, "entropy": 2.966918468475342, "curr_entropy_coeff": 0.0, "num_module_steps_trained": 28416, "total_loss": 2.864455223083496, "num_trainable_parameters": 135429, "policy_loss": -0.01637667790055275, "num_module_steps_trained_lifetime_throughput": 1620.0343764067159}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 11336, "fault_tolerance": {"num_healthy_workers": 1, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 1}, "done": false, "training_iteration": 4, "trial_id": "fb0c8_00000", "date": "2025-11-20_14-57-30", "timestamp": 1763621850, "time_this_iter_s": 17.70616912841797, "time_total_s": 75.21930241584778, "pid": 18830, "hostname": "CS-ubuntu", "node_ip": "10.207.136.136", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MARL_EXO_ENV", "env_config": {"render_mode": "human", "render_bool": false, "frame_skip": 2, "model_path": "/home/chenshuo/PycharmProjects/move_sim/SMPL/data/xml/mj_fullbody_with_exo_carrying_policy_test.xml", "n_stacks": 1, "human_obs_keys": ["qpos", "local_body_pos", "local_body_vel", "local_body_rot_obs", "local_body_angle_vel"], "exo_obs_keys": ["exo_joint_t", "exo_joint_vel_t"], "weighted_reward_keys": {"w_pos_err": 0.4, "w_proprio_err": 0.6, "w_activation": 0.4, "w_exo_energy": 0.2, "w_exo_smooth": 0.3, "theta_pos_err": 1, "theta_proprio_err": 0.7, "theta_activation": 0.3, "theta_exo_energy": 0.2, "theta_exo_smooth": 2}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 2, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 120, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 128, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f8b43e0f010>", "policies_to_train": ["human_policy", "exo_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"human_policy": [null, "Box(-inf, inf, (248,), float32)", "Box(0.0, 1.0, (98,), float32)", {"model": {"custom_model": "human_model"}}], "exo_policy": [null, "Box(-10.0, 10.0, (4,), float32)", "Box(-0.261799, 2.0944, (2,), float32)", {"model": {"custom_model": "exo_model"}}]}, "callbacks": "<class 'SMPL.src.Custom_CallBack.RewardLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 75.21930241584778, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 19.145833333333332, "ram_util_percent": 59.86666666666667, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.001953125}}
{"timers": {"training_iteration": 19.108160449179557, "restore_env_runners": 4.427578805144694e-05, "training_step": 19.107751270589326, "env_runner_sampling_timer": 15.01749607213734, "learner_update_timer": 4.082772514449123, "synch_weights": 0.005516514590535293, "synch_env_connectors": 0.004044974220469353}, "env_runners": {"num_episodes_lifetime": 10, "num_module_steps_sampled_lifetime": {"human_policy": 14170, "exo_policy": 14170}, "module_to_env_connector": {"connector_pipeline_timer": 0.000798288323838614, "timers": {"connectors": {"tensor_to_numpy": 8.605416975925524e-05, "module_to_agent_unmapping": 6.267666092795244e-06, "listify_data_for_vector_env": 1.9561461363836493e-05, "un_batch_to_individual_items": 4.8277255371523284e-05, "remove_single_ts_time_rank_from_batch": 2.668253285223383e-06, "normalize_and_clip_actions": 0.00017780806373096276, "get_actions": 0.00034772421826914114}}}, "num_agent_steps_sampled_lifetime": {"human": 14170, "exo": 14170}, "rlmodule_inference_timer": 0.0005543790690323984, "sample": 14.987121667964638, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.960362288011216e-05, "agent_to_module_mapping": 9.536274833446807e-06, "add_states_from_episodes_to_batch": 8.113248082420053e-06, "add_time_dim_to_batch_and_zero_pad": 2.2889950657087092e-05, "batch_individual_items": 4.7296749292313955e-05, "add_observations_from_episodes_to_batch": 4.5364386737531574e-05}}, "connector_pipeline_timer": 0.00032185674038282246}, "custom": {"human": {"R_p_mean": 0.09914533073753984, "R_a_mean": 0.00015105934558217973, "R_proprio_mean": 0.06395812011454534}, "exo": {"R_t_mean": 0.016646469031642498, "R_eas_mean": 0.04393790715473398}}, "num_env_steps_sampled_lifetime": 14170, "module_episode_returns_mean": {"exo_policy": 317.17970200619004, "human_policy": 231.3316409500946}, "num_env_steps_sampled": 2834, "agent_steps": {"exo": 1417.0, "human": 1417.0}, "episode_return_max": 559.4618705612268, "timers": {"connectors": {"numpy_to_tensor": 0.00012113709777672109, "agent_to_module_mapping": 8.004644734513536e-06, "add_states_from_episodes_to_batch": 8.594674199313219e-06, "add_time_dim_to_batch_and_zero_pad": 2.1222896428565737e-05, "batch_individual_items": 4.799537265358331e-05, "add_observations_from_episodes_to_batch": 5.680713627173331e-05}}, "num_agent_steps_sampled": {"exo": 2834, "human": 2834}, "num_module_steps_sampled": {"human_policy": 2834, "exo_policy": 2834}, "episode_duration_sec_mean": 14.992618436800035, "episode_len_mean": 1417.0, "episode_len_min": 1417, "episode_len_max": 1417, "env_step_timer": 0.005465844053952003, "agent_episode_returns_mean": {"exo": 317.17970200619004, "human": 231.3316409500946}, "weights_seq_no": 4.0, "connector_pipeline_timer": 0.0005663167436968698, "env_reset_timer": 0.0492020393007987, "num_episodes": 2, "env_to_module_sum_episodes_length_in": 2621.831824891575, "episode_return_mean": 548.5113429562847, "env_to_module_sum_episodes_length_out": 2621.831824891575, "episode_return_min": 536.8910323023963, "time_between_sampling": 4.162540719477727, "num_env_steps_sampled_lifetime_throughput": 161.21222018101585}, "learners": {"__all_modules__": {"learner_connector_sum_episodes_length_in": 2834.0, "learner_connector": {"timers": {"connectors": {"agent_to_module_mapping": 0.0045149151708784, "general_advantage_estimation": 0.028298080568078993, "add_observations_from_episodes_to_batch": 7.40297733057593e-05, "add_columns_from_episodes_to_train_batch": 0.0814497518036976, "batch_individual_items": 0.23595573229424127, "add_one_ts_to_episodes_and_truncate": 0.006928179430107052, "add_states_from_episodes_to_batch": 1.0324197619733721e-05, "add_time_dim_to_batch_and_zero_pad": 4.276200539802184e-05, "numpy_to_tensor": 0.0002659211912871177}}, "connector_pipeline_timer": 0.35826361925592787}, "num_non_trainable_parameters": 0, "num_env_steps_trained": 629148, "num_trainable_parameters": 445130, "num_module_steps_trained": 56832, "learner_connector_sum_episodes_length_out": 2834.0, "num_env_steps_trained_lifetime": 3145740, "num_module_steps_trained_lifetime": 284160, "num_env_steps_trained_lifetime_throughput": 35868.56092893869, "num_module_steps_trained_lifetime_throughput": 3240.0661398329025}, "human_policy": {"curr_kl_coeff": 1.5187500715255737, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 128.0, "curr_entropy_coeff": 0.0, "num_trainable_parameters": 309701, "num_module_steps_trained": 28416, "vf_explained_var": 0.9643497467041016, "total_loss": 1.0408332347869873, "policy_loss": -0.2189870923757553, "weights_seq_no": 5.0, "num_module_steps_trained_lifetime": 142080, "mean_kl_loss": 0.038284629583358765, "vf_loss_unclipped": 2.38792085647583, "default_optimizer_learning_rate": 0.0005, "vf_loss": 1.2210570573806763, "entropy": 138.80014038085938, "num_module_steps_trained_lifetime_throughput": 1620.0318126112707}, "exo_policy": {"num_module_steps_trained_lifetime": 142080, "vf_explained_var": 0.6123614311218262, "default_optimizer_learning_rate": 0.0005, "weights_seq_no": 5.0, "mean_kl_loss": 0.006478375289589167, "vf_loss_unclipped": 32.33518981933594, "curr_kl_coeff": 0.45000001788139343, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 128.0, "vf_loss": 3.2655625343322754, "entropy": 2.986933469772339, "curr_entropy_coeff": 0.0, "num_module_steps_trained": 28416, "total_loss": 3.282261848449707, "num_trainable_parameters": 135429, "policy_loss": 0.013783990405499935, "num_module_steps_trained_lifetime_throughput": 1620.0076041591556}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 14170, "fault_tolerance": {"num_healthy_workers": 1, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 1}, "done": false, "training_iteration": 5, "trial_id": "fb0c8_00000", "date": "2025-11-20_14-57-47", "timestamp": 1763621867, "time_this_iter_s": 17.527070999145508, "time_total_s": 92.74637341499329, "pid": 18830, "hostname": "CS-ubuntu", "node_ip": "10.207.136.136", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MARL_EXO_ENV", "env_config": {"render_mode": "human", "render_bool": false, "frame_skip": 2, "model_path": "/home/chenshuo/PycharmProjects/move_sim/SMPL/data/xml/mj_fullbody_with_exo_carrying_policy_test.xml", "n_stacks": 1, "human_obs_keys": ["qpos", "local_body_pos", "local_body_vel", "local_body_rot_obs", "local_body_angle_vel"], "exo_obs_keys": ["exo_joint_t", "exo_joint_vel_t"], "weighted_reward_keys": {"w_pos_err": 0.4, "w_proprio_err": 0.6, "w_activation": 0.4, "w_exo_energy": 0.2, "w_exo_smooth": 0.3, "theta_pos_err": 1, "theta_proprio_err": 0.7, "theta_activation": 0.3, "theta_exo_energy": 0.2, "theta_exo_smooth": 2}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 2, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 120, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 128, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f8b43cf80d0>", "policies_to_train": ["human_policy", "exo_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"human_policy": [null, "Box(-inf, inf, (248,), float32)", "Box(0.0, 1.0, (98,), float32)", {"model": {"custom_model": "human_model"}}], "exo_policy": [null, "Box(-10.0, 10.0, (4,), float32)", "Box(-0.261799, 2.0944, (2,), float32)", {"model": {"custom_model": "exo_model"}}]}, "callbacks": "<class 'SMPL.src.Custom_CallBack.RewardLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 92.74637341499329, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 18.756521739130434, "ram_util_percent": 59.84347826086956, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.001953125}}
{"timers": {"training_iteration": 19.093604360687763, "restore_env_runners": 4.401918017137767e-05, "training_step": 19.093194573293435, "env_runner_sampling_timer": 15.011629621525964, "learner_update_timer": 4.074118376924631, "synch_weights": 0.0054902697746307405, "synch_env_connectors": 0.004022467048264946}, "env_runners": {"num_episodes_lifetime": 12, "num_module_steps_sampled_lifetime": {"human_policy": 17004, "exo_policy": 17004}, "module_to_env_connector": {"connector_pipeline_timer": 0.0008014491058257807, "timers": {"connectors": {"tensor_to_numpy": 8.601941394188177e-05, "module_to_agent_unmapping": 6.209751618629743e-06, "listify_data_for_vector_env": 1.9216231550157954e-05, "un_batch_to_individual_items": 4.7926038820254176e-05, "remove_single_ts_time_rank_from_batch": 2.5958243897272253e-06, "normalize_and_clip_actions": 0.0001745224087589695, "get_actions": 0.0003569949172940166}}}, "num_agent_steps_sampled_lifetime": {"human": 17004, "exo": 17004}, "rlmodule_inference_timer": 0.0005802607063076124, "sample": 14.981348792074991, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00010415458644376354, "agent_to_module_mapping": 9.17280666845986e-06, "add_states_from_episodes_to_batch": 7.849317812529127e-06, "add_time_dim_to_batch_and_zero_pad": 2.1961575098043777e-05, "batch_individual_items": 4.603011880317625e-05, "add_observations_from_episodes_to_batch": 4.391479762264278e-05}}, "connector_pipeline_timer": 0.00031982089438046185}, "custom": {"human": {"R_p_mean": 0.09906567456957345, "R_a_mean": 0.0001513291485246967, "R_proprio_mean": 0.0641730924137839}, "exo": {"R_t_mean": 0.016511941759026316, "R_eas_mean": 0.043946529009458946}}, "num_env_steps_sampled_lifetime": 17004, "module_episode_returns_mean": {"exo_policy": 317.1934192978204, "human_policy": 231.52376621887674}, "num_env_steps_sampled": 2834, "agent_steps": {"exo": 1417.0, "human": 1417.0}, "episode_return_max": 559.4618705612268, "timers": {"connectors": {"numpy_to_tensor": 0.00012080469679852981, "agent_to_module_mapping": 8.01967828665095e-06, "add_states_from_episodes_to_batch": 8.585667457646517e-06, "add_time_dim_to_batch_and_zero_pad": 2.121185746483282e-05, "batch_individual_items": 4.7960858927523556e-05, "add_observations_from_episodes_to_batch": 5.689029490914643e-05}}, "num_agent_steps_sampled": {"exo": 2834, "human": 2834}, "num_module_steps_sampled": {"human_policy": 2834, "exo_policy": 2834}, "episode_duration_sec_mean": 14.880292511416693, "episode_len_mean": 1417.0, "episode_len_min": 1417, "episode_len_max": 1417, "env_step_timer": 0.005387463839270702, "agent_episode_returns_mean": {"exo": 317.1934192978204, "human": 231.52376621887674}, "weights_seq_no": 5.0, "connector_pipeline_timer": 0.000563980376259187, "env_reset_timer": 0.049113760427789845, "num_episodes": 2, "env_to_module_sum_episodes_length_in": 2621.831824891575, "episode_return_mean": 548.7171855166972, "env_to_module_sum_episodes_length_out": 2621.831824891575, "episode_return_min": 536.8910323023963, "time_between_sampling": 4.153234803622949, "num_env_steps_sampled_lifetime_throughput": 161.18504229781982}, "learners": {"__all_modules__": {"learner_connector_sum_episodes_length_in": 2834.0, "learner_connector": {"timers": {"connectors": {"agent_to_module_mapping": 0.004517559989169546, "general_advantage_estimation": 0.028279383792397746, "add_observations_from_episodes_to_batch": 7.401715557379307e-05, "add_columns_from_episodes_to_train_batch": 0.0815117479856607, "batch_individual_items": 0.2341408574212984, "add_one_ts_to_episodes_and_truncate": 0.006915431645806159, "add_states_from_episodes_to_batch": 1.0316335644393788e-05, "add_time_dim_to_batch_and_zero_pad": 4.261351534344034e-05, "numpy_to_tensor": 0.0002652846093731655}}, "connector_pipeline_timer": 0.3564766911233676}, "num_non_trainable_parameters": 0, "num_env_steps_trained": 629148, "num_trainable_parameters": 445130, "num_module_steps_trained": 56832, "learner_connector_sum_episodes_length_out": 2834.0, "num_env_steps_trained_lifetime": 3774888, "num_module_steps_trained_lifetime": 340992, "num_env_steps_trained_lifetime_throughput": 35854.44883659855, "num_module_steps_trained_lifetime_throughput": 3238.791455371592}, "human_policy": {"curr_kl_coeff": 2.278125047683716, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 128.0, "curr_entropy_coeff": 0.0, "num_trainable_parameters": 309701, "num_module_steps_trained": 28416, "vf_explained_var": 0.867362380027771, "total_loss": 1.1270625591278076, "policy_loss": -0.04930144548416138, "weights_seq_no": 6.0, "num_module_steps_trained_lifetime": 170496, "mean_kl_loss": 0.02429279126226902, "vf_loss_unclipped": 8.26249885559082, "default_optimizer_learning_rate": 0.0005, "vf_loss": 1.1394695043563843, "entropy": 138.58740234375, "num_module_steps_trained_lifetime_throughput": 1619.3945585650067}, "exo_policy": {"num_module_steps_trained_lifetime": 170496, "vf_explained_var": 0.7123268842697144, "default_optimizer_learning_rate": 0.0005, "weights_seq_no": 6.0, "mean_kl_loss": 0.00819017831236124, "vf_loss_unclipped": 25.866731643676758, "curr_kl_coeff": 0.45000001788139343, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 128.0, "vf_loss": 2.36720609664917, "entropy": 2.9593217372894287, "curr_entropy_coeff": 0.0, "num_module_steps_trained": 28416, "total_loss": 2.3040971755981445, "num_trainable_parameters": 135429, "policy_loss": -0.06679430603981018, "num_module_steps_trained_lifetime_throughput": 1619.3713746288827}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 17004, "fault_tolerance": {"num_healthy_workers": 1, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 1}, "done": false, "training_iteration": 6, "trial_id": "fb0c8_00000", "date": "2025-11-20_14-58-05", "timestamp": 1763621885, "time_this_iter_s": 17.65882110595703, "time_total_s": 110.40519452095032, "pid": 18830, "hostname": "CS-ubuntu", "node_ip": "10.207.136.136", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MARL_EXO_ENV", "env_config": {"render_mode": "human", "render_bool": false, "frame_skip": 2, "model_path": "/home/chenshuo/PycharmProjects/move_sim/SMPL/data/xml/mj_fullbody_with_exo_carrying_policy_test.xml", "n_stacks": 1, "human_obs_keys": ["qpos", "local_body_pos", "local_body_vel", "local_body_rot_obs", "local_body_angle_vel"], "exo_obs_keys": ["exo_joint_t", "exo_joint_vel_t"], "weighted_reward_keys": {"w_pos_err": 0.4, "w_proprio_err": 0.6, "w_activation": 0.4, "w_exo_energy": 0.2, "w_exo_smooth": 0.3, "theta_pos_err": 1, "theta_proprio_err": 0.7, "theta_activation": 0.3, "theta_exo_energy": 0.2, "theta_exo_smooth": 2}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 2, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 120, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 128, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f8b43d08310>", "policies_to_train": ["human_policy", "exo_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"human_policy": [null, "Box(-inf, inf, (248,), float32)", "Box(0.0, 1.0, (98,), float32)", {"model": {"custom_model": "human_model"}}], "exo_policy": [null, "Box(-10.0, 10.0, (4,), float32)", "Box(-0.261799, 2.0944, (2,), float32)", {"model": {"custom_model": "exo_model"}}]}, "callbacks": "<class 'SMPL.src.Custom_CallBack.RewardLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 110.40519452095032, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 18.617391304347827, "ram_util_percent": 58.69565217391303, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.001953125}}
{"timers": {"training_iteration": 19.080143073730884, "restore_env_runners": 4.377245836773047e-05, "training_step": 19.0797321425005, "env_runner_sampling_timer": 15.006360178090706, "learner_update_timer": 4.065957652055384, "synch_weights": 0.00546813527688326, "synch_env_connectors": 0.004003276187783268}, "env_runners": {"num_episodes_lifetime": 14, "num_module_steps_sampled_lifetime": {"human_policy": 19838, "exo_policy": 19838}, "module_to_env_connector": {"connector_pipeline_timer": 0.0008007415370539199, "timers": {"connectors": {"tensor_to_numpy": 8.5717857355296e-05, "module_to_agent_unmapping": 6.148425958286589e-06, "listify_data_for_vector_env": 2.0236062297543257e-05, "un_batch_to_individual_items": 4.827145055831992e-05, "remove_single_ts_time_rank_from_batch": 2.6346474669873217e-06, "normalize_and_clip_actions": 0.000176707002188096, "get_actions": 0.0003516910309161218}}}, "num_agent_steps_sampled_lifetime": {"human": 19838, "exo": 19838}, "rlmodule_inference_timer": 0.0005545992047316587, "sample": 14.97616142938424, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00010916780315624888, "agent_to_module_mapping": 9.3899930836671e-06, "add_states_from_episodes_to_batch": 8.02689430977745e-06, "add_time_dim_to_batch_and_zero_pad": 2.2685484609681296e-05, "batch_individual_items": 4.724376194390049e-05, "add_observations_from_episodes_to_batch": 4.512996936944297e-05}}, "connector_pipeline_timer": 0.00033060026953240325}, "custom": {"human": {"R_p_mean": 0.09900609983040491, "R_a_mean": 0.0001492367020755737, "R_proprio_mean": 0.06428635486632552}, "exo": {"R_t_mean": 0.016687640464830643, "R_eas_mean": 0.04389615570117759}}, "num_env_steps_sampled_lifetime": 19838, "module_episode_returns_mean": {"exo_policy": 317.44411587934167, "human_policy": 231.59687671210798}, "num_env_steps_sampled": 2834, "agent_steps": {"exo": 1417.0, "human": 1417.0}, "episode_return_max": 559.4618705612268, "timers": {"connectors": {"numpy_to_tensor": 0.00012056197983087102, "agent_to_module_mapping": 8.031851504641487e-06, "add_states_from_episodes_to_batch": 8.575450781228346e-06, "add_time_dim_to_batch_and_zero_pad": 2.1207828890526548e-05, "batch_individual_items": 4.7968670338147755e-05, "add_observations_from_episodes_to_batch": 5.696080196013113e-05}}, "num_agent_steps_sampled": {"exo": 2834, "human": 2834}, "num_module_steps_sampled": {"human_policy": 2834, "exo_policy": 2834}, "episode_duration_sec_mean": 14.806914533142876, "episode_len_mean": 1417.0, "episode_len_min": 1417, "episode_len_max": 1417, "env_step_timer": 0.005397409676280501, "agent_episode_returns_mean": {"exo": 317.44411587934167, "human": 231.59687671210798}, "weights_seq_no": 6.0, "connector_pipeline_timer": 0.0005617981124979587, "env_reset_timer": 0.049049431633512185, "num_episodes": 2, "env_to_module_sum_episodes_length_in": 2621.831824891575, "episode_return_mean": 549.0409925914497, "env_to_module_sum_episodes_length_out": 2621.831824891575, "episode_return_min": 536.8910323023963, "time_between_sampling": 4.144383547166719, "num_env_steps_sampled_lifetime_throughput": 161.1172953399537}, "learners": {"__all_modules__": {"learner_connector_sum_episodes_length_in": 2834.0, "learner_connector": {"timers": {"connectors": {"agent_to_module_mapping": 0.004515734419276087, "general_advantage_estimation": 0.02826914567447435, "add_observations_from_episodes_to_batch": 7.44080240167093e-05, "add_columns_from_episodes_to_train_batch": 0.08177258085580441, "batch_individual_items": 0.23230939413708576, "add_one_ts_to_episodes_and_truncate": 0.006938337019348594, "add_states_from_episodes_to_batch": 1.0307752288172628e-05, "add_time_dim_to_batch_and_zero_pad": 4.2451380190248896e-05, "numpy_to_tensor": 0.0002647495732790516}}, "connector_pipeline_timer": 0.35491285346213425}, "num_non_trainable_parameters": 0, "num_env_steps_trained": 629148, "num_trainable_parameters": 445130, "num_module_steps_trained": 56832, "learner_connector_sum_episodes_length_out": 2834.0, "num_env_steps_trained_lifetime": 4404036, "num_module_steps_trained_lifetime": 397824, "num_env_steps_trained_lifetime_throughput": 35831.723604994906, "num_module_steps_trained_lifetime_throughput": 3236.7387013078064}, "human_policy": {"curr_kl_coeff": 3.4171876907348633, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 128.0, "curr_entropy_coeff": 0.0, "num_trainable_parameters": 309701, "num_module_steps_trained": 28416, "vf_explained_var": 0.8902407288551331, "total_loss": 1.128226399421692, "policy_loss": -0.10904253274202347, "weights_seq_no": 7.0, "num_module_steps_trained_lifetime": 198912, "mean_kl_loss": 0.023100178688764572, "vf_loss_unclipped": 7.396134376525879, "default_optimizer_learning_rate": 0.0005, "vf_loss": 1.1846437454223633, "entropy": 138.45973205566406, "num_module_steps_trained_lifetime_throughput": 1618.3681807667663}, "exo_policy": {"num_module_steps_trained_lifetime": 198912, "vf_explained_var": 0.6550990343093872, "default_optimizer_learning_rate": 0.0005, "weights_seq_no": 7.0, "mean_kl_loss": 0.007475730963051319, "vf_loss_unclipped": 28.993871688842773, "curr_kl_coeff": 0.45000001788139343, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 128.0, "vf_loss": 3.349618911743164, "entropy": 2.922783851623535, "curr_entropy_coeff": 0.0, "num_module_steps_trained": 28416, "total_loss": 3.3183279037475586, "num_trainable_parameters": 135429, "policy_loss": -0.0346551239490509, "num_module_steps_trained_lifetime_throughput": 1618.3462549908686}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 19838, "fault_tolerance": {"num_healthy_workers": 1, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 1}, "done": true, "training_iteration": 7, "trial_id": "fb0c8_00000", "date": "2025-11-20_14-58-23", "timestamp": 1763621903, "time_this_iter_s": 17.755085706710815, "time_total_s": 128.16028022766113, "pid": 18830, "hostname": "CS-ubuntu", "node_ip": "10.207.136.136", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MARL_EXO_ENV", "env_config": {"render_mode": "human", "render_bool": false, "frame_skip": 2, "model_path": "/home/chenshuo/PycharmProjects/move_sim/SMPL/data/xml/mj_fullbody_with_exo_carrying_policy_test.xml", "n_stacks": 1, "human_obs_keys": ["qpos", "local_body_pos", "local_body_vel", "local_body_rot_obs", "local_body_angle_vel"], "exo_obs_keys": ["exo_joint_t", "exo_joint_vel_t"], "weighted_reward_keys": {"w_pos_err": 0.4, "w_proprio_err": 0.6, "w_activation": 0.4, "w_exo_energy": 0.2, "w_exo_smooth": 0.3, "theta_pos_err": 1, "theta_proprio_err": 0.7, "theta_activation": 0.3, "theta_exo_energy": 0.2, "theta_exo_smooth": 2}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 2, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 120, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 128, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f8b43d40a60>", "policies_to_train": ["human_policy", "exo_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"human_policy": [null, "Box(-inf, inf, (248,), float32)", "Box(0.0, 1.0, (98,), float32)", {"model": {"custom_model": "human_model"}}], "exo_policy": [null, "Box(-10.0, 10.0, (4,), float32)", "Box(-0.261799, 2.0944, (2,), float32)", {"model": {"custom_model": "exo_model"}}]}, "callbacks": "<class 'SMPL.src.Custom_CallBack.RewardLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 128.16028022766113, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 19.037499999999998, "ram_util_percent": 58.525, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.001953125}}
