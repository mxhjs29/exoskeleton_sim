{"timers": {"training_iteration": 18.978098630999966, "restore_env_runners": 5.6025000048975926e-05, "training_step": 18.97763051400011, "env_runner_sampling_timer": 14.829211609999902, "learner_update_timer": 4.142986501999985, "synch_weights": 0.004648652000014408}, "env_runners": {"sample": 14.799900992000175, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.0003586197931640741, "normalize_and_clip_actions": 0.00018138010023343275, "module_to_agent_unmapping": 7.601855488206828e-06, "listify_data_for_vector_env": 2.0372181895695948e-05, "tensor_to_numpy": 8.75172528016363e-05, "remove_single_ts_time_rank_from_batch": 2.781156716566623e-06, "un_batch_to_individual_items": 4.9990595583081125e-05}}, "connector_pipeline_timer": 0.0008198945509318887}, "env_step_timer": 0.005568393477405502, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.82227789610167e-05, "add_observations_from_episodes_to_batch": 4.4146658327910436e-05, "batch_individual_items": 4.708684112285211e-05, "agent_to_module_mapping": 1.0417892327561893e-05, "add_time_dim_to_batch_and_zero_pad": 2.05534907681462e-05, "add_states_from_episodes_to_batch": 8.11720371472832e-06}}, "connector_pipeline_timer": 0.00031715943852484834}, "num_module_steps_sampled_lifetime": {"exo_policy": 2834, "human_policy": 2834}, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.077300006130827e-05, "add_states_from_episodes_to_batch": 1.3454999816531199e-05, "numpy_to_tensor": 0.00030960899994170177, "add_observations_from_episodes_to_batch": 0.00014436000014939054, "batch_individual_items": 0.00010427500001242151, "agent_to_module_mapping": 1.7682999896351248e-05}}, "custom": {"exo": {"R_t_mean": 0.11387864319224808, "R_eas_mean": 0.18779152694121448}, "human": {"R_a_mean": 0.12045354925408586, "R_proprio_mean": 0.41712665267354404, "R_p_mean": 0.3130025613478412}}, "agent_steps": {"human": 1417.0, "exo": 1417.0}, "num_env_steps_sampled_lifetime": 2834, "connector_pipeline_timer": 0.001301194999996369, "num_agent_steps_sampled": {"human": 2834, "exo": 2834}, "episode_return_max": 2840.3075539931224, "agent_episode_returns_mean": {"human": 1205.2757755613409, "exo": 1632.742406640457}, "env_to_module_sum_episodes_length_in": 2621.8301293409154, "module_episode_returns_mean": {"exo_policy": 1632.742406640457, "human_policy": 1205.2757755613409}, "episode_duration_sec_mean": 14.670505771499961, "num_module_steps_sampled": {"exo_policy": 2834, "human_policy": 2834}, "env_reset_timer": 0.07781061099990438, "rlmodule_inference_timer": 0.0005388428565749498, "episode_len_min": 1417, "num_episodes_lifetime": 2, "weights_seq_no": 0.0, "num_agent_steps_sampled_lifetime": {"human": 2834, "exo": 2834}, "episode_len_max": 1417, "env_to_module_sum_episodes_length_out": 2621.8301293409154, "num_env_steps_sampled": 2834, "episode_return_mean": 2838.018182201798, "num_episodes": 2, "episode_return_min": 2835.7288104104737, "episode_len_mean": 1417.0, "num_env_steps_sampled_lifetime_throughput": NaN}, "learners": {"exo_policy": {"entropy": 2.7139201164245605, "mean_kl_loss": 0.023509835824370384, "module_train_batch_size_mean": 128.0, "default_optimizer_learning_rate": 0.0005, "num_module_steps_trained_lifetime": 28416, "total_loss": 10.018932342529297, "weights_seq_no": 1.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 0.30000001192092896, "vf_loss_unclipped": 11273.841796875, "vf_loss": 10.0, "num_trainable_parameters": 135429, "curr_entropy_coeff": 0.0, "num_module_steps_trained": 28416, "vf_explained_var": 0.08733946084976196, "policy_loss": 0.014230392873287201, "num_module_steps_trained_lifetime_throughput": NaN}, "human_policy": {"num_trainable_parameters": 309701, "curr_kl_coeff": 0.30000001192092896, "vf_loss": 10.0, "module_train_batch_size_mean": 128.0, "default_optimizer_learning_rate": 0.0005, "num_module_steps_trained_lifetime": 28416, "total_loss": 9.817943572998047, "weights_seq_no": 1.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 6389.24267578125, "curr_entropy_coeff": 0.0, "num_module_steps_trained": 28416, "vf_explained_var": 0.04638040065765381, "policy_loss": -0.21708612143993378, "entropy": 139.60128784179688, "mean_kl_loss": 0.17514707148075104, "num_module_steps_trained_lifetime_throughput": NaN}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.0072386520000691235, "agent_to_module_mapping": 0.004783945000099266, "add_columns_from_episodes_to_train_batch": 0.08159334399988438, "numpy_to_tensor": 0.000313968999989811, "add_observations_from_episodes_to_batch": 8.889499986253213e-05, "add_states_from_episodes_to_batch": 1.4728999985891278e-05, "batch_individual_items": 0.2316905919999499, "general_advantage_estimation": 0.06652731000008316, "add_time_dim_to_batch_and_zero_pad": 6.446699990192428e-05}}, "connector_pipeline_timer": 0.39326411000001826}, "learner_connector_sum_episodes_length_in": 2834, "num_module_steps_trained_lifetime": 56832, "num_env_steps_trained_lifetime": 629148, "learner_connector_sum_episodes_length_out": 2834, "num_non_trainable_parameters": 0, "num_trainable_parameters": 445130, "num_module_steps_trained": 56832, "num_env_steps_trained": 629148, "num_env_steps_trained_lifetime_throughput": NaN, "num_module_steps_trained_lifetime_throughput": NaN}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 2834, "fault_tolerance": {"num_healthy_workers": 1, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 1}, "done": false, "training_iteration": 1, "trial_id": "dc8cf_00000", "date": "2025-11-20_14-48-34", "timestamp": 1763621314, "time_this_iter_s": 18.986555814743042, "time_total_s": 18.986555814743042, "pid": 11834, "hostname": "CS-ubuntu", "node_ip": "10.207.136.136", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MARL_EXO_ENV", "env_config": {"render_mode": "human", "render_bool": false, "frame_skip": 2, "model_path": "/home/chenshuo/PycharmProjects/move_sim/SMPL/data/xml/mj_fullbody_with_exo_carrying_policy_test.xml", "n_stacks": 1, "human_obs_keys": ["qpos", "local_body_pos", "local_body_vel", "local_body_rot_obs", "local_body_angle_vel"], "exo_obs_keys": ["exo_joint_t", "exo_joint_vel_t"], "weighted_reward_keys": {"w_pos_err": 0.4, "w_proprio_err": 0.6, "w_activation": 0.4, "w_exo_energy": 0.2, "w_exo_smooth": 0.3, "theta_pos_err": 0.1, "theta_proprio_err": 0.03, "theta_activation": 0.03, "theta_exo_energy": 0.01, "theta_exo_smooth": 0.2}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 2, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 120, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 128, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7fcae561dea0>", "policies_to_train": ["human_policy", "exo_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"human_policy": [null, "Box(-inf, inf, (248,), float32)", "Box(0.0, 1.0, (98,), float32)", {"model": {"custom_model": "human_model"}}], "exo_policy": [null, "Box(-10.0, 10.0, (4,), float32)", "Box(-0.261799, 2.0944, (2,), float32)", {"model": {"custom_model": "exo_model"}}]}, "callbacks": "<class 'SMPL.src.Custom_CallBack.RewardLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 18.986555814743042, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 18.968, "ram_util_percent": 55.672000000000004, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.001337890625}}
{"timers": {"training_iteration": 18.970733282809963, "restore_env_runners": 5.567316004771783e-05, "training_step": 18.970265195030112, "env_runner_sampling_timer": 14.828697644609905, "learner_update_timer": 4.136158030609984, "synch_weights": 0.004627043110012892, "synch_env_connectors": 0.003845279999950435}, "env_runners": {"sample": 14.799416321420175, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.00034031768965007395, "normalize_and_clip_actions": 0.0001786213924704515, "module_to_agent_unmapping": 6.398639233472783e-06, "listify_data_for_vector_env": 2.020922385456658e-05, "tensor_to_numpy": 8.569345795561319e-05, "remove_single_ts_time_rank_from_batch": 2.8536284114362443e-06, "un_batch_to_individual_items": 4.825723282731942e-05}}, "connector_pipeline_timer": 0.0007918816545916638}, "env_step_timer": 0.005548367641722038, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.583889088315213e-05, "add_observations_from_episodes_to_batch": 4.3970493444489744e-05, "batch_individual_items": 4.620553677626464e-05, "agent_to_module_mapping": 1.0008598753008347e-05, "add_time_dim_to_batch_and_zero_pad": 1.9398041527090732e-05, "add_states_from_episodes_to_batch": 7.823992943118181e-06}}, "connector_pipeline_timer": 0.00031135705116708566}, "num_module_steps_sampled_lifetime": {"exo_policy": 5668, "human_policy": 5668}, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 7.038881006110388e-05, "add_states_from_episodes_to_batch": 1.3459819817853714e-05, "numpy_to_tensor": 0.00030761006994453057, "add_observations_from_episodes_to_batch": 0.00014377469014789312, "batch_individual_items": 0.00010371851001082177, "agent_to_module_mapping": 1.761006989681846e-05}}, "custom": {"exo": {"R_t_mean": 0.11300018722435037, "R_eas_mean": 0.19089255452036857}, "human": {"R_a_mean": 0.12037945505378742, "R_proprio_mean": 0.4177918849828027, "R_p_mean": 0.31285184853912473}}, "agent_steps": {"human": 1417.0, "exo": 1417.0}, "num_env_steps_sampled_lifetime": 5668, "connector_pipeline_timer": 0.0012924456399946392, "num_agent_steps_sampled": {"human": 2834, "exo": 2834}, "episode_return_max": 2850.5194173854184, "agent_episode_returns_mean": {"human": 1205.8998582117874, "exo": 1636.5158732640539}, "env_to_module_sum_episodes_length_in": 2621.8318248904784, "module_episode_returns_mean": {"exo_policy": 1636.5158732640539, "human_policy": 1205.8998582117874}, "episode_duration_sec_mean": 14.65091373224999, "num_module_steps_sampled": {"exo_policy": 2834, "human_policy": 2834}, "env_reset_timer": 0.0776618491599038, "rlmodule_inference_timer": 0.0005220554601753315, "episode_len_min": 1417, "num_episodes_lifetime": 4, "weights_seq_no": 1.0, "num_agent_steps_sampled_lifetime": {"human": 5668, "exo": 5668}, "episode_len_max": 1417, "env_to_module_sum_episodes_length_out": 2621.8318248904784, "num_env_steps_sampled": 2834, "episode_return_mean": 2842.4157314758413, "num_episodes": 2, "episode_return_min": 2835.7288104104737, "episode_len_mean": 1417.0, "time_between_sampling": 4.20863516899999, "num_env_steps_sampled_lifetime_throughput": NaN}, "learners": {"exo_policy": {"entropy": 2.6044788360595703, "mean_kl_loss": 0.03257624804973602, "module_train_batch_size_mean": 128.0, "default_optimizer_learning_rate": 0.0005, "num_module_steps_trained_lifetime": 56832, "total_loss": 9.803582191467285, "weights_seq_no": 2.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 0.45000001788139343, "vf_loss_unclipped": 12486.705078125, "vf_loss": 10.0, "num_trainable_parameters": 135429, "curr_entropy_coeff": 0.0, "num_module_steps_trained": 28416, "vf_explained_var": 0.06603437662124634, "policy_loss": -0.20619122684001923, "num_module_steps_trained_lifetime_throughput": NaN}, "human_policy": {"num_trainable_parameters": 309701, "curr_kl_coeff": 0.45000001788139343, "vf_loss": 10.0, "module_train_batch_size_mean": 128.0, "default_optimizer_learning_rate": 0.0005, "num_module_steps_trained_lifetime": 56832, "total_loss": 9.847986221313477, "weights_seq_no": 2.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 6674.16943359375, "curr_entropy_coeff": 0.0, "num_module_steps_trained": 28416, "vf_explained_var": 0.06943029165267944, "policy_loss": -0.19099901616573334, "entropy": 139.41891479492188, "mean_kl_loss": 0.1299521028995514, "num_module_steps_trained_lifetime_throughput": NaN}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.007213583010068305, "agent_to_module_mapping": 0.004797092630099086, "add_columns_from_episodes_to_train_batch": 0.0817792914198867, "numpy_to_tensor": 0.00031276340999056626, "add_observations_from_episodes_to_batch": 8.872616986309367e-05, "add_states_from_episodes_to_batch": 1.4685409987578168e-05, "batch_individual_items": 0.229883360659951, "general_advantage_estimation": 0.06611772617008227, "add_time_dim_to_batch_and_zero_pad": 6.412502990315261e-05}}, "connector_pipeline_timer": 0.39121323584001855}, "learner_connector_sum_episodes_length_in": 2834.0, "num_module_steps_trained_lifetime": 113664, "num_env_steps_trained_lifetime": 1258296, "learner_connector_sum_episodes_length_out": 2834.0, "num_non_trainable_parameters": 0, "num_trainable_parameters": 445130, "num_module_steps_trained": 56832, "num_env_steps_trained": 629148, "num_env_steps_trained_lifetime_throughput": NaN, "num_module_steps_trained_lifetime_throughput": NaN}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 5668, "fault_tolerance": {"num_healthy_workers": 1, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 1}, "done": false, "training_iteration": 2, "trial_id": "dc8cf_00000", "date": "2025-11-20_14-48-52", "timestamp": 1763621332, "time_this_iter_s": 18.247040271759033, "time_total_s": 37.233596086502075, "pid": 11834, "hostname": "CS-ubuntu", "node_ip": "10.207.136.136", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MARL_EXO_ENV", "env_config": {"render_mode": "human", "render_bool": false, "frame_skip": 2, "model_path": "/home/chenshuo/PycharmProjects/move_sim/SMPL/data/xml/mj_fullbody_with_exo_carrying_policy_test.xml", "n_stacks": 1, "human_obs_keys": ["qpos", "local_body_pos", "local_body_vel", "local_body_rot_obs", "local_body_angle_vel"], "exo_obs_keys": ["exo_joint_t", "exo_joint_vel_t"], "weighted_reward_keys": {"w_pos_err": 0.4, "w_proprio_err": 0.6, "w_activation": 0.4, "w_exo_energy": 0.2, "w_exo_smooth": 0.3, "theta_pos_err": 0.1, "theta_proprio_err": 0.03, "theta_activation": 0.03, "theta_exo_energy": 0.01, "theta_exo_smooth": 0.2}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 2, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 120, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 128, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7fcae56d3a30>", "policies_to_train": ["human_policy", "exo_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"human_policy": [null, "Box(-inf, inf, (248,), float32)", "Box(0.0, 1.0, (98,), float32)", {"model": {"custom_model": "human_model"}}], "exo_policy": [null, "Box(-10.0, 10.0, (4,), float32)", "Box(-0.261799, 2.0944, (2,), float32)", {"model": {"custom_model": "exo_model"}}]}, "callbacks": "<class 'SMPL.src.Custom_CallBack.RewardLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 37.233596086502075, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 20.052, "ram_util_percent": 56.424, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.001953125}}
{"timers": {"training_iteration": 18.963430638941865, "restore_env_runners": 5.528716844921746e-05, "training_step": 18.96296243774981, "env_runner_sampling_timer": 14.828395193333808, "learner_update_timer": 4.129176810563883, "synch_weights": 0.004604850718911349, "synch_env_connectors": 0.0038244017999522835}, "env_runners": {"sample": 14.799158444045972, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.000359710740054293, "normalize_and_clip_actions": 0.0001816025090024342, "module_to_agent_unmapping": 6.2992571242735585e-06, "listify_data_for_vector_env": 2.0405664143479953e-05, "tensor_to_numpy": 8.841926328205567e-05, "remove_single_ts_time_rank_from_batch": 2.8821035116153297e-06, "un_batch_to_individual_items": 4.9764941527674286e-05}}, "connector_pipeline_timer": 0.0008206663632058259}, "env_step_timer": 0.005635769701446248, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00010348502804772166, "add_observations_from_episodes_to_batch": 4.581610475005404e-05, "batch_individual_items": 4.778898796141738e-05, "agent_to_module_mapping": 1.0506402725729275e-05, "add_time_dim_to_batch_and_zero_pad": 2.1035691196046102e-05, "add_states_from_episodes_to_batch": 8.329372094814773e-06}}, "connector_pipeline_timer": 0.0003283632477694145}, "num_module_steps_sampled_lifetime": {"exo_policy": 8502, "human_policy": 8502}, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.987870195982852e-05, "add_states_from_episodes_to_batch": 1.339696162042401e-05, "numpy_to_tensor": 0.00030539214924397127, "add_observations_from_episodes_to_batch": 0.00014288561324658528, "batch_individual_items": 0.00010309373491033965, "agent_to_module_mapping": 1.75188391961683e-05}}, "custom": {"exo": {"R_t_mean": 0.11284739392638223, "R_eas_mean": 0.1924455060163085}, "human": {"R_a_mean": 0.12049453210610943, "R_proprio_mean": 0.4178428287710066, "R_p_mean": 0.3128845440109464}}, "agent_steps": {"human": 1417.0, "exo": 1417.0}, "num_env_steps_sampled_lifetime": 8502, "connector_pipeline_timer": 0.0012825436235930964, "num_agent_steps_sampled": {"human": 2834, "exo": 2834}, "episode_return_max": 2856.215389417904, "agent_episode_returns_mean": {"human": 1206.1814392263843, "exo": 1638.7814784451766}, "env_to_module_sum_episodes_length_in": 2621.831824891575, "module_episode_returns_mean": {"exo_policy": 1638.7814784451766, "human_policy": 1206.1814392263843}, "episode_duration_sec_mean": 14.65523456883333, "num_module_steps_sampled": {"exo_policy": 2834, "human_policy": 2834}, "env_reset_timer": 0.07733617919830386, "rlmodule_inference_timer": 0.0005898237800802677, "episode_len_min": 1417, "num_episodes_lifetime": 6, "weights_seq_no": 2.0, "num_agent_steps_sampled_lifetime": {"human": 8502, "exo": 8502}, "episode_len_max": 1417, "env_to_module_sum_episodes_length_out": 2621.831824891575, "num_env_steps_sampled": 2834, "episode_return_mean": 2844.9629176715607, "num_episodes": 2, "episode_return_min": 2835.7288104104737, "episode_len_mean": 1417.0, "time_between_sampling": 4.20166809169999, "num_env_steps_sampled_lifetime_throughput": 154.99599874329067}, "learners": {"exo_policy": {"entropy": 2.7313108444213867, "mean_kl_loss": 0.01991674117743969, "module_train_batch_size_mean": 128.0, "default_optimizer_learning_rate": 0.0005, "num_module_steps_trained_lifetime": 85248, "total_loss": 9.970161437988281, "weights_seq_no": 3.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 0.45000001788139343, "vf_loss_unclipped": 11720.328125, "vf_loss": 10.0, "num_trainable_parameters": 135429, "curr_entropy_coeff": 0.0, "num_module_steps_trained": 28416, "vf_explained_var": 0.06985080242156982, "policy_loss": -0.03880053758621216, "num_module_steps_trained_lifetime_throughput": 1556.0260933340535}, "human_policy": {"num_trainable_parameters": 309701, "curr_kl_coeff": 0.675000011920929, "vf_loss": 9.923789978027344, "module_train_batch_size_mean": 128.0, "default_optimizer_learning_rate": 0.0005, "num_module_steps_trained_lifetime": 85248, "total_loss": 9.817987442016602, "weights_seq_no": 3.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 6365.82275390625, "curr_entropy_coeff": 0.0, "num_module_steps_trained": 28416, "vf_explained_var": 0.03618866205215454, "policy_loss": -0.1491871178150177, "entropy": 139.33004760742188, "mean_kl_loss": 0.09641038626432419, "num_module_steps_trained_lifetime_throughput": 1556.024859891175}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.007187925309967818, "agent_to_module_mapping": 0.004794114623798008, "add_columns_from_episodes_to_train_batch": 0.0818009500656881, "numpy_to_tensor": 0.0003116218658894695, "add_observations_from_episodes_to_batch": 8.854498816660907e-05, "add_states_from_episodes_to_batch": 1.4636545885969098e-05, "batch_individual_items": 0.2280846523533515, "general_advantage_estimation": 0.06572153267838197, "add_time_dim_to_batch_and_zero_pad": 6.3768439604155e-05}}, "connector_pipeline_timer": 0.38900311787161873}, "learner_connector_sum_episodes_length_in": 2834.0, "num_module_steps_trained_lifetime": 170496, "num_env_steps_trained_lifetime": 1887444, "learner_connector_sum_episodes_length_out": 2834.0, "num_non_trainable_parameters": 0, "num_trainable_parameters": 445130, "num_module_steps_trained": 56832, "num_env_steps_trained": 629148, "num_env_steps_trained_lifetime_throughput": 34451.338417163715, "num_module_steps_trained_lifetime_throughput": 3112.051527854493}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 8502, "fault_tolerance": {"num_healthy_workers": 1, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 1}, "done": false, "training_iteration": 3, "trial_id": "dc8cf_00000", "date": "2025-11-20_14-49-10", "timestamp": 1763621350, "time_this_iter_s": 18.246387720108032, "time_total_s": 55.47998380661011, "pid": 11834, "hostname": "CS-ubuntu", "node_ip": "10.207.136.136", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MARL_EXO_ENV", "env_config": {"render_mode": "human", "render_bool": false, "frame_skip": 2, "model_path": "/home/chenshuo/PycharmProjects/move_sim/SMPL/data/xml/mj_fullbody_with_exo_carrying_policy_test.xml", "n_stacks": 1, "human_obs_keys": ["qpos", "local_body_pos", "local_body_vel", "local_body_rot_obs", "local_body_angle_vel"], "exo_obs_keys": ["exo_joint_t", "exo_joint_vel_t"], "weighted_reward_keys": {"w_pos_err": 0.4, "w_proprio_err": 0.6, "w_activation": 0.4, "w_exo_energy": 0.2, "w_exo_smooth": 0.3, "theta_pos_err": 0.1, "theta_proprio_err": 0.03, "theta_activation": 0.03, "theta_exo_energy": 0.01, "theta_exo_smooth": 0.2}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 2, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 120, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 128, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7fcae54c6950>", "policies_to_train": ["human_policy", "exo_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"human_policy": [null, "Box(-inf, inf, (248,), float32)", "Box(0.0, 1.0, (98,), float32)", {"model": {"custom_model": "human_model"}}], "exo_policy": [null, "Box(-10.0, 10.0, (4,), float32)", "Box(-0.261799, 2.0944, (2,), float32)", {"model": {"custom_model": "exo_model"}}]}, "callbacks": "<class 'SMPL.src.Custom_CallBack.RewardLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 55.47998380661011, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 19.275000000000002, "ram_util_percent": 56.525, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.001953125}}
{"timers": {"training_iteration": 18.954239255842445, "restore_env_runners": 5.490302676522128e-05, "training_step": 18.95377008311231, "env_runner_sampling_timer": 14.824017972210468, "learner_update_timer": 4.124368278418244, "synch_weights": 0.0045876598617219716, "synch_env_connectors": 0.0038053594719523512}, "env_runners": {"sample": 14.794821787595513, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.00034127965171585446, "normalize_and_clip_actions": 0.0001781897911875522, "module_to_agent_unmapping": 6.208384884073712e-06, "listify_data_for_vector_env": 2.0157650551624347e-05, "tensor_to_numpy": 8.53142388986184e-05, "remove_single_ts_time_rank_from_batch": 2.735223148568337e-06, "un_batch_to_individual_items": 4.870750936929353e-05}}, "connector_pipeline_timer": 0.0007913175770359493}, "env_step_timer": 0.005539287142743223, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.712491212798938e-05, "add_observations_from_episodes_to_batch": 4.398469703872909e-05, "batch_individual_items": 4.6697839412330033e-05, "agent_to_module_mapping": 1.0059906586453264e-05, "add_time_dim_to_batch_and_zero_pad": 1.9820555999982606e-05, "add_states_from_episodes_to_batch": 7.987879652228106e-06}}, "connector_pipeline_timer": 0.0003140863013879609}, "num_module_steps_sampled_lifetime": {"exo_policy": 11336, "human_policy": 11336}, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.9486514940161e-05, "add_states_from_episodes_to_batch": 1.335867200417829e-05, "numpy_to_tensor": 0.0003032529177530682, "add_observations_from_episodes_to_batch": 0.00014220351711352098, "batch_individual_items": 0.00010248892756128701, "agent_to_module_mapping": 1.7429720803476583e-05}}, "custom": {"exo": {"R_t_mean": 0.11217831932256156, "R_eas_mean": 0.19285446437981696}, "human": {"R_a_mean": 0.12052006170134952, "R_proprio_mean": 0.4179803865128378, "R_p_mean": 0.3128824702865164}}, "agent_steps": {"human": 1417.0, "exo": 1417.0}, "num_env_steps_sampled_lifetime": 11336, "connector_pipeline_timer": 0.001273302307356852, "num_agent_steps_sampled": {"human": 2834, "exo": 2834}, "episode_return_max": 2856.215389417904, "agent_episode_returns_mean": {"human": 1206.4095955154974, "exo": 1638.6410500217667}, "env_to_module_sum_episodes_length_in": 2621.831824891575, "module_episode_returns_mean": {"exo_policy": 1638.6410500217667, "human_policy": 1206.4095955154974}, "episode_duration_sec_mean": 14.55972795400001, "num_module_steps_sampled": {"exo_policy": 2834, "human_policy": 2834}, "env_reset_timer": 0.07694166834631959, "rlmodule_inference_timer": 0.0005393465109304165, "episode_len_min": 1417, "num_episodes_lifetime": 8, "weights_seq_no": 3.0, "num_agent_steps_sampled_lifetime": {"human": 11336, "exo": 11336}, "episode_len_max": 1417, "env_to_module_sum_episodes_length_out": 2621.831824891575, "num_env_steps_sampled": 2834, "episode_return_mean": 2845.0506455372642, "num_episodes": 2, "episode_return_min": 2835.7288104104737, "episode_len_mean": 1417.0, "time_between_sampling": 4.194572711112992, "num_env_steps_sampled_lifetime_throughput": 155.1808228460493}, "learners": {"exo_policy": {"entropy": 2.7958245277404785, "mean_kl_loss": 0.019714610651135445, "module_train_batch_size_mean": 128.0, "default_optimizer_learning_rate": 0.0005, "num_module_steps_trained_lifetime": 113664, "total_loss": 10.09072494506836, "weights_seq_no": 4.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 0.45000001788139343, "vf_loss_unclipped": 11031.2568359375, "vf_loss": 10.0, "num_trainable_parameters": 135429, "curr_entropy_coeff": 0.0, "num_module_steps_trained": 28416, "vf_explained_var": 0.0326160192489624, "policy_loss": 0.08185344189405441, "num_module_steps_trained_lifetime_throughput": 1556.8588547159557}, "human_policy": {"num_trainable_parameters": 309701, "curr_kl_coeff": 1.0125000476837158, "vf_loss": 10.0, "module_train_batch_size_mean": 128.0, "default_optimizer_learning_rate": 0.0005, "num_module_steps_trained_lifetime": 113664, "total_loss": 9.880681991577148, "weights_seq_no": 4.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 6686.3173828125, "curr_entropy_coeff": 0.0, "num_module_steps_trained": 28416, "vf_explained_var": 0.07826322317123413, "policy_loss": -0.17670777440071106, "entropy": 139.47938537597656, "mean_kl_loss": 0.08502233028411865, "num_module_steps_trained_lifetime_throughput": 1556.8578111160732}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.007166229376867773, "agent_to_module_mapping": 0.004794482437561606, "add_columns_from_episodes_to_train_batch": 0.08179251459503306, "numpy_to_tensor": 0.0003111526172320534, "add_observations_from_episodes_to_batch": 8.837162828492205e-05, "add_states_from_episodes_to_batch": 1.4587770427332542e-05, "batch_individual_items": 0.22807586055981938, "general_advantage_estimation": 0.06528375941159986, "add_time_dim_to_batch_and_zero_pad": 6.342793520762007e-05}}, "connector_pipeline_timer": 0.38851918826290155}, "learner_connector_sum_episodes_length_in": 2834.0, "num_module_steps_trained_lifetime": 227328, "num_env_steps_trained_lifetime": 2516592, "learner_connector_sum_episodes_length_out": 2834.0, "num_non_trainable_parameters": 0, "num_trainable_parameters": 445130, "num_module_steps_trained": 56832, "num_env_steps_trained": 629148, "num_env_steps_trained_lifetime_throughput": 34469.782144874545, "num_module_steps_trained_lifetime_throughput": 3113.7171576038786}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 11336, "fault_tolerance": {"num_healthy_workers": 1, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 1}, "done": false, "training_iteration": 4, "trial_id": "dc8cf_00000", "date": "2025-11-20_14-49-28", "timestamp": 1763621368, "time_this_iter_s": 18.050458192825317, "time_total_s": 73.53044199943542, "pid": 11834, "hostname": "CS-ubuntu", "node_ip": "10.207.136.136", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MARL_EXO_ENV", "env_config": {"render_mode": "human", "render_bool": false, "frame_skip": 2, "model_path": "/home/chenshuo/PycharmProjects/move_sim/SMPL/data/xml/mj_fullbody_with_exo_carrying_policy_test.xml", "n_stacks": 1, "human_obs_keys": ["qpos", "local_body_pos", "local_body_vel", "local_body_rot_obs", "local_body_angle_vel"], "exo_obs_keys": ["exo_joint_t", "exo_joint_vel_t"], "weighted_reward_keys": {"w_pos_err": 0.4, "w_proprio_err": 0.6, "w_activation": 0.4, "w_exo_energy": 0.2, "w_exo_smooth": 0.3, "theta_pos_err": 0.1, "theta_proprio_err": 0.03, "theta_activation": 0.03, "theta_exo_energy": 0.01, "theta_exo_smooth": 0.2}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 2, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 120, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 128, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7fcae53af520>", "policies_to_train": ["human_policy", "exo_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"human_policy": [null, "Box(-inf, inf, (248,), float32)", "Box(0.0, 1.0, (98,), float32)", {"model": {"custom_model": "human_model"}}], "exo_policy": [null, "Box(-10.0, 10.0, (4,), float32)", "Box(-0.261799, 2.0944, (2,), float32)", {"model": {"custom_model": "exo_model"}}]}, "callbacks": "<class 'SMPL.src.Custom_CallBack.RewardLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 73.53044199943542, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 19.2, "ram_util_percent": 56.612500000000004, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.001953125}}
{"timers": {"training_iteration": 18.94446083620402, "restore_env_runners": 5.452903649727265e-05, "training_step": 18.943991053651185, "env_runner_sampling_timer": 14.820957298318364, "learner_update_timer": 4.117652689194061, "synch_weights": 0.0045813037431044895, "synch_env_connectors": 0.0037917243572327224}, "env_runners": {"sample": 14.791847390499557, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.0003480899638900696, "normalize_and_clip_actions": 0.00017891212390989071, "module_to_agent_unmapping": 6.319682246282891e-06, "listify_data_for_vector_env": 2.0526368409078065e-05, "tensor_to_numpy": 8.61718861461352e-05, "remove_single_ts_time_rank_from_batch": 2.752378947558454e-06, "un_batch_to_individual_items": 4.898574800347555e-05}}, "connector_pipeline_timer": 0.0008015396810653796}, "env_step_timer": 0.005578633831008835, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.598913810184393e-05, "add_observations_from_episodes_to_batch": 4.383616125704523e-05, "batch_individual_items": 4.538982070368914e-05, "agent_to_module_mapping": 9.886364024875403e-06, "add_time_dim_to_batch_and_zero_pad": 1.93998334886049e-05, "add_states_from_episodes_to_batch": 8.084910444745417e-06}}, "connector_pipeline_timer": 0.0003113696296745563}, "num_module_steps_sampled_lifetime": {"exo_policy": 14170, "human_policy": 14170}, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.904112978994307e-05, "add_states_from_episodes_to_batch": 1.3308745283882084e-05, "numpy_to_tensor": 0.0003011208485752218, "add_observations_from_episodes_to_batch": 0.00014136702194372458, "batch_individual_items": 0.00010192583828594066, "agent_to_module_mapping": 1.734539359666872e-05}}, "custom": {"exo": {"R_t_mean": 0.11149405111381336, "R_eas_mean": 0.1929607599497198}, "human": {"R_a_mean": 0.12053543874004764, "R_proprio_mean": 0.4179430911121618, "R_p_mean": 0.31287990169095103}}, "agent_steps": {"human": 1417.0, "exo": 1417.0}, "num_env_steps_sampled_lifetime": 14170, "connector_pipeline_timer": 0.0012638692242824077, "num_agent_steps_sampled": {"human": 2834, "exo": 2834}, "episode_return_max": 2856.215389417904, "agent_episode_returns_mean": {"human": 1206.3748974966588, "exo": 1637.787364773684}, "env_to_module_sum_episodes_length_in": 2621.831824891575, "module_episode_returns_mean": {"exo_policy": 1637.787364773684, "human_policy": 1206.3748974966588}, "episode_duration_sec_mean": 14.528861049800003, "num_module_steps_sampled": {"exo_policy": 2834, "human_policy": 2834}, "env_reset_timer": 0.0765673111528557, "rlmodule_inference_timer": 0.0005313703879969407, "episode_len_min": 1417, "num_episodes_lifetime": 10, "weights_seq_no": 4.0, "num_agent_steps_sampled_lifetime": {"human": 14170, "exo": 14170}, "episode_len_max": 1417, "env_to_module_sum_episodes_length_out": 2621.831824891575, "num_env_steps_sampled": 2834, "episode_return_mean": 2844.162262270343, "num_episodes": 2, "episode_return_min": 2835.7288104104737, "episode_len_mean": 1417.0, "time_between_sampling": 4.189673418651861, "num_env_steps_sampled_lifetime_throughput": 155.2087256129382}, "learners": {"exo_policy": {"entropy": 2.8220977783203125, "mean_kl_loss": 0.01608338952064514, "module_train_batch_size_mean": 128.0, "default_optimizer_learning_rate": 0.0005, "num_module_steps_trained_lifetime": 142080, "total_loss": 10.003531455993652, "weights_seq_no": 5.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 0.45000001788139343, "vf_loss_unclipped": 11712.458984375, "vf_loss": 10.0, "num_trainable_parameters": 135429, "curr_entropy_coeff": 0.0, "num_module_steps_trained": 28416, "vf_explained_var": 0.09998255968093872, "policy_loss": -0.0037059299647808075, "num_module_steps_trained_lifetime_throughput": 1557.9412880351533}, "human_policy": {"num_trainable_parameters": 309701, "curr_kl_coeff": 1.5187500715255737, "vf_loss": 9.862730979919434, "module_train_batch_size_mean": 128.0, "default_optimizer_learning_rate": 0.0005, "num_module_steps_trained_lifetime": 142080, "total_loss": 9.891366958618164, "weights_seq_no": 5.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 6108.04833984375, "curr_entropy_coeff": 0.0, "num_module_steps_trained": 28416, "vf_explained_var": 0.03093630075454712, "policy_loss": -0.03218752518296242, "entropy": 139.4645538330078, "mean_kl_loss": 0.060072626918554306, "num_module_steps_trained_lifetime_throughput": 1557.9401763891442}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.007145291423097946, "agent_to_module_mapping": 0.004794788143187032, "add_columns_from_episodes_to_train_batch": 0.08179854744908359, "numpy_to_tensor": 0.0003119804610609953, "add_observations_from_episodes_to_batch": 8.818477200167994e-05, "add_states_from_episodes_to_batch": 1.4557212722226913e-05, "batch_individual_items": 0.22632373948422, "general_advantage_estimation": 0.06490196587748422, "add_time_dim_to_batch_and_zero_pad": 6.34773958552023e-05}}, "connector_pipeline_timer": 0.38636624222027105}, "learner_connector_sum_episodes_length_in": 2834.0, "num_module_steps_trained_lifetime": 284160, "num_env_steps_trained_lifetime": 3145740, "learner_connector_sum_episodes_length_out": 2834.0, "num_non_trainable_parameters": 0, "num_trainable_parameters": 445130, "num_module_steps_trained": 56832, "num_env_steps_trained": 629148, "num_env_steps_trained_lifetime_throughput": 34493.74765072317, "num_module_steps_trained_lifetime_throughput": 3115.8820158210347}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 14170, "fault_tolerance": {"num_healthy_workers": 1, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 1}, "done": false, "training_iteration": 5, "trial_id": "dc8cf_00000", "date": "2025-11-20_14-49-46", "timestamp": 1763621386, "time_this_iter_s": 17.98282504081726, "time_total_s": 91.51326704025269, "pid": 11834, "hostname": "CS-ubuntu", "node_ip": "10.207.136.136", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MARL_EXO_ENV", "env_config": {"render_mode": "human", "render_bool": false, "frame_skip": 2, "model_path": "/home/chenshuo/PycharmProjects/move_sim/SMPL/data/xml/mj_fullbody_with_exo_carrying_policy_test.xml", "n_stacks": 1, "human_obs_keys": ["qpos", "local_body_pos", "local_body_vel", "local_body_rot_obs", "local_body_angle_vel"], "exo_obs_keys": ["exo_joint_t", "exo_joint_vel_t"], "weighted_reward_keys": {"w_pos_err": 0.4, "w_proprio_err": 0.6, "w_activation": 0.4, "w_exo_energy": 0.2, "w_exo_smooth": 0.3, "theta_pos_err": 0.1, "theta_proprio_err": 0.03, "theta_activation": 0.03, "theta_exo_energy": 0.01, "theta_exo_smooth": 0.2}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 2, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 120, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 128, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7fcae557c430>", "policies_to_train": ["human_policy", "exo_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"human_policy": [null, "Box(-inf, inf, (248,), float32)", "Box(0.0, 1.0, (98,), float32)", {"model": {"custom_model": "human_model"}}], "exo_policy": [null, "Box(-10.0, 10.0, (4,), float32)", "Box(-0.261799, 2.0944, (2,), float32)", {"model": {"custom_model": "exo_model"}}]}, "callbacks": "<class 'SMPL.src.Custom_CallBack.RewardLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 91.51326704025269, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 19.40833333333333, "ram_util_percent": 56.52916666666666, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.001953125}}
{"timers": {"training_iteration": 18.93671917799198, "restore_env_runners": 5.422661613090116e-05, "training_step": 18.936247494424677, "env_runner_sampling_timer": 14.817043795995179, "learner_update_timer": 4.113836039032119, "synch_weights": 0.004563721275672313, "synch_env_connectors": 0.0037741133636612803}, "env_runners": {"sample": 14.78802261295456, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.00034489004742703543, "normalize_and_clip_actions": 0.0001747239879701056, "module_to_agent_unmapping": 6.252938190752924e-06, "listify_data_for_vector_env": 1.9756401116070794e-05, "tensor_to_numpy": 8.51938541028199e-05, "remove_single_ts_time_rank_from_batch": 2.789412124786405e-06, "un_batch_to_individual_items": 4.8335298981227034e-05}}, "connector_pipeline_timer": 0.0007895168932023533}, "env_step_timer": 0.005408848728271882, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.644053745277036e-05, "add_observations_from_episodes_to_batch": 4.2721668455521404e-05, "batch_individual_items": 4.4174951037227385e-05, "agent_to_module_mapping": 9.65265997101117e-06, "add_time_dim_to_batch_and_zero_pad": 1.8890305964673103e-05, "add_states_from_episodes_to_batch": 7.726138295148442e-06}}, "connector_pipeline_timer": 0.000305567191109416}, "num_module_steps_sampled_lifetime": {"exo_policy": 17004, "human_policy": 17004}, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.870961849139897e-05, "add_states_from_episodes_to_batch": 1.3264627831476883e-05, "numpy_to_tensor": 0.00029902673008836263, "add_observations_from_episodes_to_batch": 0.00014072486172342745, "batch_individual_items": 0.000101464169902143, "agent_to_module_mapping": 1.7298689661774686e-05}}, "custom": {"exo": {"R_t_mean": 0.11138436295276144, "R_eas_mean": 0.19290415157278695}, "human": {"R_a_mean": 0.12057498266344147, "R_proprio_mean": 0.41798830911745943, "R_p_mean": 0.31289780850348997}}, "agent_steps": {"human": 1417.0, "exo": 1417.0}, "num_env_steps_sampled_lifetime": 17004, "connector_pipeline_timer": 0.0012551255120396244, "num_agent_steps_sampled": {"human": 2834, "exo": 2834}, "episode_return_max": 2856.215389417904, "agent_episode_returns_mean": {"human": 1206.520379102982, "exo": 1637.6972041856834}, "env_to_module_sum_episodes_length_in": 2621.831824891575, "module_episode_returns_mean": {"exo_policy": 1637.6972041856834, "human_policy": 1206.520379102982}, "episode_duration_sec_mean": 14.493952753999983, "num_module_steps_sampled": {"exo_policy": 2834, "human_policy": 2834}, "env_reset_timer": 0.07619916167132876, "rlmodule_inference_timer": 0.0005340034972401923, "episode_len_min": 1417, "num_episodes_lifetime": 12, "weights_seq_no": 5.0, "num_agent_steps_sampled_lifetime": {"human": 17004, "exo": 17004}, "episode_len_max": 1417, "env_to_module_sum_episodes_length_out": 2621.831824891575, "num_env_steps_sampled": 2834, "episode_return_mean": 2844.217583288666, "num_episodes": 2, "episode_return_min": 2835.7288104104737, "episode_len_mean": 1417.0, "time_between_sampling": 4.182829181645341, "num_env_steps_sampled_lifetime_throughput": 155.3581377750273}, "learners": {"exo_policy": {"entropy": 2.857271909713745, "mean_kl_loss": 0.007848228327929974, "module_train_batch_size_mean": 128.0, "default_optimizer_learning_rate": 0.0005, "num_module_steps_trained_lifetime": 170496, "total_loss": 9.976493835449219, "weights_seq_no": 6.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 0.45000001788139343, "vf_loss_unclipped": 11318.7353515625, "vf_loss": 10.0, "num_trainable_parameters": 135429, "curr_entropy_coeff": 0.0, "num_module_steps_trained": 28416, "vf_explained_var": 0.1167759895324707, "policy_loss": -0.027037549763917923, "num_module_steps_trained_lifetime_throughput": 1558.121194895934}, "human_policy": {"num_trainable_parameters": 309701, "curr_kl_coeff": 2.278125047683716, "vf_loss": 9.91629695892334, "module_train_batch_size_mean": 128.0, "default_optimizer_learning_rate": 0.0005, "num_module_steps_trained_lifetime": 170496, "total_loss": 9.856529235839844, "weights_seq_no": 6.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 6359.763671875, "curr_entropy_coeff": 0.0, "num_module_steps_trained": 28416, "vf_explained_var": 0.05169475078582764, "policy_loss": -0.1319582760334015, "entropy": 139.34742736816406, "mean_kl_loss": 0.04753294959664345, "num_module_steps_trained_lifetime_throughput": 1558.120250742801}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.007127855128866369, "agent_to_module_mapping": 0.004795235251754158, "add_columns_from_episodes_to_train_batch": 0.08184663390459238, "numpy_to_tensor": 0.0003109386964499455, "add_observations_from_episodes_to_batch": 8.838823427962445e-05, "add_states_from_episodes_to_batch": 1.4540890594649897e-05, "batch_individual_items": 0.2246333182693771, "general_advantage_estimation": 0.0645208527887093, "add_time_dim_to_batch_and_zero_pad": 6.343648189640374e-05}}, "connector_pipeline_timer": 0.3843201729980669}, "learner_connector_sum_episodes_length_in": 2834.0, "num_module_steps_trained_lifetime": 340992, "num_env_steps_trained_lifetime": 3774888, "learner_connector_sum_episodes_length_out": 2834.0, "num_non_trainable_parameters": 0, "num_trainable_parameters": 445130, "num_module_steps_trained": 56832, "num_env_steps_trained": 629148, "num_env_steps_trained_lifetime_throughput": 34497.736059060146, "num_module_steps_trained_lifetime_throughput": 3116.241885246276}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 17004, "fault_tolerance": {"num_healthy_workers": 1, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 1}, "done": false, "training_iteration": 6, "trial_id": "dc8cf_00000", "date": "2025-11-20_14-50-05", "timestamp": 1763621405, "time_this_iter_s": 18.176313877105713, "time_total_s": 109.6895809173584, "pid": 11834, "hostname": "CS-ubuntu", "node_ip": "10.207.136.136", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MARL_EXO_ENV", "env_config": {"render_mode": "human", "render_bool": false, "frame_skip": 2, "model_path": "/home/chenshuo/PycharmProjects/move_sim/SMPL/data/xml/mj_fullbody_with_exo_carrying_policy_test.xml", "n_stacks": 1, "human_obs_keys": ["qpos", "local_body_pos", "local_body_vel", "local_body_rot_obs", "local_body_angle_vel"], "exo_obs_keys": ["exo_joint_t", "exo_joint_vel_t"], "weighted_reward_keys": {"w_pos_err": 0.4, "w_proprio_err": 0.6, "w_activation": 0.4, "w_exo_energy": 0.2, "w_exo_smooth": 0.3, "theta_pos_err": 0.1, "theta_proprio_err": 0.03, "theta_activation": 0.03, "theta_exo_energy": 0.01, "theta_exo_smooth": 0.2}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 2, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 120, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 128, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7fcae53ae440>", "policies_to_train": ["human_policy", "exo_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"human_policy": [null, "Box(-inf, inf, (248,), float32)", "Box(0.0, 1.0, (98,), float32)", {"model": {"custom_model": "human_model"}}], "exo_policy": [null, "Box(-10.0, 10.0, (4,), float32)", "Box(-0.261799, 2.0944, (2,), float32)", {"model": {"custom_model": "exo_model"}}]}, "callbacks": "<class 'SMPL.src.Custom_CallBack.RewardLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 109.6895809173584, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 19.616666666666667, "ram_util_percent": 55.35, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.001953125}}
{"timers": {"training_iteration": 18.92657106157206, "restore_env_runners": 5.385988996855551e-05, "training_step": 18.926099442010432, "env_runner_sampling_timer": 14.813619741425228, "learner_update_timer": 4.107120784141798, "synch_weights": 0.004547215952916416, "synch_env_connectors": 0.003755264740024327}, "env_runners": {"sample": 14.784685273685016, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.0003569565849653627, "normalize_and_clip_actions": 0.00017852348904035063, "module_to_agent_unmapping": 6.311297362935978e-06, "listify_data_for_vector_env": 2.0281997604118106e-05, "tensor_to_numpy": 8.679551539955916e-05, "remove_single_ts_time_rank_from_batch": 2.760317638526698e-06, "un_batch_to_individual_items": 4.941006314894413e-05}}, "connector_pipeline_timer": 0.000811636409062709}, "env_step_timer": 0.005534864548539429, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00010010311427077535, "add_observations_from_episodes_to_batch": 4.427023534235775e-05, "batch_individual_items": 4.635723702933311e-05, "agent_to_module_mapping": 1.000076752585454e-05, "add_time_dim_to_batch_and_zero_pad": 1.939943997626029e-05, "add_states_from_episodes_to_batch": 8.101837634517538e-06}}, "connector_pipeline_timer": 0.00031742070788149166}, "num_module_steps_sampled_lifetime": {"exo_policy": 19838, "human_policy": 19838}, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.833954230763318e-05, "add_states_from_episodes_to_batch": 1.3253521552489183e-05, "numpy_to_tensor": 0.0002974819727892375, "add_observations_from_episodes_to_batch": 0.0001399021531067387, "batch_individual_items": 0.00010104057820303334, "agent_to_module_mapping": 1.723331276628019e-05}}, "custom": {"exo": {"R_t_mean": 0.11125107857051723, "R_eas_mean": 0.192434987252216}, "human": {"R_a_mean": 0.12057442950943384, "R_proprio_mean": 0.4180048316160203, "R_p_mean": 0.3128878297241441}}, "agent_steps": {"human": 1417.0, "exo": 1417.0}, "num_env_steps_sampled_lifetime": 19838, "connector_pipeline_timer": 0.001246960786918693, "num_agent_steps_sampled": {"human": 2834, "exo": 2834}, "episode_return_max": 2856.215389417904, "agent_episode_returns_mean": {"human": 1206.5288677338808, "exo": 1636.852023004693}, "env_to_module_sum_episodes_length_in": 2621.831824891575, "module_episode_returns_mean": {"exo_policy": 1636.852023004693, "human_policy": 1206.5288677338808}, "episode_duration_sec_mean": 14.474938140071426, "num_module_steps_sampled": {"exo_policy": 2834, "human_policy": 2834}, "env_reset_timer": 0.07584065844461535, "rlmodule_inference_timer": 0.0005684334005077355, "episode_len_min": 1417, "num_episodes_lifetime": 14, "weights_seq_no": 6.0, "num_agent_steps_sampled_lifetime": {"human": 19838, "exo": 19838}, "episode_len_max": 1417, "env_to_module_sum_episodes_length_out": 2621.831824891575, "num_env_steps_sampled": 2834, "episode_return_mean": 2843.3808907385746, "num_episodes": 2, "episode_return_min": 2835.7288104104737, "episode_len_mean": 1417.0, "time_between_sampling": 4.1788987326488884, "num_env_steps_sampled_lifetime_throughput": 155.35702906759354}, "learners": {"exo_policy": {"entropy": 2.740105152130127, "mean_kl_loss": 0.01575002260506153, "module_train_batch_size_mean": 128.0, "default_optimizer_learning_rate": 0.0005, "num_module_steps_trained_lifetime": 198912, "total_loss": 9.874866485595703, "weights_seq_no": 7.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 0.45000001788139343, "vf_loss_unclipped": 11721.7412109375, "vf_loss": 9.92982292175293, "num_trainable_parameters": 135429, "curr_entropy_coeff": 0.0, "num_module_steps_trained": 28416, "vf_explained_var": -0.10026109218597412, "policy_loss": -0.062044233083724976, "num_module_steps_trained_lifetime_throughput": 1559.3640319074811}, "human_policy": {"num_trainable_parameters": 309701, "curr_kl_coeff": 3.4171876907348633, "vf_loss": 10.0, "module_train_batch_size_mean": 128.0, "default_optimizer_learning_rate": 0.0005, "num_module_steps_trained_lifetime": 198912, "total_loss": 9.798161506652832, "weights_seq_no": 7.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 6640.72216796875, "curr_entropy_coeff": 0.0, "num_module_steps_trained": 28416, "vf_explained_var": 0.044002532958984375, "policy_loss": -0.27521634101867676, "entropy": 139.22808837890625, "mean_kl_loss": 0.03220945596694946, "num_module_steps_trained_lifetime_throughput": 1559.363100156037}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.00711332106757796, "agent_to_module_mapping": 0.004792932359235074, "add_columns_from_episodes_to_train_batch": 0.08186084964554809, "numpy_to_tensor": 0.0003120990994848442, "add_observations_from_episodes_to_batch": 8.836182193640157e-05, "add_states_from_episodes_to_batch": 1.4516811687977564e-05, "batch_individual_items": 0.22294200537668415, "general_advantage_estimation": 0.06414791329082148, "add_time_dim_to_batch_and_zero_pad": 6.344946707767545e-05}}, "connector_pipeline_timer": 0.38224915286808564}, "learner_connector_sum_episodes_length_in": 2834.0, "num_module_steps_trained_lifetime": 397824, "num_env_steps_trained_lifetime": 4404036, "learner_connector_sum_episodes_length_out": 2834.0, "num_non_trainable_parameters": 0, "num_trainable_parameters": 445130, "num_module_steps_trained": 56832, "num_env_steps_trained": 629148, "num_env_steps_trained_lifetime_throughput": 34525.254289042205, "num_module_steps_trained_lifetime_throughput": 3118.7275693908364}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 19838, "fault_tolerance": {"num_healthy_workers": 1, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 1}, "done": true, "training_iteration": 7, "trial_id": "dc8cf_00000", "date": "2025-11-20_14-50-23", "timestamp": 1763621423, "time_this_iter_s": 17.92825436592102, "time_total_s": 127.61783528327942, "pid": 11834, "hostname": "CS-ubuntu", "node_ip": "10.207.136.136", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MARL_EXO_ENV", "env_config": {"render_mode": "human", "render_bool": false, "frame_skip": 2, "model_path": "/home/chenshuo/PycharmProjects/move_sim/SMPL/data/xml/mj_fullbody_with_exo_carrying_policy_test.xml", "n_stacks": 1, "human_obs_keys": ["qpos", "local_body_pos", "local_body_vel", "local_body_rot_obs", "local_body_angle_vel"], "exo_obs_keys": ["exo_joint_t", "exo_joint_vel_t"], "weighted_reward_keys": {"w_pos_err": 0.4, "w_proprio_err": 0.6, "w_activation": 0.4, "w_exo_energy": 0.2, "w_exo_smooth": 0.3, "theta_pos_err": 0.1, "theta_proprio_err": 0.03, "theta_activation": 0.03, "theta_exo_energy": 0.01, "theta_exo_smooth": 0.2}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 2, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 120, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 128, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7fcae53f5480>", "policies_to_train": ["human_policy", "exo_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"human_policy": [null, "Box(-inf, inf, (248,), float32)", "Box(0.0, 1.0, (98,), float32)", {"model": {"custom_model": "human_model"}}], "exo_policy": [null, "Box(-10.0, 10.0, (4,), float32)", "Box(-0.261799, 2.0944, (2,), float32)", {"model": {"custom_model": "exo_model"}}]}, "callbacks": "<class 'SMPL.src.Custom_CallBack.RewardLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 127.61783528327942, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 18.834782608695654, "ram_util_percent": 55.404347826086955, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.001953125}}
