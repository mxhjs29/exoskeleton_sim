{"timers": {"training_iteration": 17.360790588999862, "restore_env_runners": 4.597600013767078e-05, "training_step": 17.360408919000065, "env_runner_sampling_timer": 14.023602651000147, "learner_update_timer": 3.332718759000045, "synch_weights": 0.0033137299999452807}, "env_runners": {"num_module_steps_sampled": {"exo_policy": 2834, "human_policy": 2834}, "env_to_module_sum_episodes_length_out": 2621.8301293409154, "custom": {"human": {"R_p_mean": 0.220061135536741, "R_a_mean": 0.00015980852085652794, "R_proprio_mean": 0.11562245597458654}, "exo": {"R_t_mean": 0.03168036729630729, "R_eas_mean": 0.017328281819951746}}, "module_episode_returns_mean": {"exo_policy": 545.335353643344, "human_policy": 475.89009784560443}, "timers": {"connectors": {"batch_individual_items": 4.7901000016281614e-05, "numpy_to_tensor": 0.00010234299998046481, "agent_to_module_mapping": 8.537000212527346e-06, "add_states_from_episodes_to_batch": 8.796999964033603e-06, "add_time_dim_to_batch_and_zero_pad": 2.1350999986680108e-05, "add_observations_from_episodes_to_batch": 5.913199993301532e-05}}, "env_to_module_connector": {"connector_pipeline_timer": 0.00031978127701278597, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.0372645521390736e-05, "add_observations_from_episodes_to_batch": 4.3629326866906824e-05, "batch_individual_items": 4.762075880250026e-05, "numpy_to_tensor": 9.870966826505422e-05, "agent_to_module_mapping": 9.02321888483225e-06, "add_states_from_episodes_to_batch": 8.751894964084842e-06}}}, "agent_steps": {"exo": 1417.0, "human": 1417.0}, "episode_len_min": 1417, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 8.678873225178396e-05, "module_to_agent_unmapping": 6.912870651804055e-06, "get_actions": 0.0003400781296825681, "listify_data_for_vector_env": 2.0431266730455985e-05, "normalize_and_clip_actions": 0.00018253345296298528, "remove_single_ts_time_rank_from_batch": 2.698450500266905e-06, "un_batch_to_individual_items": 4.9946637984465434e-05}}, "connector_pipeline_timer": 0.0008028705781957138}, "num_module_steps_sampled_lifetime": {"exo_policy": 2834, "human_policy": 2834}, "episode_len_max": 1417, "num_env_steps_sampled": 2834, "num_episodes": 2, "sample": 13.995194598999888, "env_to_module_sum_episodes_length_in": 2621.8301293409154, "weights_seq_no": 0.0, "num_agent_steps_sampled": {"exo": 2834, "human": 2834}, "num_agent_steps_sampled_lifetime": {"exo": 2834, "human": 2834}, "agent_episode_returns_mean": {"human": 475.89009784560443, "exo": 545.335353643344}, "episode_return_max": 1021.2284485424991, "num_env_steps_sampled_lifetime": 2834, "env_reset_timer": 0.046115427999893654, "num_episodes_lifetime": 2, "episode_return_min": 1021.2224544353978, "rlmodule_inference_timer": 0.0005183768819187365, "episode_duration_sec_mean": 13.899897912500023, "env_step_timer": 0.005598592742973159, "connector_pipeline_timer": 0.0005707969999093621, "episode_return_mean": 1021.2254514889485, "episode_len_mean": 1417.0, "num_env_steps_sampled_lifetime_throughput": NaN}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.2140870210000685, "general_advantage_estimation": 0.025715233000028093, "add_time_dim_to_batch_and_zero_pad": 3.560699997251504e-05, "numpy_to_tensor": 0.00031420300001627766, "add_one_ts_to_episodes_and_truncate": 0.01001970899983462, "add_columns_from_episodes_to_train_batch": 0.08797799999979361, "agent_to_module_mapping": 0.0043596129999059485, "add_states_from_episodes_to_batch": 9.788999932425213e-06, "add_observations_from_episodes_to_batch": 9.30450000851124e-05}}, "connector_pipeline_timer": 0.34335242599991034}, "num_module_steps_trained_lifetime": 56832, "num_trainable_parameters": 445130, "num_env_steps_trained_lifetime": 629148, "learner_connector_sum_episodes_length_out": 2834, "learner_connector_sum_episodes_length_in": 2834, "num_env_steps_trained": 629148, "num_module_steps_trained": 56832, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": NaN, "num_module_steps_trained_lifetime_throughput": NaN}, "exo_policy": {"module_train_batch_size_mean": 128.0, "num_module_steps_trained_lifetime": 28416, "total_loss": 8.309297561645508, "curr_entropy_coeff": 0.0, "vf_loss": 8.163169860839844, "default_optimizer_learning_rate": 0.0005, "vf_loss_unclipped": 876.2659912109375, "curr_kl_coeff": 0.30000001192092896, "weights_seq_no": 1.0, "num_module_steps_trained": 28416, "mean_kl_loss": 0.15012581646442413, "entropy": 3.1074562072753906, "vf_explained_var": 0.027864575386047363, "num_trainable_parameters": 135429, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.11610238254070282, "num_module_steps_trained_lifetime_throughput": NaN}, "human_policy": {"num_trainable_parameters": 309701, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.24643632769584656, "num_module_steps_trained_lifetime": 28416, "total_loss": 7.611120223999023, "vf_explained_var": 0.2539854049682617, "curr_entropy_coeff": 0.0, "vf_loss": 7.8133544921875, "default_optimizer_learning_rate": 0.0005, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 578.5609130859375, "curr_kl_coeff": 0.30000001192092896, "weights_seq_no": 1.0, "num_module_steps_trained": 28416, "mean_kl_loss": 0.2210090160369873, "entropy": 138.61907958984375, "num_module_steps_trained_lifetime_throughput": NaN}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 2834, "fault_tolerance": {"num_healthy_workers": 1, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 1}, "done": false, "training_iteration": 1, "trial_id": "f23a0_00001", "date": "2025-11-20_15-03-27", "timestamp": 1763622207, "time_this_iter_s": 17.367194414138794, "time_total_s": 17.367194414138794, "pid": 26353, "hostname": "CS-ubuntu", "node_ip": "10.207.136.136", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MARL_EXO_ENV", "env_config": {"render_mode": "human", "render_bool": false, "frame_skip": 2, "model_path": "/home/chenshuo/PycharmProjects/move_sim/SMPL/data/xml/mj_fullbody_with_exo_carrying_policy_test.xml", "n_stacks": 1, "human_obs_keys": ["qpos", "local_body_pos", "local_body_vel", "local_body_rot_obs", "local_body_angle_vel"], "exo_obs_keys": ["exo_joint_t", "exo_joint_vel_t"], "weighted_reward_keys": {"w_pos_err": 0.5, "w_proprio_err": 0.4, "w_activation": 0.4, "w_exo_energy": 0.2, "w_exo_smooth": 0.2, "theta_pos_err": 0.5, "theta_proprio_err": 0.3, "theta_activation": 0.3, "theta_exo_energy": 0.1, "theta_exo_smooth": 4}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 2, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 120, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 128, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f94448bb7f0>", "policies_to_train": ["human_policy", "exo_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"human_policy": [null, "Box(-inf, inf, (248,), float32)", "Box(0.0, 1.0, (98,), float32)", {"model": {"custom_model": "human_model"}}], "exo_policy": [null, "Box(-10.0, 10.0, (4,), float32)", "Box(-0.261799, 2.0944, (2,), float32)", {"model": {"custom_model": "exo_model"}}]}, "callbacks": "<class 'SMPL.src.Custom_CallBack.RewardLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 17.367194414138794, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 21.63478260869565, "ram_util_percent": 62.88260869565218, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.001326851222826087}}
{"timers": {"training_iteration": 17.356153438979863, "restore_env_runners": 4.569929013769069e-05, "training_step": 17.355771178560065, "env_runner_sampling_timer": 14.021468886990148, "learner_update_timer": 3.330222741790044, "synch_weights": 0.003305740519945175, "synch_env_connectors": 0.0018346609999753127}, "env_runners": {"num_module_steps_sampled": {"exo_policy": 2834, "human_policy": 2834}, "env_to_module_sum_episodes_length_out": 2621.8318248904784, "custom": {"human": {"R_p_mean": 0.2199430752729695, "R_a_mean": 0.0001502975035036862, "R_proprio_mean": 0.1157308752695049}, "exo": {"R_t_mean": 0.03162787460015443, "R_eas_mean": 0.018828805469100377}}, "module_episode_returns_mean": {"exo_policy": 547.3600751392851, "human_policy": 475.8629594811507}, "timers": {"connectors": {"batch_individual_items": 4.783797001437051e-05, "numpy_to_tensor": 0.00010212968998075666, "agent_to_module_mapping": 8.532280212421028e-06, "add_states_from_episodes_to_batch": 8.791179964191543e-06, "add_time_dim_to_batch_and_zero_pad": 2.132844998868677e-05, "add_observations_from_episodes_to_batch": 5.907518993353733e-05}}, "env_to_module_connector": {"connector_pipeline_timer": 0.00029551448118363865, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.8889128460379407e-05, "add_observations_from_episodes_to_batch": 4.112738226094197e-05, "batch_individual_items": 4.345247056584887e-05, "numpy_to_tensor": 9.00060086833647e-05, "agent_to_module_mapping": 8.282598166957326e-06, "add_states_from_episodes_to_batch": 8.083673442252126e-06}}}, "agent_steps": {"exo": 1417.0, "human": 1417.0}, "episode_len_min": 1417, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 8.283186668571341e-05, "module_to_agent_unmapping": 5.924290230097334e-06, "get_actions": 0.0003243682085679082, "listify_data_for_vector_env": 1.916672132538758e-05, "normalize_and_clip_actions": 0.00016808829594914954, "remove_single_ts_time_rank_from_batch": 2.5087889762364347e-06, "un_batch_to_individual_items": 4.688952895356281e-05}}, "connector_pipeline_timer": 0.0007572744722460165}, "num_module_steps_sampled_lifetime": {"exo_policy": 5668, "human_policy": 5668}, "episode_len_max": 1417, "num_env_steps_sampled": 2834, "num_episodes": 2, "sample": 13.993159742879888, "env_to_module_sum_episodes_length_in": 2621.8318248904784, "weights_seq_no": 1.0, "num_agent_steps_sampled": {"exo": 2834, "human": 2834}, "num_agent_steps_sampled_lifetime": {"exo": 5668, "human": 5668}, "agent_episode_returns_mean": {"human": 475.8629594811507, "exo": 547.3600751392851}, "episode_return_max": 1029.7898555581994, "num_env_steps_sampled_lifetime": 5668, "env_reset_timer": 0.0460256661098947, "num_episodes_lifetime": 4, "episode_return_min": 1020.6513799456468, "rlmodule_inference_timer": 0.0004927888608557327, "episode_duration_sec_mean": 13.803224824500035, "env_step_timer": 0.0052965765372562255, "connector_pipeline_timer": 0.0005680435099088754, "episode_return_mean": 1023.2230346204358, "episode_len_mean": 1417.0, "time_between_sampling": 3.391253072999916, "num_env_steps_sampled_lifetime_throughput": NaN}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.21246383473006744, "general_advantage_estimation": 0.025726789250027197, "add_time_dim_to_batch_and_zero_pad": 3.552824997314019e-05, "numpy_to_tensor": 0.00031335629001432607, "add_one_ts_to_episodes_and_truncate": 0.009962994319837434, "add_columns_from_episodes_to_train_batch": 0.08789783616979548, "agent_to_module_mapping": 0.004362432409907342, "add_states_from_episodes_to_batch": 9.779979932318383e-06, "add_observations_from_episodes_to_batch": 9.280916008492567e-05}}, "connector_pipeline_timer": 0.34160094154991155}, "num_module_steps_trained_lifetime": 113664, "num_trainable_parameters": 445130, "num_env_steps_trained_lifetime": 1258296, "learner_connector_sum_episodes_length_out": 2834.0, "learner_connector_sum_episodes_length_in": 2834.0, "num_env_steps_trained": 629148, "num_module_steps_trained": 56832, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": NaN, "num_module_steps_trained_lifetime_throughput": NaN}, "exo_policy": {"module_train_batch_size_mean": 128.0, "num_module_steps_trained_lifetime": 56832, "total_loss": 8.32017993927002, "curr_entropy_coeff": 0.0, "vf_loss": 8.419774055480957, "default_optimizer_learning_rate": 0.0005, "vf_loss_unclipped": 893.6734619140625, "curr_kl_coeff": 0.45000001788139343, "weights_seq_no": 2.0, "num_module_steps_trained": 28416, "mean_kl_loss": 0.03002152033150196, "entropy": 3.2260985374450684, "vf_explained_var": 0.0771033763885498, "num_trainable_parameters": 135429, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.10860104858875275, "num_module_steps_trained_lifetime_throughput": NaN}, "human_policy": {"num_trainable_parameters": 309701, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.11262410879135132, "num_module_steps_trained_lifetime": 56832, "total_loss": 7.702652931213379, "vf_explained_var": 0.3165951371192932, "curr_entropy_coeff": 0.0, "vf_loss": 7.773130416870117, "default_optimizer_learning_rate": 0.0005, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 373.4053649902344, "curr_kl_coeff": 0.45000001788139343, "weights_seq_no": 2.0, "num_module_steps_trained": 28416, "mean_kl_loss": 0.14048883318901062, "entropy": 138.4322967529297, "num_module_steps_trained_lifetime_throughput": NaN}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 5668, "fault_tolerance": {"num_healthy_workers": 1, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 1}, "done": false, "training_iteration": 2, "trial_id": "f23a0_00001", "date": "2025-11-20_15-03-44", "timestamp": 1763622224, "time_this_iter_s": 16.90326976776123, "time_total_s": 34.270464181900024, "pid": 26353, "hostname": "CS-ubuntu", "node_ip": "10.207.136.136", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MARL_EXO_ENV", "env_config": {"render_mode": "human", "render_bool": false, "frame_skip": 2, "model_path": "/home/chenshuo/PycharmProjects/move_sim/SMPL/data/xml/mj_fullbody_with_exo_carrying_policy_test.xml", "n_stacks": 1, "human_obs_keys": ["qpos", "local_body_pos", "local_body_vel", "local_body_rot_obs", "local_body_angle_vel"], "exo_obs_keys": ["exo_joint_t", "exo_joint_vel_t"], "weighted_reward_keys": {"w_pos_err": 0.5, "w_proprio_err": 0.4, "w_activation": 0.4, "w_exo_energy": 0.2, "w_exo_smooth": 0.2, "theta_pos_err": 0.5, "theta_proprio_err": 0.3, "theta_activation": 0.3, "theta_exo_energy": 0.1, "theta_exo_smooth": 4}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 2, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 120, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 128, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f94448bb9a0>", "policies_to_train": ["human_policy", "exo_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"human_policy": [null, "Box(-inf, inf, (248,), float32)", "Box(0.0, 1.0, (98,), float32)", {"model": {"custom_model": "human_model"}}], "exo_policy": [null, "Box(-10.0, 10.0, (4,), float32)", "Box(-0.261799, 2.0944, (2,), float32)", {"model": {"custom_model": "exo_model"}}]}, "callbacks": "<class 'SMPL.src.Custom_CallBack.RewardLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 34.270464181900024, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 19.130434782608695, "ram_util_percent": 63.334782608695654, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.001953125}}
{"timers": {"training_iteration": 17.362660126710065, "restore_env_runners": 4.55324472374059e-05, "training_step": 17.362275812514465, "env_runner_sampling_timer": 14.028183468830246, "learner_update_timer": 3.330016291972145, "synch_weights": 0.0033021345547459536, "synch_env_connectors": 0.0018358296899759806}, "env_runners": {"num_module_steps_sampled": {"exo_policy": 2834, "human_policy": 2834}, "env_to_module_sum_episodes_length_out": 2621.831824891575, "custom": {"human": {"R_p_mean": 0.21992817649205507, "R_a_mean": 0.0001483165495184856, "R_proprio_mean": 0.11652058937758525}, "exo": {"R_t_mean": 0.03174640220010553, "R_eas_mean": 0.018786389509967267}}, "module_episode_returns_mean": {"exo_policy": 548.5630316411213, "human_policy": 476.958065787948}, "timers": {"connectors": {"batch_individual_items": 4.7895100312598514e-05, "numpy_to_tensor": 0.00010220976307959972, "agent_to_module_mapping": 8.54864741036181e-06, "add_states_from_episodes_to_batch": 8.795748164243379e-06, "add_time_dim_to_batch_and_zero_pad": 2.135281548803505e-05, "add_observations_from_episodes_to_batch": 5.910771803432908e-05}}, "env_to_module_connector": {"connector_pipeline_timer": 0.00031485436176889733, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.1027021523043253e-05, "add_observations_from_episodes_to_batch": 4.308888979925117e-05, "batch_individual_items": 4.4959152234124606e-05, "numpy_to_tensor": 9.975926802567173e-05, "agent_to_module_mapping": 8.83536441289332e-06, "add_states_from_episodes_to_batch": 8.184973386936595e-06}}}, "agent_steps": {"exo": 1417.0, "human": 1417.0}, "episode_len_min": 1417, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 8.59830837911337e-05, "module_to_agent_unmapping": 6.285237476639636e-06, "get_actions": 0.00033835975357159975, "listify_data_for_vector_env": 1.970159676196452e-05, "normalize_and_clip_actions": 0.00017736431736044465, "remove_single_ts_time_rank_from_batch": 2.6080619046160754e-06, "un_batch_to_individual_items": 4.8247269396791944e-05}}, "connector_pipeline_timer": 0.0007880780045656371}, "num_module_steps_sampled_lifetime": {"exo_policy": 8502, "human_policy": 8502}, "episode_len_max": 1417, "num_env_steps_sampled": 2834, "num_episodes": 2, "sample": 13.999961030611088, "env_to_module_sum_episodes_length_in": 2621.831824891575, "weights_seq_no": 2.0, "num_agent_steps_sampled": {"exo": 2834, "human": 2834}, "num_agent_steps_sampled_lifetime": {"exo": 8502, "human": 8502}, "agent_episode_returns_mean": {"human": 476.958065787948, "exo": 548.5630316411213}, "episode_return_max": 1036.111596828179, "num_env_steps_sampled_lifetime": 8502, "env_reset_timer": 0.045935479288794205, "num_episodes_lifetime": 6, "episode_return_min": 1020.6513799456468, "rlmodule_inference_timer": 0.0005491798424768739, "episode_duration_sec_mean": 14.063933346333366, "env_step_timer": 0.0055502755492052745, "connector_pipeline_timer": 0.0005661220648087009, "episode_return_mean": 1025.5210974290692, "episode_len_mean": 1417.0, "time_between_sampling": 3.388702273059917, "num_env_steps_sampled_lifetime_throughput": 159.12339925969084}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.2108747196827668, "general_advantage_estimation": 0.02572225806752615, "add_time_dim_to_batch_and_zero_pad": 3.574935747374184e-05, "numpy_to_tensor": 0.00031228621711527465, "add_one_ts_to_episodes_and_truncate": 0.009929616116640977, "add_columns_from_episodes_to_train_batch": 0.08813305187809838, "agent_to_module_mapping": 0.004365102685807596, "add_states_from_episodes_to_batch": 9.802710131634738e-06, "add_observations_from_episodes_to_batch": 9.304265848479644e-05}}, "connector_pipeline_timer": 0.34020806519441193}, "num_module_steps_trained_lifetime": 170496, "num_trainable_parameters": 445130, "num_env_steps_trained_lifetime": 1887444, "learner_connector_sum_episodes_length_out": 2834.0, "learner_connector_sum_episodes_length_in": 2834.0, "num_env_steps_trained": 629148, "num_module_steps_trained": 56832, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 34881.64516825841, "num_module_steps_trained_lifetime_throughput": 3150.9174354263823}, "exo_policy": {"module_train_batch_size_mean": 128.0, "num_module_steps_trained_lifetime": 85248, "total_loss": 7.683235168457031, "curr_entropy_coeff": 0.0, "vf_loss": 7.681305885314941, "default_optimizer_learning_rate": 0.0005, "vf_loss_unclipped": 800.220703125, "curr_kl_coeff": 0.45000001788139343, "weights_seq_no": 3.0, "num_module_steps_trained": 28416, "mean_kl_loss": 0.016267182305455208, "entropy": 3.3256921768188477, "vf_explained_var": 0.05614084005355835, "num_trainable_parameters": 135429, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.005391817539930344, "num_module_steps_trained_lifetime_throughput": 1575.4582145036513}, "human_policy": {"num_trainable_parameters": 309701, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.08079628646373749, "num_module_steps_trained_lifetime": 85248, "total_loss": 6.984647750854492, "vf_explained_var": 0.4875125288963318, "curr_entropy_coeff": 0.0, "vf_loss": 7.0169196128845215, "default_optimizer_learning_rate": 0.0005, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 259.98419189453125, "curr_kl_coeff": 0.675000011920929, "weights_seq_no": 3.0, "num_module_steps_trained": 28416, "mean_kl_loss": 0.10783237963914871, "entropy": 138.64608764648438, "num_module_steps_trained_lifetime_throughput": 1575.4589837741148}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 8502, "fault_tolerance": {"num_healthy_workers": 1, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 1}, "done": false, "training_iteration": 3, "trial_id": "f23a0_00001", "date": "2025-11-20_15-04-02", "timestamp": 1763622242, "time_this_iter_s": 18.013004302978516, "time_total_s": 52.28346848487854, "pid": 26353, "hostname": "CS-ubuntu", "node_ip": "10.207.136.136", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MARL_EXO_ENV", "env_config": {"render_mode": "human", "render_bool": false, "frame_skip": 2, "model_path": "/home/chenshuo/PycharmProjects/move_sim/SMPL/data/xml/mj_fullbody_with_exo_carrying_policy_test.xml", "n_stacks": 1, "human_obs_keys": ["qpos", "local_body_pos", "local_body_vel", "local_body_rot_obs", "local_body_angle_vel"], "exo_obs_keys": ["exo_joint_t", "exo_joint_vel_t"], "weighted_reward_keys": {"w_pos_err": 0.5, "w_proprio_err": 0.4, "w_activation": 0.4, "w_exo_energy": 0.2, "w_exo_smooth": 0.2, "theta_pos_err": 0.5, "theta_proprio_err": 0.3, "theta_activation": 0.3, "theta_exo_energy": 0.1, "theta_exo_smooth": 4}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 2, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 120, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 128, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f94448005e0>", "policies_to_train": ["human_policy", "exo_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"human_policy": [null, "Box(-inf, inf, (248,), float32)", "Box(0.0, 1.0, (98,), float32)", {"model": {"custom_model": "human_model"}}], "exo_policy": [null, "Box(-10.0, 10.0, (4,), float32)", "Box(-0.261799, 2.0944, (2,), float32)", {"model": {"custom_model": "exo_model"}}]}, "callbacks": "<class 'SMPL.src.Custom_CallBack.RewardLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 52.28346848487854, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 21.65833333333333, "ram_util_percent": 63.5, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.001953125}}
{"timers": {"training_iteration": 17.365331034762963, "restore_env_runners": 4.529513276505781e-05, "training_step": 17.364946145479323, "env_runner_sampling_timer": 14.031505547871944, "learner_update_timer": 3.329366715242424, "synch_weights": 0.0032992757791997607, "synch_env_connectors": 0.0018384162930761248}, "env_runners": {"num_module_steps_sampled": {"exo_policy": 2834, "human_policy": 2834}, "env_to_module_sum_episodes_length_out": 2621.831824891575, "custom": {"human": {"R_p_mean": 0.21995781600310615, "R_a_mean": 0.00014853878717029147, "R_proprio_mean": 0.11622916678645301}, "exo": {"R_t_mean": 0.03215371452335668, "R_eas_mean": 0.018709038476034882}}, "module_episode_returns_mean": {"exo_policy": 548.6599550743636, "human_policy": 476.58743407422565}, "timers": {"connectors": {"batch_individual_items": 4.784586931021113e-05, "numpy_to_tensor": 0.00010209667544901776, "agent_to_module_mapping": 8.545610935157583e-06, "add_states_from_episodes_to_batch": 8.788540683562361e-06, "add_time_dim_to_batch_and_zero_pad": 2.1335257332067613e-05, "add_observations_from_episodes_to_batch": 5.9111860852999145e-05}}, "env_to_module_connector": {"connector_pipeline_timer": 0.0002917643262536367, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.8585104766794126e-05, "add_observations_from_episodes_to_batch": 4.1590741482107146e-05, "batch_individual_items": 4.2285521469042785e-05, "numpy_to_tensor": 8.75566972242501e-05, "agent_to_module_mapping": 8.349570011700507e-06, "add_states_from_episodes_to_batch": 8.058618837360128e-06}}}, "agent_steps": {"exo": 1417.0, "human": 1417.0}, "episode_len_min": 1417, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 8.188325487478873e-05, "module_to_agent_unmapping": 5.93016520868155e-06, "get_actions": 0.0003161928865936309, "listify_data_for_vector_env": 1.9156840846640753e-05, "normalize_and_clip_actions": 0.00016896940591413712, "remove_single_ts_time_rank_from_batch": 2.513489282451246e-06, "un_batch_to_individual_items": 4.817202714526251e-05}}, "connector_pipeline_timer": 0.0007499951014833442}, "num_module_steps_sampled_lifetime": {"exo_policy": 11336, "human_policy": 11336}, "episode_len_max": 1417, "num_env_steps_sampled": 2834, "num_episodes": 2, "sample": 14.003365648594977, "env_to_module_sum_episodes_length_in": 2621.831824891575, "weights_seq_no": 3.0, "num_agent_steps_sampled": {"exo": 2834, "human": 2834}, "num_agent_steps_sampled_lifetime": {"exo": 11336, "human": 11336}, "agent_episode_returns_mean": {"human": 476.58743407422565, "exo": 548.6599550743636}, "episode_return_max": 1036.111596828179, "num_env_steps_sampled_lifetime": 11336, "env_reset_timer": 0.04587620896590617, "num_episodes_lifetime": 8, "episode_return_min": 1020.6513799456468, "rlmodule_inference_timer": 0.00046758580790871076, "episode_duration_sec_mean": 14.109070356375042, "env_step_timer": 0.005239648624366047, "connector_pipeline_timer": 0.0005636576741610476, "episode_return_mean": 1025.2473891485893, "episode_len_mean": 1417.0, "time_between_sampling": 3.388476505009318, "num_env_steps_sampled_lifetime_throughput": 159.1695938676928}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.21114838210593878, "general_advantage_estimation": 0.02571859010684968, "add_time_dim_to_batch_and_zero_pad": 3.5654763899511634e-05, "numpy_to_tensor": 0.0003114186049454481, "add_one_ts_to_episodes_and_truncate": 0.00988411950547537, "add_columns_from_episodes_to_train_batch": 0.08805525425931914, "agent_to_module_mapping": 0.004365337508949671, "add_states_from_episodes_to_batch": 9.800263031334451e-06, "add_observations_from_episodes_to_batch": 9.300862189947361e-05}}, "connector_pipeline_timer": 0.34034982403246844}, "num_module_steps_trained_lifetime": 227328, "num_trainable_parameters": 445130, "num_env_steps_trained_lifetime": 2516592, "learner_connector_sum_episodes_length_out": 2834.0, "learner_connector_sum_episodes_length_in": 2834.0, "num_env_steps_trained": 629148, "num_module_steps_trained": 56832, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 34918.551282566696, "num_module_steps_trained_lifetime_throughput": 3154.2512335073893}, "exo_policy": {"module_train_batch_size_mean": 128.0, "num_module_steps_trained_lifetime": 113664, "total_loss": 7.598528861999512, "curr_entropy_coeff": 0.0, "vf_loss": 7.523360252380371, "default_optimizer_learning_rate": 0.0005, "vf_loss_unclipped": 547.3742065429688, "curr_kl_coeff": 0.45000001788139343, "weights_seq_no": 4.0, "num_module_steps_trained": 28416, "mean_kl_loss": 0.015612749382853508, "entropy": 3.3312907218933105, "vf_explained_var": 0.23443597555160522, "num_trainable_parameters": 135429, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.06814268976449966, "num_module_steps_trained_lifetime_throughput": 1577.1250825836141}, "human_policy": {"num_trainable_parameters": 309701, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.24961791932582855, "num_module_steps_trained_lifetime": 113664, "total_loss": 7.055002689361572, "vf_explained_var": 0.6087069511413574, "curr_entropy_coeff": 0.0, "vf_loss": 7.2439727783203125, "default_optimizer_learning_rate": 0.0005, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 186.36582946777344, "curr_kl_coeff": 1.0125000476837158, "weights_seq_no": 4.0, "num_module_steps_trained": 28416, "mean_kl_loss": 0.08984940499067307, "entropy": 138.73825073242188, "num_module_steps_trained_lifetime_throughput": 1577.1258354737074}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 11336, "fault_tolerance": {"num_healthy_workers": 1, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 1}, "done": false, "training_iteration": 4, "trial_id": "f23a0_00001", "date": "2025-11-20_15-04-20", "timestamp": 1763622260, "time_this_iter_s": 17.636407136917114, "time_total_s": 69.91987562179565, "pid": 26353, "hostname": "CS-ubuntu", "node_ip": "10.207.136.136", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MARL_EXO_ENV", "env_config": {"render_mode": "human", "render_bool": false, "frame_skip": 2, "model_path": "/home/chenshuo/PycharmProjects/move_sim/SMPL/data/xml/mj_fullbody_with_exo_carrying_policy_test.xml", "n_stacks": 1, "human_obs_keys": ["qpos", "local_body_pos", "local_body_vel", "local_body_rot_obs", "local_body_angle_vel"], "exo_obs_keys": ["exo_joint_t", "exo_joint_vel_t"], "weighted_reward_keys": {"w_pos_err": 0.5, "w_proprio_err": 0.4, "w_activation": 0.4, "w_exo_energy": 0.2, "w_exo_smooth": 0.2, "theta_pos_err": 0.5, "theta_proprio_err": 0.3, "theta_activation": 0.3, "theta_exo_energy": 0.1, "theta_exo_smooth": 4}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 2, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 120, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 128, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f94448bb520>", "policies_to_train": ["human_policy", "exo_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"human_policy": [null, "Box(-inf, inf, (248,), float32)", "Box(0.0, 1.0, (98,), float32)", {"model": {"custom_model": "human_model"}}], "exo_policy": [null, "Box(-10.0, 10.0, (4,), float32)", "Box(-0.261799, 2.0944, (2,), float32)", {"model": {"custom_model": "exo_model"}}]}, "callbacks": "<class 'SMPL.src.Custom_CallBack.RewardLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 69.91987562179565, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 19.708695652173912, "ram_util_percent": 64.00434782608696, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.001953125}}
{"timers": {"training_iteration": 17.358860798205335, "restore_env_runners": 4.502853143801109e-05, "training_step": 17.35847572200453, "env_runner_sampling_timer": 14.027886732203225, "learner_update_timer": 3.326522380860001, "synch_weights": 0.003290545571408221, "synch_env_connectors": 0.0018366694001458648}, "env_runners": {"num_module_steps_sampled": {"exo_policy": 2834, "human_policy": 2834}, "env_to_module_sum_episodes_length_out": 2621.831824891575, "custom": {"human": {"R_p_mean": 0.21996148619116376, "R_a_mean": 0.00015284631051076613, "R_proprio_mean": 0.11611824880919996}, "exo": {"R_t_mean": 0.03227390579271232, "R_eas_mean": 0.018731606242139986}}, "module_episode_returns_mean": {"exo_policy": 548.7163782708951, "human_policy": 476.4415677175092}, "timers": {"connectors": {"batch_individual_items": 4.7853620618435994e-05, "numpy_to_tensor": 0.00010204824869363874, "agent_to_module_mapping": 8.54721482597501e-06, "add_states_from_episodes_to_batch": 8.79322527774244e-06, "add_time_dim_to_batch_and_zero_pad": 2.1347224758773778e-05, "add_observations_from_episodes_to_batch": 5.913049224443603e-05}}, "env_to_module_connector": {"connector_pipeline_timer": 0.00029756705739079973, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.9111329838850335e-05, "add_observations_from_episodes_to_batch": 4.160025223017064e-05, "batch_individual_items": 4.3928585487592284e-05, "numpy_to_tensor": 8.94140261774097e-05, "agent_to_module_mapping": 8.572285570259583e-06, "add_states_from_episodes_to_batch": 8.416661356434e-06}}}, "agent_steps": {"exo": 1417.0, "human": 1417.0}, "episode_len_min": 1417, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 8.25836463672583e-05, "module_to_agent_unmapping": 5.897084592589259e-06, "get_actions": 0.0003197684956533334, "listify_data_for_vector_env": 1.9305673832465373e-05, "normalize_and_clip_actions": 0.00017028618850516345, "remove_single_ts_time_rank_from_batch": 2.5112944030498607e-06, "un_batch_to_individual_items": 4.7663216913246385e-05}}, "connector_pipeline_timer": 0.0007552079773594629}, "num_module_steps_sampled_lifetime": {"exo_policy": 14170, "human_policy": 14170}, "episode_len_max": 1417, "num_env_steps_sampled": 2834, "num_episodes": 2, "sample": 13.999832584419028, "env_to_module_sum_episodes_length_in": 2621.831824891575, "weights_seq_no": 4.0, "num_agent_steps_sampled": {"exo": 2834, "human": 2834}, "num_agent_steps_sampled_lifetime": {"exo": 14170, "human": 14170}, "agent_episode_returns_mean": {"human": 476.4415677175092, "exo": 548.7163782708951}, "episode_return_max": 1036.111596828179, "num_env_steps_sampled_lifetime": 14170, "env_reset_timer": 0.04577717238624697, "num_episodes_lifetime": 10, "episode_return_min": 1020.6513799456468, "rlmodule_inference_timer": 0.00048136951435825997, "episode_duration_sec_mean": 13.999806071200009, "env_step_timer": 0.0052833008746068855, "connector_pipeline_timer": 0.0005615175874204353, "episode_return_mean": 1025.1579459884044, "episode_len_mean": 1417.0, "time_between_sampling": 3.3877391116092253, "num_env_steps_sampled_lifetime_throughput": 159.56379690145198}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.20955107066488052, "general_advantage_estimation": 0.025721506035780443, "add_time_dim_to_batch_and_zero_pad": 3.555990626017755e-05, "numpy_to_tensor": 0.0003102702288955404, "add_one_ts_to_episodes_and_truncate": 0.009840185040422292, "add_columns_from_episodes_to_train_batch": 0.08798125960672415, "agent_to_module_mapping": 0.004366958893860385, "add_states_from_episodes_to_batch": 9.791530400555843e-06, "add_observations_from_episodes_to_batch": 9.310697568187045e-05}}, "connector_pipeline_timer": 0.338634048432143}, "num_module_steps_trained_lifetime": 284160, "num_trainable_parameters": 445130, "num_env_steps_trained_lifetime": 3145740, "learner_connector_sum_episodes_length_out": 2834.0, "learner_connector_sum_episodes_length_in": 2834.0, "num_env_steps_trained": 629148, "num_module_steps_trained": 56832, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 35051.30512812015, "num_module_steps_trained_lifetime_throughput": 3166.2430958236096}, "exo_policy": {"module_train_batch_size_mean": 128.0, "num_module_steps_trained_lifetime": 142080, "total_loss": 7.538620948791504, "curr_entropy_coeff": 0.0, "vf_loss": 7.552006721496582, "default_optimizer_learning_rate": 0.0005, "vf_loss_unclipped": 316.5356140136719, "curr_kl_coeff": 0.45000001788139343, "weights_seq_no": 5.0, "num_module_steps_trained": 28416, "mean_kl_loss": 0.019000403583049774, "entropy": 3.192920684814453, "vf_explained_var": 0.4944767951965332, "num_trainable_parameters": 135429, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.021935924887657166, "num_module_steps_trained_lifetime_throughput": 1583.1210490244323}, "human_policy": {"num_trainable_parameters": 309701, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.12024667859077454, "num_module_steps_trained_lifetime": 142080, "total_loss": 6.211833953857422, "vf_explained_var": 0.5209776759147644, "curr_entropy_coeff": 0.0, "vf_loss": 6.270405292510986, "default_optimizer_learning_rate": 0.0005, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 181.5281219482422, "curr_kl_coeff": 1.5187500715255737, "weights_seq_no": 5.0, "num_module_steps_trained": 28416, "mean_kl_loss": 0.06091345474123955, "entropy": 138.9290771484375, "num_module_steps_trained_lifetime_throughput": 1583.121755695817}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 14170, "fault_tolerance": {"num_healthy_workers": 1, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 1}, "done": false, "training_iteration": 5, "trial_id": "f23a0_00001", "date": "2025-11-20_15-04-37", "timestamp": 1763622277, "time_this_iter_s": 16.723987340927124, "time_total_s": 86.64386296272278, "pid": 26353, "hostname": "CS-ubuntu", "node_ip": "10.207.136.136", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MARL_EXO_ENV", "env_config": {"render_mode": "human", "render_bool": false, "frame_skip": 2, "model_path": "/home/chenshuo/PycharmProjects/move_sim/SMPL/data/xml/mj_fullbody_with_exo_carrying_policy_test.xml", "n_stacks": 1, "human_obs_keys": ["qpos", "local_body_pos", "local_body_vel", "local_body_rot_obs", "local_body_angle_vel"], "exo_obs_keys": ["exo_joint_t", "exo_joint_vel_t"], "weighted_reward_keys": {"w_pos_err": 0.5, "w_proprio_err": 0.4, "w_activation": 0.4, "w_exo_energy": 0.2, "w_exo_smooth": 0.2, "theta_pos_err": 0.5, "theta_proprio_err": 0.3, "theta_activation": 0.3, "theta_exo_energy": 0.1, "theta_exo_smooth": 4}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 2, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 120, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 128, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f9444778af0>", "policies_to_train": ["human_policy", "exo_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"human_policy": [null, "Box(-inf, inf, (248,), float32)", "Box(0.0, 1.0, (98,), float32)", {"model": {"custom_model": "human_model"}}], "exo_policy": [null, "Box(-10.0, 10.0, (4,), float32)", "Box(-0.261799, 2.0944, (2,), float32)", {"model": {"custom_model": "exo_model"}}]}, "callbacks": "<class 'SMPL.src.Custom_CallBack.RewardLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 86.64386296272278, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 17.70909090909091, "ram_util_percent": 63.281818181818174, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.001953125}}
{"timers": {"training_iteration": 17.35263421695328, "restore_env_runners": 4.475717612312352e-05, "training_step": 17.352248297264484, "env_runner_sampling_timer": 14.02452102346119, "learner_update_timer": 3.3236669697814003, "synch_weights": 0.00328276879569581, "synch_env_connectors": 0.0018367315561452794}, "env_runners": {"num_module_steps_sampled": {"exo_policy": 2834, "human_policy": 2834}, "env_to_module_sum_episodes_length_out": 2621.831824891575, "custom": {"human": {"R_p_mean": 0.22003612826008342, "R_a_mean": 0.0001562219277429525, "R_proprio_mean": 0.11592138370382916}, "exo": {"R_t_mean": 0.03172122624129138, "R_eas_mean": 0.018553210276337734}}, "module_episode_returns_mean": {"exo_policy": 547.5120374699566, "human_policy": 476.27316092447586}, "timers": {"connectors": {"batch_individual_items": 4.784105441161973e-05, "numpy_to_tensor": 0.0001019027162055904, "agent_to_module_mapping": 8.546302677037924e-06, "add_states_from_episodes_to_batch": 8.787143023388438e-06, "add_time_dim_to_batch_and_zero_pad": 2.136128251285235e-05, "add_observations_from_episodes_to_batch": 5.910414732269351e-05}}, "env_to_module_connector": {"connector_pipeline_timer": 0.00030053484780832754, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.990174697271328e-05, "add_observations_from_episodes_to_batch": 4.201844440635328e-05, "batch_individual_items": 4.3601592758031087e-05, "numpy_to_tensor": 9.172350150213721e-05, "agent_to_module_mapping": 8.511376294826372e-06, "add_states_from_episodes_to_batch": 8.02344830672168e-06}}}, "agent_steps": {"exo": 1417.0, "human": 1417.0}, "episode_len_min": 1417, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 8.270797338326327e-05, "module_to_agent_unmapping": 5.900478543367951e-06, "get_actions": 0.0003240438434114075, "listify_data_for_vector_env": 1.9064279209391853e-05, "normalize_and_clip_actions": 0.0001695835874434908, "remove_single_ts_time_rank_from_batch": 2.559299400757387e-06, "un_batch_to_individual_items": 4.703823859764267e-05}}, "connector_pipeline_timer": 0.0007587480312230676}, "num_module_steps_sampled_lifetime": {"exo_policy": 17004, "human_policy": 17004}, "episode_len_max": 1417, "num_env_steps_sampled": 2834, "num_episodes": 2, "sample": 13.996543833814837, "env_to_module_sum_episodes_length_in": 2621.831824891575, "weights_seq_no": 5.0, "num_agent_steps_sampled": {"exo": 2834, "human": 2834}, "num_agent_steps_sampled_lifetime": {"exo": 17004, "human": 17004}, "agent_episode_returns_mean": {"human": 476.27316092447586, "exo": 547.5120374699566}, "episode_return_max": 1036.111596828179, "num_env_steps_sampled_lifetime": 17004, "env_reset_timer": 0.04567489505238301, "num_episodes_lifetime": 12, "episode_return_min": 1016.5481602780822, "rlmodule_inference_timer": 0.0004939718748184274, "episode_duration_sec_mean": 13.93043649850002, "env_step_timer": 0.005339527762900153, "connector_pipeline_timer": 0.0005591356015464046, "episode_return_mean": 1023.7851983944325, "episode_len_mean": 1417.0, "time_between_sampling": 3.3849270354931336, "num_env_steps_sampled_lifetime_throughput": 160.03105881849703}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.20800874523823212, "general_advantage_estimation": 0.025741708625422372, "add_time_dim_to_batch_and_zero_pad": 3.54673971983474e-05, "numpy_to_tensor": 0.0003093490366055758, "add_one_ts_to_episodes_and_truncate": 0.009791241840018885, "add_columns_from_episodes_to_train_batch": 0.08792125087065632, "agent_to_module_mapping": 0.00436965492492265, "add_states_from_episodes_to_batch": 9.813535094819608e-06, "add_observations_from_episodes_to_batch": 9.302610592420121e-05}}, "connector_pipeline_timer": 0.3370008250778231}, "num_module_steps_trained_lifetime": 340992, "num_trainable_parameters": 445130, "num_env_steps_trained_lifetime": 3774888, "learner_connector_sum_episodes_length_out": 2834.0, "learner_connector_sum_episodes_length_in": 2834.0, "num_env_steps_trained": 629148, "num_module_steps_trained": 56832, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 35174.05725849149, "num_module_steps_trained_lifetime_throughput": 3177.3315655869696}, "exo_policy": {"module_train_batch_size_mean": 128.0, "num_module_steps_trained_lifetime": 170496, "total_loss": 7.127123832702637, "curr_entropy_coeff": 0.0, "vf_loss": 7.170539379119873, "default_optimizer_learning_rate": 0.0005, "vf_loss_unclipped": 229.20204162597656, "curr_kl_coeff": 0.45000001788139343, "weights_seq_no": 6.0, "num_module_steps_trained": 28416, "mean_kl_loss": 0.01456092856824398, "entropy": 3.271559000015259, "vf_explained_var": 0.5333540439605713, "num_trainable_parameters": 135429, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.0499674454331398, "num_module_steps_trained_lifetime_throughput": 1588.6654131705645}, "human_policy": {"num_trainable_parameters": 309701, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.19039863348007202, "num_module_steps_trained_lifetime": 170496, "total_loss": 5.856836318969727, "vf_explained_var": 0.7774454355239868, "curr_entropy_coeff": 0.0, "vf_loss": 5.980856895446777, "default_optimizer_learning_rate": 0.0005, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 63.75105285644531, "curr_kl_coeff": 2.278125047683716, "weights_seq_no": 6.0, "num_module_steps_trained": 28416, "mean_kl_loss": 0.043706201016902924, "entropy": 139.23353576660156, "num_module_steps_trained_lifetime_throughput": 1588.6659927864728}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 17004, "fault_tolerance": {"num_healthy_workers": 1, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 1}, "done": false, "training_iteration": 6, "trial_id": "f23a0_00001", "date": "2025-11-20_15-04-53", "timestamp": 1763622293, "time_this_iter_s": 16.742323875427246, "time_total_s": 103.38618683815002, "pid": 26353, "hostname": "CS-ubuntu", "node_ip": "10.207.136.136", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MARL_EXO_ENV", "env_config": {"render_mode": "human", "render_bool": false, "frame_skip": 2, "model_path": "/home/chenshuo/PycharmProjects/move_sim/SMPL/data/xml/mj_fullbody_with_exo_carrying_policy_test.xml", "n_stacks": 1, "human_obs_keys": ["qpos", "local_body_pos", "local_body_vel", "local_body_rot_obs", "local_body_angle_vel"], "exo_obs_keys": ["exo_joint_t", "exo_joint_vel_t"], "weighted_reward_keys": {"w_pos_err": 0.5, "w_proprio_err": 0.4, "w_activation": 0.4, "w_exo_energy": 0.2, "w_exo_smooth": 0.2, "theta_pos_err": 0.5, "theta_proprio_err": 0.3, "theta_activation": 0.3, "theta_exo_energy": 0.1, "theta_exo_smooth": 4}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 2, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 120, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 128, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f94448bbb50>", "policies_to_train": ["human_policy", "exo_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"human_policy": [null, "Box(-inf, inf, (248,), float32)", "Box(0.0, 1.0, (98,), float32)", {"model": {"custom_model": "human_model"}}], "exo_policy": [null, "Box(-10.0, 10.0, (4,), float32)", "Box(-0.261799, 2.0944, (2,), float32)", {"model": {"custom_model": "exo_model"}}]}, "callbacks": "<class 'SMPL.src.Custom_CallBack.RewardLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 103.38618683815002, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 17.654545454545453, "ram_util_percent": 62.104545454545445, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.001953125}}
{"timers": {"training_iteration": 17.346030198293743, "restore_env_runners": 4.448623436297088e-05, "training_step": 17.34564392966184, "env_runner_sampling_timer": 14.021831900526578, "learner_update_timer": 3.319757551293588, "synch_weights": 0.003275171877740906, "synch_env_connectors": 0.001838994630583323}, "env_runners": {"num_module_steps_sampled": {"exo_policy": 2834, "human_policy": 2834}, "env_to_module_sum_episodes_length_out": 2621.831824891575, "custom": {"human": {"R_p_mean": 0.22014112421368623, "R_a_mean": 0.00015783246444944885, "R_proprio_mean": 0.11563098306965455}, "exo": {"R_t_mean": 0.03150941790205601, "R_eas_mean": 0.01875943369428493}}, "module_episode_returns_mean": {"exo_policy": 547.243687334634, "human_policy": 476.01272462261875}, "timers": {"connectors": {"batch_individual_items": 4.788613386793604e-05, "numpy_to_tensor": 0.00010198425904382424, "agent_to_module_mapping": 8.564339649380955e-06, "add_states_from_episodes_to_batch": 8.787431593059301e-06, "add_time_dim_to_batch_and_zero_pad": 2.1403949687754355e-05, "add_observations_from_episodes_to_batch": 5.915431585097065e-05}}, "env_to_module_connector": {"connector_pipeline_timer": 0.00030435507628987076, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.0346001100886124e-05, "add_observations_from_episodes_to_batch": 4.2114426595991723e-05, "batch_individual_items": 4.451709311541454e-05, "numpy_to_tensor": 9.302786843631704e-05, "agent_to_module_mapping": 8.803613531470452e-06, "add_states_from_episodes_to_batch": 8.075261249808096e-06}}}, "agent_steps": {"exo": 1417.0, "human": 1417.0}, "episode_len_min": 1417, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 8.276289177695499e-05, "module_to_agent_unmapping": 6.060855352638037e-06, "get_actions": 0.0003236971504170349, "listify_data_for_vector_env": 1.93692564288494e-05, "normalize_and_clip_actions": 0.0001704162991566092, "remove_single_ts_time_rank_from_batch": 2.517566612680191e-06, "un_batch_to_individual_items": 4.723572036967956e-05}}, "connector_pipeline_timer": 0.000760357616760038}, "num_module_steps_sampled_lifetime": {"exo_policy": 19838, "human_policy": 19838}, "episode_len_max": 1417, "num_env_steps_sampled": 2834, "num_episodes": 2, "sample": 13.993926600656689, "env_to_module_sum_episodes_length_in": 2621.831824891575, "weights_seq_no": 6.0, "num_agent_steps_sampled": {"exo": 2834, "human": 2834}, "num_agent_steps_sampled_lifetime": {"exo": 19838, "human": 19838}, "agent_episode_returns_mean": {"human": 476.01272462261875, "exo": 547.243687334634}, "episode_return_max": 1036.111596828179, "num_env_steps_sampled_lifetime": 19838, "env_reset_timer": 0.04559394363185963, "num_episodes_lifetime": 14, "episode_return_min": 1016.5481602780822, "rlmodule_inference_timer": 0.0004940234299496816, "episode_duration_sec_mean": 13.889698500428576, "env_step_timer": 0.0053517947629338975, "connector_pipeline_timer": 0.0005572036455303189, "episode_return_mean": 1023.2564119572529, "episode_len_mean": 1417.0, "time_between_sampling": 3.381993574568203, "num_env_steps_sampled_lifetime_throughput": 160.45057790773777}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.20643250477584985, "general_advantage_estimation": 0.02574007165916911, "add_time_dim_to_batch_and_zero_pad": 3.5409083225447434e-05, "numpy_to_tensor": 0.0003084316462366066, "add_one_ts_to_episodes_and_truncate": 0.009744877301621243, "add_columns_from_episodes_to_train_batch": 0.08784318445194768, "agent_to_module_mapping": 0.004368739835670483, "add_states_from_episodes_to_batch": 9.8016697410263e-06, "add_observations_from_episodes_to_batch": 9.284035486314431e-05}}, "connector_pipeline_timer": 0.33529309980704564}, "num_module_steps_trained_lifetime": 397824, "num_trainable_parameters": 445130, "num_env_steps_trained_lifetime": 4404036, "learner_connector_sum_episodes_length_out": 2834.0, "learner_connector_sum_episodes_length_in": 2834.0, "num_env_steps_trained": 629148, "num_module_steps_trained": 56832, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 35296.97860039248, "num_module_steps_trained_lifetime_throughput": 3188.43669451385}, "exo_policy": {"module_train_batch_size_mean": 128.0, "num_module_steps_trained_lifetime": 198912, "total_loss": 7.630920886993408, "curr_entropy_coeff": 0.0, "vf_loss": 7.789119720458984, "default_optimizer_learning_rate": 0.0005, "vf_loss_unclipped": 205.6380157470703, "curr_kl_coeff": 0.45000001788139343, "weights_seq_no": 7.0, "num_module_steps_trained": 28416, "mean_kl_loss": 0.01452717836946249, "entropy": 3.1970083713531494, "vf_explained_var": 0.4668562412261963, "num_trainable_parameters": 135429, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.16473697125911713, "num_module_steps_trained_lifetime_throughput": 1594.2189135898661}, "human_policy": {"num_trainable_parameters": 309701, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.02783750370144844, "num_module_steps_trained_lifetime": 198912, "total_loss": 5.672680377960205, "vf_explained_var": 0.6060014963150024, "curr_entropy_coeff": 0.0, "vf_loss": 5.582610130310059, "default_optimizer_learning_rate": 0.0005, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 87.58935546875, "curr_kl_coeff": 3.4171876907348633, "weights_seq_no": 7.0, "num_module_steps_trained": 28416, "mean_kl_loss": 0.02731768786907196, "entropy": 138.89251708984375, "num_module_steps_trained_lifetime_throughput": 1594.2187964104157}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 19838, "fault_tolerance": {"num_healthy_workers": 1, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 1}, "done": true, "training_iteration": 7, "trial_id": "f23a0_00001", "date": "2025-11-20_15-05-10", "timestamp": 1763622310, "time_this_iter_s": 16.697896242141724, "time_total_s": 120.08408308029175, "pid": 26353, "hostname": "CS-ubuntu", "node_ip": "10.207.136.136", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MARL_EXO_ENV", "env_config": {"render_mode": "human", "render_bool": false, "frame_skip": 2, "model_path": "/home/chenshuo/PycharmProjects/move_sim/SMPL/data/xml/mj_fullbody_with_exo_carrying_policy_test.xml", "n_stacks": 1, "human_obs_keys": ["qpos", "local_body_pos", "local_body_vel", "local_body_rot_obs", "local_body_angle_vel"], "exo_obs_keys": ["exo_joint_t", "exo_joint_vel_t"], "weighted_reward_keys": {"w_pos_err": 0.5, "w_proprio_err": 0.4, "w_activation": 0.4, "w_exo_energy": 0.2, "w_exo_smooth": 0.2, "theta_pos_err": 0.5, "theta_proprio_err": 0.3, "theta_activation": 0.3, "theta_exo_energy": 0.1, "theta_exo_smooth": 4}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 2, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 120, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 128, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f94448c8040>", "policies_to_train": ["human_policy", "exo_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"human_policy": [null, "Box(-inf, inf, (248,), float32)", "Box(0.0, 1.0, (98,), float32)", {"model": {"custom_model": "human_model"}}], "exo_policy": [null, "Box(-10.0, 10.0, (4,), float32)", "Box(-0.261799, 2.0944, (2,), float32)", {"model": {"custom_model": "exo_model"}}]}, "callbacks": "<class 'SMPL.src.Custom_CallBack.RewardLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 120.08408308029175, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 17.830434782608698, "ram_util_percent": 62.36086956521739, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.001953125}}
