{"timers": {"training_iteration": 18.606478143000004, "restore_env_runners": 2.6849999812839087e-05, "training_step": 18.606185314000413, "env_runner_sampling_timer": 15.318758171999889, "learner_update_timer": 3.283433051999964, "synch_weights": 0.0032402560000264202}, "env_runners": {"num_episodes_lifetime": 2, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 4.746881537259527e-05, "normalize_and_clip_actions": 0.00016946186007371064, "get_actions": 0.0003139087758881607, "module_to_agent_unmapping": 6.499868817230145e-06, "remove_single_ts_time_rank_from_batch": 2.4731980101388444e-06, "listify_data_for_vector_env": 1.92605336808209e-05, "tensor_to_numpy": 7.949195800219996e-05}}, "connector_pipeline_timer": 0.0007440207161774573}, "timers": {"connectors": {"numpy_to_tensor": 0.0003622089998316369, "add_time_dim_to_batch_and_zero_pad": 5.595499987975927e-05, "agent_to_module_mapping": 1.6201000107685104e-05, "add_states_from_episodes_to_batch": 1.0480000128154643e-05, "add_observations_from_episodes_to_batch": 0.00010567899971647421, "batch_individual_items": 0.00011835199984489009}}, "env_to_module_connector": {"connector_pipeline_timer": 0.00029273043488353413, "timers": {"connectors": {"add_states_from_episodes_to_batch": 7.654070041552407e-06, "add_observations_from_episodes_to_batch": 4.227544361219046e-05, "batch_individual_items": 4.4815635431785074e-05, "numpy_to_tensor": 8.62457294512957e-05, "add_time_dim_to_batch_and_zero_pad": 1.9007792819993195e-05, "agent_to_module_mapping": 9.081142429846681e-06}}}, "agent_steps": {"human": 1417.0, "exo": 1417.0}, "num_env_steps_sampled": 2834, "num_module_steps_sampled": {"exo_policy": 2834, "human_policy": 2834}, "custom": {"human": {"R_p_mean": 0.1766746282678882, "R_a_mean": 0.008439434789463404, "R_proprio_mean": 0.1142506942327802}, "exo": {"R_t_mean": 0.03300543415453413, "R_eas_mean": 0.01709534237099087}}, "agent_episode_returns_mean": {"human": 424.1998610801171, "exo": 495.19266141678577}, "module_episode_returns_mean": {"human_policy": 424.1998610801171, "exo_policy": 495.19266141678577}, "episode_return_min": 909.8378326905893, "env_reset_timer": 0.05436145600015152, "num_module_steps_sampled_lifetime": {"human_policy": 2834, "exo_policy": 2834}, "env_to_module_sum_episodes_length_in": 2621.8301293409154, "episode_len_mean": 1417.0, "sample": 15.29271477400016, "num_episodes": 2, "weights_seq_no": 0.0, "episode_len_max": 1417, "num_agent_steps_sampled_lifetime": {"human": 2834, "exo": 2834}, "episode_return_mean": 919.3925224969029, "num_agent_steps_sampled": {"human": 2834, "exo": 2834}, "episode_duration_sec_mean": 15.1853826104998, "rlmodule_inference_timer": 0.0004704009354337603, "episode_return_max": 928.9472123032165, "episode_len_min": 1417, "env_to_module_sum_episodes_length_out": 2621.8301293409154, "num_env_steps_sampled_lifetime": 2834, "env_step_timer": 0.005313208237147312, "connector_pipeline_timer": 0.001218325000081677, "num_env_steps_sampled_lifetime_throughput": NaN}, "learners": {"exo_policy": {"curr_kl_coeff": 0.30000001192092896, "vf_explained_var": 0.22397810220718384, "policy_loss": 0.06361296027898788, "num_module_steps_trained_lifetime": 28416, "entropy": 2.8063714504241943, "curr_entropy_coeff": 0.0, "total_loss": 9.94093132019043, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 128.0, "num_module_steps_trained": 28416, "vf_loss": 9.870491027832031, "vf_loss_unclipped": 1044.4725341796875, "mean_kl_loss": 0.03413470461964607, "num_trainable_parameters": 135429, "default_optimizer_learning_rate": 0.0005, "weights_seq_no": 1.0, "num_module_steps_trained_lifetime_throughput": NaN}, "__all_modules__": {"num_env_steps_trained_lifetime": 629148, "num_trainable_parameters": 445130, "learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.02525167199974021, "numpy_to_tensor": 0.0003113630000370904, "add_observations_from_episodes_to_batch": 7.294700026250212e-05, "add_states_from_episodes_to_batch": 9.837999641604256e-06, "agent_to_module_mapping": 0.004667383000196423, "batch_individual_items": 0.2151853340001253, "add_time_dim_to_batch_and_zero_pad": 3.0698000045958906e-05, "add_columns_from_episodes_to_train_batch": 0.08152271400012978, "add_one_ts_to_episodes_and_truncate": 0.006435597999825404}}, "connector_pipeline_timer": 0.334105025000099}, "num_module_steps_trained": 56832, "num_non_trainable_parameters": 0, "num_env_steps_trained": 629148, "learner_connector_sum_episodes_length_out": 2834, "num_module_steps_trained_lifetime": 56832, "learner_connector_sum_episodes_length_in": 2834, "num_env_steps_trained_lifetime_throughput": NaN, "num_module_steps_trained_lifetime_throughput": NaN}, "human_policy": {"policy_loss": -0.07379516959190369, "num_module_steps_trained_lifetime": 28416, "total_loss": 7.418731212615967, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 139.33895874023438, "vf_loss_unclipped": 341.79876708984375, "curr_entropy_coeff": 0.0, "num_trainable_parameters": 309701, "default_optimizer_learning_rate": 0.0005, "module_train_batch_size_mean": 128.0, "num_module_steps_trained": 28416, "vf_loss": 7.445915222167969, "weights_seq_no": 1.0, "mean_kl_loss": 0.23305882513523102, "vf_explained_var": 0.2795138955116272, "curr_kl_coeff": 0.30000001192092896, "num_module_steps_trained_lifetime_throughput": NaN}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 2834, "fault_tolerance": {"num_healthy_workers": 1, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 1}, "done": false, "training_iteration": 1, "trial_id": "89bba_00000", "date": "2025-11-20_15-29-11", "timestamp": 1763623751, "time_this_iter_s": 18.612069368362427, "time_total_s": 18.612069368362427, "pid": 35676, "hostname": "CS-ubuntu", "node_ip": "10.207.136.136", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MARL_EXO_ENV", "env_config": {"render_mode": "human", "render_bool": false, "frame_skip": 2, "model_path": "/home/chenshuo/PycharmProjects/move_sim/SMPL/data/xml/mj_fullbody_with_exo_carrying_policy_test.xml", "n_stacks": 1, "human_obs_keys": ["qpos", "local_body_pos", "local_body_vel", "local_body_rot_obs", "local_body_angle_vel"], "exo_obs_keys": ["exo_joint_t", "exo_joint_vel_t"], "weighted_reward_keys": {"w_pos_err": 0.4, "w_proprio_err": 0.4, "w_activation": 0.4, "w_exo_energy": 0.2, "w_exo_smooth": 0.2, "theta_pos_err": 0.5, "theta_proprio_err": 0.3, "theta_activation": 0.1, "theta_exo_energy": 0.1, "theta_exo_smooth": 4}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 2, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 120, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 128, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f093060fac0>", "policies_to_train": ["human_policy", "exo_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"human_policy": [null, "Box(-inf, inf, (248,), float32)", "Box(0.0, 1.0, (98,), float32)", {"model": {"custom_model": "human_model"}}], "exo_policy": [null, "Box(-10.0, 10.0, (4,), float32)", "Box(-0.261799, 2.0944, (2,), float32)", {"model": {"custom_model": "exo_model"}}]}, "callbacks": "<class 'SMPL.src.Custom_CallBack.RewardLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 18.612069368362427, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 19.64, "ram_util_percent": 65.2, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.001337890625}}
{"timers": {"training_iteration": 18.588821854250003, "restore_env_runners": 2.6811529814949608e-05, "training_step": 18.588527455100408, "env_runner_sampling_timer": 15.304801508849891, "learner_update_timer": 3.2797398196799623, "synch_weights": 0.0032313378900289532, "synch_env_connectors": 0.001676513000347768}, "env_runners": {"num_episodes_lifetime": 4, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 4.7839536370031215e-05, "normalize_and_clip_actions": 0.00017157399757847887, "get_actions": 0.00032246124284535105, "module_to_agent_unmapping": 5.875222725995063e-06, "remove_single_ts_time_rank_from_batch": 2.4475482712595696e-06, "listify_data_for_vector_env": 1.9154428264290083e-05, "tensor_to_numpy": 8.045261979220158e-05}}, "connector_pipeline_timer": 0.0007567546647141962}, "timers": {"connectors": {"numpy_to_tensor": 0.0003599272198334802, "add_time_dim_to_batch_and_zero_pad": 5.560693987717968e-05, "agent_to_module_mapping": 1.612135010873317e-05, "add_states_from_episodes_to_batch": 1.045254012751684e-05, "add_observations_from_episodes_to_batch": 0.00010519237971493567, "batch_individual_items": 0.00011760519984818529}}, "env_to_module_connector": {"connector_pipeline_timer": 0.0002961603237678201, "timers": {"connectors": {"add_states_from_episodes_to_batch": 7.5942423949961416e-06, "add_observations_from_episodes_to_batch": 4.2465722790953304e-05, "batch_individual_items": 4.4751036785732384e-05, "numpy_to_tensor": 8.892571480595261e-05, "add_time_dim_to_batch_and_zero_pad": 1.830734156565139e-05, "agent_to_module_mapping": 8.883089540796125e-06}}}, "agent_steps": {"human": 1417.0, "exo": 1417.0}, "num_env_steps_sampled": 2834, "num_module_steps_sampled": {"exo_policy": 2834, "human_policy": 2834}, "custom": {"human": {"R_p_mean": 0.1764584166385598, "R_a_mean": 0.008451309820506545, "R_proprio_mean": 0.11474901381303138}, "exo": {"R_t_mean": 0.03487055499066799, "R_eas_mean": 0.017464680228922027}}, "agent_episode_returns_mean": {"human": 424.6164349655627, "exo": 498.77546327172183}, "module_episode_returns_mean": {"human_policy": 424.6164349655627, "exo_policy": 498.77546327172183}, "episode_return_min": 909.8378326905893, "env_reset_timer": 0.05419070916014789, "num_module_steps_sampled_lifetime": {"human_policy": 5668, "exo_policy": 5668}, "env_to_module_sum_episodes_length_in": 2621.8318248904784, "episode_len_mean": 1417.0, "sample": 15.278822179380159, "num_episodes": 2, "weights_seq_no": 1.0, "episode_len_max": 1417, "num_agent_steps_sampled_lifetime": {"human": 5668, "exo": 5668}, "episode_return_mean": 923.3918982372845, "num_agent_steps_sampled": {"human": 2834, "exo": 2834}, "episode_duration_sec_mean": 14.50101001649989, "rlmodule_inference_timer": 0.0004847850258275628, "episode_return_max": 938.264206623605, "episode_len_min": 1417, "env_to_module_sum_episodes_length_out": 2621.8318248904784, "num_env_steps_sampled_lifetime": 5668, "env_step_timer": 0.005358329985403292, "connector_pipeline_timer": 0.0012097514200786464, "time_between_sampling": 3.340811811000094, "num_env_steps_sampled_lifetime_throughput": NaN}, "learners": {"exo_policy": {"curr_kl_coeff": 0.45000001788139343, "vf_explained_var": -0.1903388500213623, "policy_loss": 0.036404095590114594, "num_module_steps_trained_lifetime": 56832, "entropy": 2.8438942432403564, "curr_entropy_coeff": 0.0, "total_loss": 9.059976577758789, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 128.0, "num_module_steps_trained": 28416, "vf_loss": 9.013483047485352, "vf_loss_unclipped": 1102.5244140625, "mean_kl_loss": 0.03362737223505974, "num_trainable_parameters": 135429, "default_optimizer_learning_rate": 0.0005, "weights_seq_no": 2.0, "num_module_steps_trained_lifetime_throughput": NaN}, "__all_modules__": {"num_env_steps_trained_lifetime": 1258296, "num_trainable_parameters": 445130, "learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.02525472074974459, "numpy_to_tensor": 0.0003104347700400467, "add_observations_from_episodes_to_batch": 7.311721025871521e-05, "add_states_from_episodes_to_batch": 9.839609642767755e-06, "agent_to_module_mapping": 0.004664549390195134, "batch_individual_items": 0.21356215811012588, "add_time_dim_to_batch_and_zero_pad": 3.081231004671281e-05, "add_columns_from_episodes_to_train_batch": 0.0815361506801264, "add_one_ts_to_episodes_and_truncate": 0.006423277099829648}}, "connector_pipeline_timer": 0.3324797443700982}, "num_module_steps_trained": 56832, "num_non_trainable_parameters": 0, "num_env_steps_trained": 629148, "learner_connector_sum_episodes_length_out": 2834.0, "num_module_steps_trained_lifetime": 113664, "learner_connector_sum_episodes_length_in": 2834.0, "num_env_steps_trained_lifetime_throughput": NaN, "num_module_steps_trained_lifetime_throughput": NaN}, "human_policy": {"policy_loss": -0.17780494689941406, "num_module_steps_trained_lifetime": 56832, "total_loss": 7.422793865203857, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 139.0283203125, "vf_loss_unclipped": 231.39341735839844, "curr_entropy_coeff": 0.0, "num_trainable_parameters": 309701, "default_optimizer_learning_rate": 0.0005, "module_train_batch_size_mean": 128.0, "num_module_steps_trained": 28416, "vf_loss": 7.566530227661133, "weights_seq_no": 2.0, "mean_kl_loss": 0.11356246471405029, "vf_explained_var": 0.4119083285331726, "curr_kl_coeff": 0.45000001788139343, "num_module_steps_trained_lifetime_throughput": NaN}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 5668, "fault_tolerance": {"num_healthy_workers": 1, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 1}, "done": false, "training_iteration": 2, "trial_id": "89bba_00000", "date": "2025-11-20_15-29-28", "timestamp": 1763623768, "time_this_iter_s": 16.84664297103882, "time_total_s": 35.458712339401245, "pid": 35676, "hostname": "CS-ubuntu", "node_ip": "10.207.136.136", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MARL_EXO_ENV", "env_config": {"render_mode": "human", "render_bool": false, "frame_skip": 2, "model_path": "/home/chenshuo/PycharmProjects/move_sim/SMPL/data/xml/mj_fullbody_with_exo_carrying_policy_test.xml", "n_stacks": 1, "human_obs_keys": ["qpos", "local_body_pos", "local_body_vel", "local_body_rot_obs", "local_body_angle_vel"], "exo_obs_keys": ["exo_joint_t", "exo_joint_vel_t"], "weighted_reward_keys": {"w_pos_err": 0.4, "w_proprio_err": 0.4, "w_activation": 0.4, "w_exo_energy": 0.2, "w_exo_smooth": 0.2, "theta_pos_err": 0.5, "theta_proprio_err": 0.3, "theta_activation": 0.1, "theta_exo_energy": 0.1, "theta_exo_smooth": 4}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 2, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 120, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 128, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f09306395a0>", "policies_to_train": ["human_policy", "exo_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"human_policy": [null, "Box(-inf, inf, (248,), float32)", "Box(0.0, 1.0, (98,), float32)", {"model": {"custom_model": "human_model"}}], "exo_policy": [null, "Box(-10.0, 10.0, (4,), float32)", "Box(-0.261799, 2.0944, (2,), float32)", {"model": {"custom_model": "exo_model"}}]}, "callbacks": "<class 'SMPL.src.Custom_CallBack.RewardLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 35.458712339401245, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 17.954545454545453, "ram_util_percent": 65.95909090909092, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.001953125}}
{"timers": {"training_iteration": 18.569244166837503, "restore_env_runners": 2.6733164515553652e-05, "training_step": 18.568948498479404, "env_runner_sampling_timer": 15.288719267781392, "learner_update_timer": 3.276248901413164, "synch_weights": 0.003224791541125705, "synch_env_connectors": 0.0016823849203410645}, "env_runners": {"num_episodes_lifetime": 6, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 4.683088355505817e-05, "normalize_and_clip_actions": 0.0001679526220251196, "get_actions": 0.00031034288515177335, "module_to_agent_unmapping": 6.048675896630567e-06, "remove_single_ts_time_rank_from_batch": 2.4820212403405556e-06, "listify_data_for_vector_env": 1.8949504251168813e-05, "tensor_to_numpy": 7.968817104555898e-05}}, "connector_pipeline_timer": 0.0007368641589039251}, "timers": {"connectors": {"numpy_to_tensor": 0.00035759712763265274, "add_time_dim_to_batch_and_zero_pad": 5.5512840476876586e-05, "agent_to_module_mapping": 1.612945660872356e-05, "add_states_from_episodes_to_batch": 1.0440284728156258e-05, "add_observations_from_episodes_to_batch": 0.00010477424591817907, "batch_individual_items": 0.00011720599784694059}}, "env_to_module_connector": {"connector_pipeline_timer": 0.0002950577908176463, "timers": {"connectors": {"add_states_from_episodes_to_batch": 7.503428985646314e-06, "add_observations_from_episodes_to_batch": 4.3073446014131165e-05, "batch_individual_items": 4.442586328306524e-05, "numpy_to_tensor": 8.704277503324683e-05, "add_time_dim_to_batch_and_zero_pad": 1.9444420034499287e-05, "agent_to_module_mapping": 8.953717425908073e-06}}}, "agent_steps": {"human": 1417.0, "exo": 1417.0}, "num_env_steps_sampled": 2834, "num_module_steps_sampled": {"exo_policy": 2834, "human_policy": 2834}, "custom": {"human": {"R_p_mean": 0.17658542632319285, "R_a_mean": 0.008442142278178631, "R_proprio_mean": 0.11421064299445298}, "exo": {"R_t_mean": 0.03415713187176646, "R_eas_mean": 0.017179132476645428}}, "agent_episode_returns_mean": {"human": 424.02054583128347, "exo": 496.764032412983}, "module_episode_returns_mean": {"human_policy": 424.02054583128347, "exo_policy": 496.764032412983}, "episode_return_min": 909.8116052160215, "env_reset_timer": 0.054023310198544915, "num_module_steps_sampled_lifetime": {"human_policy": 8502, "exo_policy": 8502}, "env_to_module_sum_episodes_length_in": 2621.831824891575, "episode_len_mean": 1417.0, "sample": 15.262807692156358, "num_episodes": 2, "weights_seq_no": 2.0, "episode_len_max": 1417, "num_agent_steps_sampled_lifetime": {"human": 8502, "exo": 8502}, "episode_return_mean": 920.7845782442664, "num_agent_steps_sampled": {"human": 2834, "exo": 2834}, "episode_duration_sec_mean": 14.196534245666575, "rlmodule_inference_timer": 0.00048399377423555674, "episode_return_max": 938.264206623605, "episode_len_min": 1417, "env_to_module_sum_episodes_length_out": 2621.831824891575, "num_env_steps_sampled_lifetime": 8502, "env_step_timer": 0.005310772070440289, "connector_pipeline_timer": 0.0012021722858790325, "time_between_sampling": 3.337350967350094, "num_env_steps_sampled_lifetime_throughput": 169.9844609940551}, "learners": {"exo_policy": {"curr_kl_coeff": 0.675000011920929, "vf_explained_var": 0.08308136463165283, "policy_loss": 0.042824357748031616, "num_module_steps_trained_lifetime": 85248, "entropy": 2.941746711730957, "curr_entropy_coeff": 0.0, "total_loss": 8.012985229492188, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 128.0, "num_module_steps_trained": 28416, "vf_loss": 7.957396030426025, "vf_loss_unclipped": 636.4015502929688, "mean_kl_loss": 0.028367197141051292, "num_trainable_parameters": 135429, "default_optimizer_learning_rate": 0.0005, "weights_seq_no": 3.0, "num_module_steps_trained_lifetime_throughput": 1702.7163508246533}, "__all_modules__": {"num_env_steps_trained_lifetime": 1887444, "num_trainable_parameters": 445130, "learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.025261296802249672, "numpy_to_tensor": 0.0003095592023435074, "add_observations_from_episodes_to_batch": 7.307402815631576e-05, "add_states_from_episodes_to_batch": 9.836793545082401e-06, "agent_to_module_mapping": 0.004663636966294188, "batch_individual_items": 0.21194035624902408, "add_time_dim_to_batch_and_zero_pad": 3.076617694500782e-05, "add_columns_from_episodes_to_train_batch": 0.08151247471332321, "add_one_ts_to_episodes_and_truncate": 0.0064020777288288635}}, "connector_pipeline_timer": 0.33081468391639723}, "num_module_steps_trained": 56832, "num_non_trainable_parameters": 0, "num_env_steps_trained": 629148, "learner_connector_sum_episodes_length_out": 2834.0, "num_module_steps_trained_lifetime": 170496, "learner_connector_sum_episodes_length_in": 2834.0, "num_env_steps_trained_lifetime_throughput": 37699.26995257855, "num_module_steps_trained_lifetime_throughput": 3405.41068954242}, "human_policy": {"policy_loss": -0.038916170597076416, "num_module_steps_trained_lifetime": 85248, "total_loss": 5.922214031219482, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 139.4193878173828, "vf_loss_unclipped": 120.15641021728516, "curr_entropy_coeff": 0.0, "num_trainable_parameters": 309701, "default_optimizer_learning_rate": 0.0005, "module_train_batch_size_mean": 128.0, "num_module_steps_trained": 28416, "vf_loss": 5.900022983551025, "weights_seq_no": 3.0, "mean_kl_loss": 0.1357942819595337, "vf_explained_var": 0.5776467323303223, "curr_kl_coeff": 0.675000011920929, "num_module_steps_trained_lifetime_throughput": 1702.7176040421396}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 8502, "fault_tolerance": {"num_healthy_workers": 1, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 1}, "done": false, "training_iteration": 3, "trial_id": "89bba_00000", "date": "2025-11-20_15-29-45", "timestamp": 1763623785, "time_this_iter_s": 16.63764214515686, "time_total_s": 52.096354484558105, "pid": 35676, "hostname": "CS-ubuntu", "node_ip": "10.207.136.136", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MARL_EXO_ENV", "env_config": {"render_mode": "human", "render_bool": false, "frame_skip": 2, "model_path": "/home/chenshuo/PycharmProjects/move_sim/SMPL/data/xml/mj_fullbody_with_exo_carrying_policy_test.xml", "n_stacks": 1, "human_obs_keys": ["qpos", "local_body_pos", "local_body_vel", "local_body_rot_obs", "local_body_angle_vel"], "exo_obs_keys": ["exo_joint_t", "exo_joint_vel_t"], "weighted_reward_keys": {"w_pos_err": 0.4, "w_proprio_err": 0.4, "w_activation": 0.4, "w_exo_energy": 0.2, "w_exo_smooth": 0.2, "theta_pos_err": 0.5, "theta_proprio_err": 0.3, "theta_activation": 0.1, "theta_exo_energy": 0.1, "theta_exo_smooth": 4}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 2, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 120, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 128, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f093063acb0>", "policies_to_train": ["human_policy", "exo_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"human_policy": [null, "Box(-inf, inf, (248,), float32)", "Box(0.0, 1.0, (98,), float32)", {"model": {"custom_model": "human_model"}}], "exo_policy": [null, "Box(-10.0, 10.0, (4,), float32)", "Box(-0.261799, 2.0944, (2,), float32)", {"model": {"custom_model": "exo_model"}}]}, "callbacks": "<class 'SMPL.src.Custom_CallBack.RewardLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 52.096354484558105, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 18.086956521739125, "ram_util_percent": 65.94347826086958, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.001953125}}
{"timers": {"training_iteration": 18.551388228259125, "restore_env_runners": 2.6668412869893472e-05, "training_step": 18.551090700044607, "env_runner_sampling_timer": 15.272912754093579, "learner_update_timer": 3.2741909233590314, "synch_weights": 0.0032300252257120386, "synch_env_connectors": 0.0016849601511347827}, "env_runners": {"num_episodes_lifetime": 8, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 4.6224275802969516e-05, "normalize_and_clip_actions": 0.00016543571132195554, "get_actions": 0.00032060503795645657, "module_to_agent_unmapping": 5.790315479925402e-06, "remove_single_ts_time_rank_from_batch": 2.4306099628057384e-06, "listify_data_for_vector_env": 1.851512386047878e-05, "tensor_to_numpy": 7.863148845688394e-05}}, "connector_pipeline_timer": 0.0007416901955213216}, "timers": {"connectors": {"numpy_to_tensor": 0.00035485832635684893, "add_time_dim_to_batch_and_zero_pad": 5.516229207318974e-05, "agent_to_module_mapping": 1.605141204444408e-05, "add_states_from_episodes_to_batch": 1.0407911878556662e-05, "add_observations_from_episodes_to_batch": 0.00010426240345779206, "batch_individual_items": 0.00011648347786651538}}, "env_to_module_connector": {"connector_pipeline_timer": 0.0002875696480124595, "timers": {"connectors": {"add_states_from_episodes_to_batch": 7.300686241644154e-06, "add_observations_from_episodes_to_batch": 4.096353530814429e-05, "batch_individual_items": 4.314335157274816e-05, "numpy_to_tensor": 8.75779578687364e-05, "add_time_dim_to_batch_and_zero_pad": 1.7886370604336795e-05, "agent_to_module_mapping": 8.67503366465448e-06}}}, "agent_steps": {"human": 1417.0, "exo": 1417.0}, "num_env_steps_sampled": 2834, "num_module_steps_sampled": {"exo_policy": 2834, "human_policy": 2834}, "custom": {"human": {"R_p_mean": 0.17667916735194336, "R_a_mean": 0.008435334763048426, "R_proprio_mean": 0.11395428205149122}, "exo": {"R_t_mean": 0.034155497521003005, "R_eas_mean": 0.017044480420018528}}, "agent_episode_returns_mean": {"human": 423.78046716390645, "exo": 496.33083590633396}, "module_episode_returns_mean": {"human_policy": 423.78046716390645, "exo_policy": 496.33083590633396}, "episode_return_min": 909.8116052160215, "env_reset_timer": 0.05385924767656197, "num_module_steps_sampled_lifetime": {"human_policy": 11336, "exo_policy": 11336}, "env_to_module_sum_episodes_length_in": 2621.831824891575, "episode_len_mean": 1417.0, "sample": 15.247070591944794, "num_episodes": 2, "weights_seq_no": 3.0, "episode_len_max": 1417, "num_agent_steps_sampled_lifetime": {"human": 11336, "exo": 11336}, "episode_return_mean": 920.1113030702404, "num_agent_steps_sampled": {"human": 2834, "exo": 2834}, "episode_duration_sec_mean": 14.047743185749937, "rlmodule_inference_timer": 0.000491392859605994, "episode_return_max": 938.264206623605, "episode_len_min": 1417, "env_to_module_sum_episodes_length_out": 2621.831824891575, "num_env_steps_sampled_lifetime": 11336, "env_step_timer": 0.005207350904576558, "connector_pipeline_timer": 0.00119320278301976, "time_between_sampling": 3.3337712761765954, "num_env_steps_sampled_lifetime_throughput": 169.98645466842711}, "learners": {"exo_policy": {"curr_kl_coeff": 0.675000011920929, "vf_explained_var": 0.05622720718383789, "policy_loss": -0.12933509051799774, "num_module_steps_trained_lifetime": 113664, "entropy": 2.8562686443328857, "curr_entropy_coeff": 0.0, "total_loss": 8.379717826843262, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 128.0, "num_module_steps_trained": 28416, "vf_loss": 8.496927261352539, "vf_loss_unclipped": 666.8433837890625, "mean_kl_loss": 0.01796400547027588, "num_trainable_parameters": 135429, "default_optimizer_learning_rate": 0.0005, "weights_seq_no": 4.0, "num_module_steps_trained_lifetime_throughput": 1702.1120600407753}, "__all_modules__": {"num_env_steps_trained_lifetime": 2516592, "num_trainable_parameters": 445130, "learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.025244550894227776, "numpy_to_tensor": 0.00030834994031659556, "add_observations_from_episodes_to_batch": 7.301173787239987e-05, "add_states_from_episodes_to_batch": 9.830705611440409e-06, "agent_to_module_mapping": 0.004663123096633886, "batch_individual_items": 0.21196246839653385, "add_time_dim_to_batch_and_zero_pad": 3.0732625173475295e-05, "add_columns_from_episodes_to_train_batch": 0.08152732818618923, "add_one_ts_to_episodes_and_truncate": 0.0063833585115438555}}, "connector_pipeline_timer": 0.33081118262723036}, "num_module_steps_trained": 56832, "num_non_trainable_parameters": 0, "num_env_steps_trained": 629148, "learner_connector_sum_episodes_length_out": 2834.0, "num_module_steps_trained_lifetime": 227328, "learner_connector_sum_episodes_length_in": 2834.0, "num_env_steps_trained_lifetime_throughput": 37685.88748030602, "num_module_steps_trained_lifetime_throughput": 3404.2036050277984}, "human_policy": {"policy_loss": -0.18811088800430298, "num_module_steps_trained_lifetime": 113664, "total_loss": 5.432114124298096, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 139.41476440429688, "vf_loss_unclipped": 132.47607421875, "curr_entropy_coeff": 0.0, "num_trainable_parameters": 309701, "default_optimizer_learning_rate": 0.0005, "module_train_batch_size_mean": 128.0, "num_module_steps_trained": 28416, "vf_loss": 5.5666961669921875, "weights_seq_no": 4.0, "mean_kl_loss": 0.07930166274309158, "vf_explained_var": 0.5878287553787231, "curr_kl_coeff": 1.0125000476837158, "num_module_steps_trained_lifetime_throughput": 1702.1132514523624}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 11336, "fault_tolerance": {"num_healthy_workers": 1, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 1}, "done": false, "training_iteration": 4, "trial_id": "89bba_00000", "date": "2025-11-20_15-30-02", "timestamp": 1763623802, "time_this_iter_s": 16.79080820083618, "time_total_s": 68.88716268539429, "pid": 35676, "hostname": "CS-ubuntu", "node_ip": "10.207.136.136", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MARL_EXO_ENV", "env_config": {"render_mode": "human", "render_bool": false, "frame_skip": 2, "model_path": "/home/chenshuo/PycharmProjects/move_sim/SMPL/data/xml/mj_fullbody_with_exo_carrying_policy_test.xml", "n_stacks": 1, "human_obs_keys": ["qpos", "local_body_pos", "local_body_vel", "local_body_rot_obs", "local_body_angle_vel"], "exo_obs_keys": ["exo_joint_t", "exo_joint_vel_t"], "weighted_reward_keys": {"w_pos_err": 0.4, "w_proprio_err": 0.4, "w_activation": 0.4, "w_exo_energy": 0.2, "w_exo_smooth": 0.2, "theta_pos_err": 0.5, "theta_proprio_err": 0.3, "theta_activation": 0.1, "theta_exo_energy": 0.1, "theta_exo_smooth": 4}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 2, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 120, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 128, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f09307723b0>", "policies_to_train": ["human_policy", "exo_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"human_policy": [null, "Box(-inf, inf, (248,), float32)", "Box(0.0, 1.0, (98,), float32)", {"model": {"custom_model": "human_model"}}], "exo_policy": [null, "Box(-10.0, 10.0, (4,), float32)", "Box(-0.261799, 2.0944, (2,), float32)", {"model": {"custom_model": "exo_model"}}]}, "callbacks": "<class 'SMPL.src.Custom_CallBack.RewardLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 68.88716268539429, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 17.036363636363635, "ram_util_percent": 66.02727272727272, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.001953125}}
{"timers": {"training_iteration": 18.532249640236532, "restore_env_runners": 2.6610818740056137e-05, "training_step": 18.531950656594162, "env_runner_sampling_timer": 15.257124532822646, "learner_update_timer": 3.270842758465441, "synch_weights": 0.0032259524134527814, "synch_env_connectors": 0.0016954023396208693}, "env_runners": {"num_episodes_lifetime": 10, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 4.643097556412216e-05, "normalize_and_clip_actions": 0.00016706310612401621, "get_actions": 0.00031489458175340085, "module_to_agent_unmapping": 5.774482107585143e-06, "remove_single_ts_time_rank_from_batch": 2.358631996124585e-06, "listify_data_for_vector_env": 1.863336403353738e-05, "tensor_to_numpy": 7.891421242548398e-05}}, "connector_pipeline_timer": 0.0007380959890248821}, "timers": {"connectors": {"numpy_to_tensor": 0.0003525943530958658, "add_time_dim_to_batch_and_zero_pad": 5.483187915502232e-05, "agent_to_module_mapping": 1.598056792157795e-05, "add_states_from_episodes_to_batch": 1.0392702756714781e-05, "add_observations_from_episodes_to_batch": 0.0001038257194270935, "batch_individual_items": 0.00011584462308696108}}, "env_to_module_connector": {"connector_pipeline_timer": 0.0002885765561029178, "timers": {"connectors": {"add_states_from_episodes_to_batch": 7.388550355539587e-06, "add_observations_from_episodes_to_batch": 4.1947041045538675e-05, "batch_individual_items": 4.342173992155853e-05, "numpy_to_tensor": 8.63431824204898e-05, "add_time_dim_to_batch_and_zero_pad": 1.8335206263162806e-05, "agent_to_module_mapping": 8.758137903480529e-06}}}, "agent_steps": {"human": 1417.0, "exo": 1417.0}, "num_env_steps_sampled": 2834, "num_module_steps_sampled": {"exo_policy": 2834, "human_policy": 2834}, "custom": {"human": {"R_p_mean": 0.17671559017836044, "R_a_mean": 0.008451026962410266, "R_proprio_mean": 0.11396820508733478}, "exo": {"R_t_mean": 0.03378018523408812, "R_eas_mean": 0.017263988108560717}}, "agent_episode_returns_mean": {"human": 423.8740430972254, "exo": 496.2036367237589}, "module_episode_returns_mean": {"human_policy": 423.8740430972254, "exo_policy": 496.2036367237589}, "episode_return_min": 909.8116052160215, "env_reset_timer": 0.053708841939797754, "num_module_steps_sampled_lifetime": {"human_policy": 14170, "exo_policy": 14170}, "env_to_module_sum_episodes_length_in": 2621.831824891575, "episode_len_mean": 1417.0, "sample": 15.231348345445346, "num_episodes": 2, "weights_seq_no": 4.0, "episode_len_max": 1417, "num_agent_steps_sampled_lifetime": {"human": 14170, "exo": 14170}, "episode_return_mean": 920.0776798209843, "num_agent_steps_sampled": {"human": 2834, "exo": 2834}, "episode_duration_sec_mean": 13.95520179569994, "rlmodule_inference_timer": 0.00047804518891635106, "episode_return_max": 938.264206623605, "episode_len_min": 1417, "env_to_module_sum_episodes_length_out": 2621.831824891575, "num_env_steps_sampled_lifetime": 14170, "env_step_timer": 0.005244546965913546, "connector_pipeline_timer": 0.0011851105551910772, "time_between_sampling": 3.331652548464829, "num_env_steps_sampled_lifetime_throughput": 169.92311620874068}, "learners": {"exo_policy": {"curr_kl_coeff": 1.0125000476837158, "vf_explained_var": 0.08250689506530762, "policy_loss": 0.08161605149507523, "num_module_steps_trained_lifetime": 142080, "entropy": 2.8869309425354004, "curr_entropy_coeff": 0.0, "total_loss": 7.661404609680176, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 128.0, "num_module_steps_trained": 28416, "vf_loss": 7.563784599304199, "vf_loss_unclipped": 588.25732421875, "mean_kl_loss": 0.0237093735486269, "num_trainable_parameters": 135429, "default_optimizer_learning_rate": 0.0005, "weights_seq_no": 5.0, "num_module_steps_trained_lifetime_throughput": 1702.257264349526}, "__all_modules__": {"num_env_steps_trained_lifetime": 3145740, "num_trainable_parameters": 445130, "learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.02524548682528311, "numpy_to_tensor": 0.00030718143091609004, "add_observations_from_episodes_to_batch": 7.295528049534244e-05, "add_states_from_episodes_to_batch": 9.813948556922048e-06, "agent_to_module_mapping": 0.004659058795664157, "batch_individual_items": 0.21034858557257027, "add_time_dim_to_batch_and_zero_pad": 3.067826892494333e-05, "add_columns_from_episodes_to_train_batch": 0.08149338323432662, "add_one_ts_to_episodes_and_truncate": 0.006363006176428203}}, "connector_pipeline_timer": 0.3291351052909567}, "num_module_steps_trained": 56832, "num_non_trainable_parameters": 0, "num_env_steps_trained": 629148, "learner_connector_sum_episodes_length_out": 2834.0, "num_module_steps_trained_lifetime": 284160, "learner_connector_sum_episodes_length_in": 2834.0, "num_env_steps_trained_lifetime_throughput": 37689.097444179635, "num_module_steps_trained_lifetime_throughput": 3404.4958402094153}, "human_policy": {"policy_loss": -0.16798950731754303, "num_module_steps_trained_lifetime": 142080, "total_loss": 5.588840007781982, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 139.43011474609375, "vf_loss_unclipped": 58.20079803466797, "curr_entropy_coeff": 0.0, "num_trainable_parameters": 309701, "default_optimizer_learning_rate": 0.0005, "module_train_batch_size_mean": 128.0, "num_module_steps_trained": 28416, "vf_loss": 5.69090461730957, "weights_seq_no": 5.0, "mean_kl_loss": 0.06511107087135315, "vf_explained_var": 0.7085193395614624, "curr_kl_coeff": 1.5187500715255737, "num_module_steps_trained_lifetime_throughput": 1702.2583696988324}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 14170, "fault_tolerance": {"num_healthy_workers": 1, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 1}, "done": false, "training_iteration": 5, "trial_id": "89bba_00000", "date": "2025-11-20_15-30-18", "timestamp": 1763623818, "time_this_iter_s": 16.64330267906189, "time_total_s": 85.53046536445618, "pid": 35676, "hostname": "CS-ubuntu", "node_ip": "10.207.136.136", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MARL_EXO_ENV", "env_config": {"render_mode": "human", "render_bool": false, "frame_skip": 2, "model_path": "/home/chenshuo/PycharmProjects/move_sim/SMPL/data/xml/mj_fullbody_with_exo_carrying_policy_test.xml", "n_stacks": 1, "human_obs_keys": ["qpos", "local_body_pos", "local_body_vel", "local_body_rot_obs", "local_body_angle_vel"], "exo_obs_keys": ["exo_joint_t", "exo_joint_vel_t"], "weighted_reward_keys": {"w_pos_err": 0.4, "w_proprio_err": 0.4, "w_activation": 0.4, "w_exo_energy": 0.2, "w_exo_smooth": 0.2, "theta_pos_err": 0.5, "theta_proprio_err": 0.3, "theta_activation": 0.1, "theta_exo_energy": 0.1, "theta_exo_smooth": 4}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 2, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 120, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 128, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f09304d6950>", "policies_to_train": ["human_policy", "exo_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"human_policy": [null, "Box(-inf, inf, (248,), float32)", "Box(0.0, 1.0, (98,), float32)", {"model": {"custom_model": "human_model"}}], "exo_policy": [null, "Box(-10.0, 10.0, (4,), float32)", "Box(-0.261799, 2.0944, (2,), float32)", {"model": {"custom_model": "exo_model"}}]}, "callbacks": "<class 'SMPL.src.Custom_CallBack.RewardLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 85.53046536445618, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 17.80909090909091, "ram_util_percent": 65.96363636363637, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.001953125}}
{"timers": {"training_iteration": 18.51338073907417, "restore_env_runners": 2.6597980552685746e-05, "training_step": 18.513078489338223, "env_runner_sampling_timer": 15.241844839334417, "learner_update_timer": 3.267249710060785, "synch_weights": 0.003219046749319159, "synch_env_connectors": 0.0016987178362251716}, "env_runners": {"num_episodes_lifetime": 12, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 4.7055070117541604e-05, "normalize_and_clip_actions": 0.00016700427123616705, "get_actions": 0.0003151080517662944, "module_to_agent_unmapping": 5.931763729957566e-06, "remove_single_ts_time_rank_from_batch": 2.5249247123910404e-06, "listify_data_for_vector_env": 1.8648874881162198e-05, "tensor_to_numpy": 7.961234931581162e-05}}, "connector_pipeline_timer": 0.0007403914486679442}, "timers": {"connectors": {"numpy_to_tensor": 0.00034997219956575513, "add_time_dim_to_batch_and_zero_pad": 5.4503370367199715e-05, "agent_to_module_mapping": 1.5915942245334653e-05, "add_states_from_episodes_to_batch": 1.036732572609009e-05, "add_observations_from_episodes_to_batch": 0.00010340712223257911, "batch_individual_items": 0.00011514312685762647}}, "env_to_module_connector": {"connector_pipeline_timer": 0.00028997387120158294, "timers": {"connectors": {"add_states_from_episodes_to_batch": 7.319786468677275e-06, "add_observations_from_episodes_to_batch": 4.2322428645389995e-05, "batch_individual_items": 4.370080239751652e-05, "numpy_to_tensor": 8.637852765726092e-05, "add_time_dim_to_batch_and_zero_pad": 1.8622807666395985e-05, "agent_to_module_mapping": 8.775169604818735e-06}}}, "agent_steps": {"human": 1417.0, "exo": 1417.0}, "num_env_steps_sampled": 2834, "num_module_steps_sampled": {"exo_policy": 2834, "human_policy": 2834}, "custom": {"human": {"R_p_mean": 0.17665287872063937, "R_a_mean": 0.008471822365628608, "R_proprio_mean": 0.11418483950254098}, "exo": {"R_t_mean": 0.03360272047367354, "R_eas_mean": 0.01761696519955266}}, "agent_episode_returns_mean": {"human": 424.12161901434206, "exo": 496.69991361330375}, "module_episode_returns_mean": {"human_policy": 424.12161901434206, "exo_policy": 496.69991361330375}, "episode_return_min": 909.8116052160215, "env_reset_timer": 0.05355314426039878, "num_module_steps_sampled_lifetime": {"human_policy": 17004, "exo_policy": 17004}, "env_to_module_sum_episodes_length_in": 2621.831824891575, "episode_len_mean": 1417.0, "sample": 15.21613662354089, "num_episodes": 2, "weights_seq_no": 5.0, "episode_len_max": 1417, "num_agent_steps_sampled_lifetime": {"human": 17004, "exo": 17004}, "episode_return_mean": 920.8215326276459, "num_agent_steps_sampled": {"human": 2834, "exo": 2834}, "episode_duration_sec_mean": 13.898554275416624, "rlmodule_inference_timer": 0.0004819707867188335, "episode_return_max": 938.264206623605, "episode_len_min": 1417, "env_to_module_sum_episodes_length_out": 2621.831824891575, "num_env_steps_sampled_lifetime": 17004, "env_step_timer": 0.0052762168605044405, "connector_pipeline_timer": 0.0011766055196370268, "time_between_sampling": 3.3282065096901823, "num_env_steps_sampled_lifetime_throughput": 169.91331825981774}, "learners": {"exo_policy": {"curr_kl_coeff": 1.0125000476837158, "vf_explained_var": 0.034367382526397705, "policy_loss": -0.13816578686237335, "num_module_steps_trained_lifetime": 170496, "entropy": 2.8303160667419434, "curr_entropy_coeff": 0.0, "total_loss": 8.2050142288208, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 128.0, "num_module_steps_trained": 28416, "vf_loss": 8.333625793457031, "vf_loss_unclipped": 724.1720581054688, "mean_kl_loss": 0.00943686068058014, "num_trainable_parameters": 135429, "default_optimizer_learning_rate": 0.0005, "weights_seq_no": 6.0, "num_module_steps_trained_lifetime_throughput": 1702.3782891345}, "__all_modules__": {"num_env_steps_trained_lifetime": 3774888, "num_trainable_parameters": 445130, "learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.025241626427029543, "numpy_to_tensor": 0.0003061865066072823, "add_observations_from_episodes_to_batch": 7.295719769005313e-05, "add_states_from_episodes_to_batch": 9.805279071046218e-06, "agent_to_module_mapping": 0.004656872407710161, "batch_individual_items": 0.2087598184568453, "add_time_dim_to_batch_and_zero_pad": 3.0640196236148924e-05, "add_columns_from_episodes_to_train_batch": 0.08145458185198401, "add_one_ts_to_episodes_and_truncate": 0.006344320614659757}}, "connector_pipeline_timer": 0.32747874800804594}, "num_module_steps_trained": 56832, "num_non_trainable_parameters": 0, "num_env_steps_trained": 629148, "learner_connector_sum_episodes_length_out": 2834.0, "num_module_steps_trained_lifetime": 340992, "learner_connector_sum_episodes_length_in": 2834.0, "num_env_steps_trained_lifetime_throughput": 37691.77389212541, "num_module_steps_trained_lifetime_throughput": 3404.738542754061}, "human_policy": {"policy_loss": -0.10491234809160233, "num_module_steps_trained_lifetime": 170496, "total_loss": 5.646613121032715, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 139.36849975585938, "vf_loss_unclipped": 62.46815872192383, "curr_entropy_coeff": 0.0, "num_trainable_parameters": 309701, "default_optimizer_learning_rate": 0.0005, "module_train_batch_size_mean": 128.0, "num_module_steps_trained": 28416, "vf_loss": 5.693615913391113, "weights_seq_no": 6.0, "mean_kl_loss": 0.038129426538944244, "vf_explained_var": 0.6922041177749634, "curr_kl_coeff": 2.278125047683716, "num_module_steps_trained_lifetime_throughput": 1702.3793318380147}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 17004, "fault_tolerance": {"num_healthy_workers": 1, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 1}, "done": false, "training_iteration": 6, "trial_id": "89bba_00000", "date": "2025-11-20_15-30-35", "timestamp": 1763623835, "time_this_iter_s": 16.652311325073242, "time_total_s": 102.18277668952942, "pid": 35676, "hostname": "CS-ubuntu", "node_ip": "10.207.136.136", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MARL_EXO_ENV", "env_config": {"render_mode": "human", "render_bool": false, "frame_skip": 2, "model_path": "/home/chenshuo/PycharmProjects/move_sim/SMPL/data/xml/mj_fullbody_with_exo_carrying_policy_test.xml", "n_stacks": 1, "human_obs_keys": ["qpos", "local_body_pos", "local_body_vel", "local_body_rot_obs", "local_body_angle_vel"], "exo_obs_keys": ["exo_joint_t", "exo_joint_vel_t"], "weighted_reward_keys": {"w_pos_err": 0.4, "w_proprio_err": 0.4, "w_activation": 0.4, "w_exo_energy": 0.2, "w_exo_smooth": 0.2, "theta_pos_err": 0.5, "theta_proprio_err": 0.3, "theta_activation": 0.1, "theta_exo_energy": 0.1, "theta_exo_smooth": 4}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 2, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 120, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 128, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f093063af80>", "policies_to_train": ["human_policy", "exo_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"human_policy": [null, "Box(-inf, inf, (248,), float32)", "Box(0.0, 1.0, (98,), float32)", {"model": {"custom_model": "human_model"}}], "exo_policy": [null, "Box(-10.0, 10.0, (4,), float32)", "Box(-0.261799, 2.0944, (2,), float32)", {"model": {"custom_model": "exo_model"}}]}, "callbacks": "<class 'SMPL.src.Custom_CallBack.RewardLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 102.18277668952942, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 17.486363636363635, "ram_util_percent": 64.80909090909091, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.001953125}}
{"timers": {"training_iteration": 18.498554249413427, "restore_env_runners": 2.6517240743585278e-05, "training_step": 18.49825062522484, "env_runner_sampling_timer": 15.23035967632107, "learner_update_timer": 3.26391150196018, "synch_weights": 0.0032130497118247514, "synch_env_connectors": 0.001700256607862377}, "env_runners": {"num_episodes_lifetime": 14, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 4.7368461282015716e-05, "normalize_and_clip_actions": 0.00016862721086128267, "get_actions": 0.0003206371589554886, "module_to_agent_unmapping": 5.95481484529125e-06, "remove_single_ts_time_rank_from_batch": 2.4619858227000167e-06, "listify_data_for_vector_env": 1.8651699090673054e-05, "tensor_to_numpy": 7.987575532705697e-05}}, "connector_pipeline_timer": 0.0007483898879546138}, "timers": {"connectors": {"numpy_to_tensor": 0.00034751773757096235, "add_time_dim_to_batch_and_zero_pad": 5.418486666440074e-05, "agent_to_module_mapping": 1.5844142822151427e-05, "add_states_from_episodes_to_batch": 1.0350522468733781e-05, "add_observations_from_episodes_to_batch": 0.00010297909100852768, "batch_individual_items": 0.00011464411558796462}}, "env_to_module_connector": {"connector_pipeline_timer": 0.0002984260536837169, "timers": {"connectors": {"add_states_from_episodes_to_batch": 7.438291490327813e-06, "add_observations_from_episodes_to_batch": 4.310366201773644e-05, "batch_individual_items": 4.394624520254606e-05, "numpy_to_tensor": 9.059496518033372e-05, "add_time_dim_to_batch_and_zero_pad": 1.9262054952269917e-05, "agent_to_module_mapping": 8.920770072026395e-06}}}, "agent_steps": {"human": 1417.0, "exo": 1417.0}, "num_env_steps_sampled": 2834, "num_module_steps_sampled": {"exo_policy": 2834, "human_policy": 2834}, "custom": {"human": {"R_p_mean": 0.17663843789381417, "R_a_mean": 0.008507607646730905, "R_proprio_mean": 0.11420540895766843}, "exo": {"R_t_mean": 0.03438954058501974, "R_eas_mean": 0.017738786096346142}}, "agent_episode_returns_mean": {"human": 424.1810110239684, "exo": 498.04684993146384}, "module_episode_returns_mean": {"human_policy": 424.1810110239684, "exo_policy": 498.04684993146384}, "episode_return_min": 909.8116052160215, "env_reset_timer": 0.053529606947796564, "num_module_steps_sampled_lifetime": {"human_policy": 19838, "exo_policy": 19838}, "env_to_module_sum_episodes_length_in": 2621.831824891575, "episode_len_mean": 1417.0, "sample": 15.20470883228548, "num_episodes": 2, "weights_seq_no": 6.0, "episode_len_max": 1417, "num_agent_steps_sampled_lifetime": {"human": 19838, "exo": 19838}, "episode_return_mean": 922.2278609554323, "num_agent_steps_sampled": {"human": 2834, "exo": 2834}, "episode_duration_sec_mean": 13.909159616999952, "rlmodule_inference_timer": 0.000491973191383857, "episode_return_max": 938.264206623605, "episode_len_min": 1417, "env_to_module_sum_episodes_length_out": 2621.831824891575, "num_env_steps_sampled_lifetime": 19838, "env_step_timer": 0.005347474765592047, "connector_pipeline_timer": 0.001168642794441321, "time_between_sampling": 3.324535317953278, "num_env_steps_sampled_lifetime_throughput": 169.7357482849107}, "learners": {"exo_policy": {"curr_kl_coeff": 1.0125000476837158, "vf_explained_var": -0.009144067764282227, "policy_loss": -0.020195137709379196, "num_module_steps_trained_lifetime": 198912, "entropy": 2.931544542312622, "curr_entropy_coeff": 0.0, "total_loss": 7.42417049407959, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 128.0, "num_module_steps_trained": 28416, "vf_loss": 7.437870979309082, "vf_loss_unclipped": 756.946044921875, "mean_kl_loss": 0.0064147463999688625, "num_trainable_parameters": 135429, "default_optimizer_learning_rate": 0.0005, "weights_seq_no": 7.0, "num_module_steps_trained_lifetime_throughput": 1700.5553121432556}, "__all_modules__": {"num_env_steps_trained_lifetime": 4404036, "num_trainable_parameters": 445130, "learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.025253514622761014, "numpy_to_tensor": 0.0003049260115403665, "add_observations_from_episodes_to_batch": 7.289808571228066e-05, "add_states_from_episodes_to_batch": 9.79949628225034e-06, "agent_to_module_mapping": 0.0046528774336348526, "batch_individual_items": 0.20716673945227843, "add_time_dim_to_batch_and_zero_pad": 3.060179427265605e-05, "add_columns_from_episodes_to_train_batch": 0.08143510095346254, "add_one_ts_to_episodes_and_truncate": 0.006323624188513175}}, "connector_pipeline_timer": 0.32584859791796533}, "num_module_steps_trained": 56832, "num_non_trainable_parameters": 0, "num_env_steps_trained": 629148, "learner_connector_sum_episodes_length_out": 2834.0, "num_module_steps_trained_lifetime": 397824, "learner_connector_sum_episodes_length_in": 2834.0, "num_env_steps_trained_lifetime_throughput": 37651.41020884554, "num_module_steps_trained_lifetime_throughput": 3401.0938208846624}, "human_policy": {"policy_loss": -0.031125806272029877, "num_module_steps_trained_lifetime": 198912, "total_loss": 3.713909149169922, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 139.3749542236328, "vf_loss_unclipped": 78.77849578857422, "curr_entropy_coeff": 0.0, "num_trainable_parameters": 309701, "default_optimizer_learning_rate": 0.0005, "module_train_batch_size_mean": 128.0, "num_module_steps_trained": 28416, "vf_loss": 3.679490089416504, "weights_seq_no": 7.0, "mean_kl_loss": 0.02877144329249859, "vf_explained_var": 0.6113816499710083, "curr_kl_coeff": 3.4171876907348633, "num_module_steps_trained_lifetime_throughput": 1700.556303248758}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 19838, "fault_tolerance": {"num_healthy_workers": 1, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 1}, "done": true, "training_iteration": 7, "trial_id": "89bba_00000", "date": "2025-11-20_15-30-52", "timestamp": 1763623852, "time_this_iter_s": 17.03641629219055, "time_total_s": 119.21919298171997, "pid": 35676, "hostname": "CS-ubuntu", "node_ip": "10.207.136.136", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MARL_EXO_ENV", "env_config": {"render_mode": "human", "render_bool": false, "frame_skip": 2, "model_path": "/home/chenshuo/PycharmProjects/move_sim/SMPL/data/xml/mj_fullbody_with_exo_carrying_policy_test.xml", "n_stacks": 1, "human_obs_keys": ["qpos", "local_body_pos", "local_body_vel", "local_body_rot_obs", "local_body_angle_vel"], "exo_obs_keys": ["exo_joint_t", "exo_joint_vel_t"], "weighted_reward_keys": {"w_pos_err": 0.4, "w_proprio_err": 0.4, "w_activation": 0.4, "w_exo_energy": 0.2, "w_exo_smooth": 0.2, "theta_pos_err": 0.5, "theta_proprio_err": 0.3, "theta_activation": 0.1, "theta_exo_energy": 0.1, "theta_exo_smooth": 4}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 2, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 120, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 128, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f093060fb50>", "policies_to_train": ["human_policy", "exo_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"human_policy": [null, "Box(-inf, inf, (248,), float32)", "Box(0.0, 1.0, (98,), float32)", {"model": {"custom_model": "human_model"}}], "exo_policy": [null, "Box(-10.0, 10.0, (4,), float32)", "Box(-0.261799, 2.0944, (2,), float32)", {"model": {"custom_model": "exo_model"}}]}, "callbacks": "<class 'SMPL.src.Custom_CallBack.RewardLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 119.21919298171997, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 18.743478260869566, "ram_util_percent": 64.7217391304348, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.001953125}}
