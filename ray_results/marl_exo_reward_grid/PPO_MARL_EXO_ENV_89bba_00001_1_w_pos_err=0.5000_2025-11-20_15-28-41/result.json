{"timers": {"training_iteration": 18.625266079000085, "restore_env_runners": 2.150999989680713e-05, "training_step": 18.624967979999838, "env_runner_sampling_timer": 15.346795251000003, "learner_update_timer": 3.274780787999589, "synch_weights": 0.0027188080002815695}, "env_runners": {"env_to_module_sum_episodes_length_in": 2621.8301293409154, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.1642655904929855e-05, "add_time_dim_to_batch_and_zero_pad": 1.9165059705579992e-05, "agent_to_module_mapping": 8.935736622433998e-06, "numpy_to_tensor": 9.067018904254578e-05, "add_states_from_episodes_to_batch": 7.956139321986592e-06, "batch_individual_items": 4.265693709837025e-05}}, "connector_pipeline_timer": 0.0002963650379110396}, "rlmodule_inference_timer": 0.0004946790758605558, "num_agent_steps_sampled_lifetime": {"human": 2834, "exo": 2834}, "num_module_steps_sampled": {"human_policy": 2834, "exo_policy": 2834}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.0003290904553380336, "remove_single_ts_time_rank_from_batch": 2.583779154748621e-06, "un_batch_to_individual_items": 4.6919526144008464e-05, "listify_data_for_vector_env": 1.927520720754966e-05, "normalize_and_clip_actions": 0.00016877235368830003, "tensor_to_numpy": 8.135121652358918e-05, "module_to_agent_unmapping": 6.195979050795081e-06}}, "connector_pipeline_timer": 0.0007627716610246463}, "num_episodes_lifetime": 2, "num_env_steps_sampled_lifetime": 2834, "num_agent_steps_sampled": {"human": 2834, "exo": 2834}, "custom": {"human": {"R_a_mean": 0.009210967416630474, "R_proprio_mean": 0.11638840228143352, "R_p_mean": 0.22185559503005473}, "exo": {"R_t_mean": 0.030723111268387407, "R_eas_mean": 0.018741117078686937}}, "env_step_timer": 0.005283880444242713, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.2321999949781457e-05, "add_observations_from_episodes_to_batch": 6.311799961622455e-05, "agent_to_module_mapping": 9.267000223189825e-06, "numpy_to_tensor": 0.00010710099968491704, "add_states_from_episodes_to_batch": 8.395999884669436e-06, "batch_individual_items": 5.190799993215478e-05}}, "episode_return_min": 1053.095861738239, "episode_len_mean": 1417.0, "agent_steps": {"human": 1417.0, "exo": 1417.0}, "episode_len_min": 1417, "episode_duration_sec_mean": 15.232135060500013, "sample": 15.319789308999589, "episode_return_mean": 1054.7781816072925, "module_episode_returns_mean": {"human_policy": 492.34368501974404, "exo_policy": 562.4344965875484}, "agent_episode_returns_mean": {"human": 492.34368501974404, "exo": 562.4344965875484}, "num_episodes": 2, "num_env_steps_sampled": 2834, "num_module_steps_sampled_lifetime": {"human_policy": 2834, "exo_policy": 2834}, "episode_len_max": 1417, "episode_return_max": 1056.4605014763463, "env_to_module_sum_episodes_length_out": 2621.8301293409154, "weights_seq_no": 0.0, "connector_pipeline_timer": 0.0005738260001635354, "env_reset_timer": 0.04187162600010197, "num_env_steps_sampled_lifetime_throughput": NaN}, "learners": {"exo_policy": {"policy_loss": -0.0457276776432991, "num_module_steps_trained_lifetime": 28416, "num_trainable_parameters": 135429, "num_module_steps_trained": 28416, "module_train_batch_size_mean": 128.0, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.11279280483722687, "entropy": 3.0004594326019287, "total_loss": 8.597310066223145, "curr_kl_coeff": 0.30000001192092896, "weights_seq_no": 1.0, "vf_loss": 8.62048053741455, "default_optimizer_learning_rate": 0.0005, "vf_explained_var": -0.05551338195800781, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 1085.9356689453125, "num_module_steps_trained_lifetime_throughput": NaN}, "__all_modules__": {"num_module_steps_trained_lifetime": 56832, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.21159348699984548, "general_advantage_estimation": 0.027991802000087773, "add_states_from_episodes_to_batch": 9.647999831940979e-06, "add_columns_from_episodes_to_train_batch": 0.08608933799996521, "add_time_dim_to_batch_and_zero_pad": 3.9633999676880194e-05, "add_observations_from_episodes_to_batch": 7.434899998770561e-05, "numpy_to_tensor": 0.0002829210002346372, "agent_to_module_mapping": 0.004790602999946714, "add_one_ts_to_episodes_and_truncate": 0.007207956999991438}}, "connector_pipeline_timer": 0.33877640699984113}, "learner_connector_sum_episodes_length_in": 2834, "num_trainable_parameters": 445130, "num_env_steps_trained": 629148, "num_non_trainable_parameters": 0, "num_module_steps_trained": 56832, "learner_connector_sum_episodes_length_out": 2834, "num_env_steps_trained_lifetime": 629148, "num_env_steps_trained_lifetime_throughput": NaN, "num_module_steps_trained_lifetime_throughput": NaN}, "human_policy": {"policy_loss": -0.08821389079093933, "num_module_steps_trained_lifetime": 28416, "num_module_steps_trained": 28416, "module_train_batch_size_mean": 128.0, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.21055179834365845, "entropy": 139.17135620117188, "total_loss": 7.192268371582031, "curr_kl_coeff": 0.30000001192092896, "weights_seq_no": 1.0, "vf_loss": 7.2383713722229, "default_optimizer_learning_rate": 0.0005, "vf_explained_var": 0.21372419595718384, "num_trainable_parameters": 309701, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 579.8687133789062, "num_module_steps_trained_lifetime_throughput": NaN}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 2834, "fault_tolerance": {"num_healthy_workers": 1, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 1}, "done": false, "training_iteration": 1, "trial_id": "89bba_00001", "date": "2025-11-20_15-29-11", "timestamp": 1763623751, "time_this_iter_s": 18.630528926849365, "time_total_s": 18.630528926849365, "pid": 35679, "hostname": "CS-ubuntu", "node_ip": "10.207.136.136", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MARL_EXO_ENV", "env_config": {"render_mode": "human", "render_bool": false, "frame_skip": 2, "model_path": "/home/chenshuo/PycharmProjects/move_sim/SMPL/data/xml/mj_fullbody_with_exo_carrying_policy_test.xml", "n_stacks": 1, "human_obs_keys": ["qpos", "local_body_pos", "local_body_vel", "local_body_rot_obs", "local_body_angle_vel"], "exo_obs_keys": ["exo_joint_t", "exo_joint_vel_t"], "weighted_reward_keys": {"w_pos_err": 0.5, "w_proprio_err": 0.4, "w_activation": 0.4, "w_exo_energy": 0.2, "w_exo_smooth": 0.2, "theta_pos_err": 0.5, "theta_proprio_err": 0.3, "theta_activation": 0.1, "theta_exo_energy": 0.1, "theta_exo_smooth": 4}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 2, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 120, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 128, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f09307723b0>", "policies_to_train": ["human_policy", "exo_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"human_policy": [null, "Box(-inf, inf, (248,), float32)", "Box(0.0, 1.0, (98,), float32)", {"model": {"custom_model": "human_model"}}], "exo_policy": [null, "Box(-10.0, 10.0, (4,), float32)", "Box(-0.261799, 2.0944, (2,), float32)", {"model": {"custom_model": "exo_model"}}]}, "callbacks": "<class 'SMPL.src.Custom_CallBack.RewardLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 18.630528926849365, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 19.612000000000002, "ram_util_percent": 65.188, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.001337890625}}
{"timers": {"training_iteration": 18.609138722740088, "restore_env_runners": 2.1540459897551045e-05, "training_step": 18.60883795332984, "env_runner_sampling_timer": 15.333748637520001, "learner_update_timer": 3.271691773919597, "synch_weights": 0.0027180504802754514, "synch_env_connectors": 0.0015640629999325029}, "env_runners": {"env_to_module_sum_episodes_length_in": 2621.8318248904784, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.339568779158375e-05, "add_time_dim_to_batch_and_zero_pad": 1.952157872370971e-05, "agent_to_module_mapping": 8.779479112174903e-06, "numpy_to_tensor": 8.997792813600034e-05, "add_states_from_episodes_to_batch": 7.837150983562529e-06, "batch_individual_items": 4.353760113682165e-05}}, "connector_pipeline_timer": 0.0003008426080995543}, "rlmodule_inference_timer": 0.0004976565420930021, "num_agent_steps_sampled_lifetime": {"human": 5668, "exo": 5668}, "num_module_steps_sampled": {"human_policy": 2834, "exo_policy": 2834}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.0003298495059709054, "remove_single_ts_time_rank_from_batch": 2.4840480495295845e-06, "un_batch_to_individual_items": 4.875577452368103e-05, "listify_data_for_vector_env": 1.9496787374822386e-05, "normalize_and_clip_actions": 0.00017607082402675142, "tensor_to_numpy": 8.329237212722946e-05, "module_to_agent_unmapping": 6.01754248280929e-06}}, "connector_pipeline_timer": 0.0007776869953399237}, "num_episodes_lifetime": 4, "num_env_steps_sampled_lifetime": 5668, "num_agent_steps_sampled": {"human": 2834, "exo": 2834}, "custom": {"human": {"R_a_mean": 0.00918042182689733, "R_proprio_mean": 0.11583762737536966, "R_p_mean": 0.22173984224246102}, "exo": {"R_t_mean": 0.02970151722165496, "R_eas_mean": 0.01894171518278577}}, "env_step_timer": 0.005410610895948642, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.229625994914386e-05, "add_observations_from_episodes_to_batch": 6.304024961991672e-05, "agent_to_module_mapping": 9.25519022075605e-06, "numpy_to_tensor": 0.00010690833968965307, "add_states_from_episodes_to_batch": 8.389289882870799e-06, "batch_individual_items": 5.180359993573802e-05}}, "episode_return_min": 1046.9369851805304, "episode_len_mean": 1417.0, "agent_steps": {"human": 1417.0, "exo": 1417.0}, "episode_len_min": 1417, "episode_duration_sec_mean": 14.585206350750013, "sample": 15.306814095689592, "episode_return_mean": 1051.6393246714517, "module_episode_returns_mean": {"human_policy": 491.3559321771796, "exo_policy": 560.2833924942721}, "agent_episode_returns_mean": {"human": 491.3559321771796, "exo": 560.2833924942721}, "num_episodes": 2, "num_env_steps_sampled": 2834, "num_module_steps_sampled_lifetime": {"human_policy": 5668, "exo_policy": 5668}, "episode_len_max": 1417, "episode_return_max": 1056.4605014763463, "env_to_module_sum_episodes_length_out": 2621.8318248904784, "weights_seq_no": 1.0, "connector_pipeline_timer": 0.0005711180201615207, "env_reset_timer": 0.041807252820099165, "time_between_sampling": 3.3270193179996568, "num_env_steps_sampled_lifetime_throughput": NaN}, "learners": {"exo_policy": {"policy_loss": -0.04464492201805115, "num_module_steps_trained_lifetime": 56832, "num_trainable_parameters": 135429, "num_module_steps_trained": 28416, "module_train_batch_size_mean": 128.0, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.04840308427810669, "entropy": 2.9171340465545654, "total_loss": 8.409528732299805, "curr_kl_coeff": 0.45000001788139343, "weights_seq_no": 2.0, "vf_loss": 8.439653396606445, "default_optimizer_learning_rate": 0.0005, "vf_explained_var": 0.11166459321975708, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 786.3551025390625, "num_module_steps_trained_lifetime_throughput": NaN}, "__all_modules__": {"num_module_steps_trained_lifetime": 113664, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.2099707648598451, "general_advantage_estimation": 0.027955249370083948, "add_states_from_episodes_to_batch": 9.646699832046579e-06, "add_columns_from_episodes_to_train_batch": 0.08602082549996339, "add_time_dim_to_batch_and_zero_pad": 3.956707967972761e-05, "add_observations_from_episodes_to_batch": 7.44514999905732e-05, "numpy_to_tensor": 0.00028201851023368363, "agent_to_module_mapping": 0.004788874869946085, "add_one_ts_to_episodes_and_truncate": 0.007187324009992153}}, "connector_pipeline_timer": 0.3370214570898406}, "learner_connector_sum_episodes_length_in": 2834.0, "num_trainable_parameters": 445130, "num_env_steps_trained": 629148, "num_non_trainable_parameters": 0, "num_module_steps_trained": 56832, "learner_connector_sum_episodes_length_out": 2834.0, "num_env_steps_trained_lifetime": 1258296, "num_env_steps_trained_lifetime_throughput": NaN, "num_module_steps_trained_lifetime_throughput": NaN}, "human_policy": {"policy_loss": -0.04706471785902977, "num_module_steps_trained_lifetime": 56832, "num_module_steps_trained": 28416, "module_train_batch_size_mean": 128.0, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.1585189700126648, "entropy": 139.3866729736328, "total_loss": 6.968524932861328, "curr_kl_coeff": 0.45000001788139343, "weights_seq_no": 2.0, "vf_loss": 6.968033313751221, "default_optimizer_learning_rate": 0.0005, "vf_explained_var": 0.46653568744659424, "num_trainable_parameters": 309701, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 316.7640075683594, "num_module_steps_trained_lifetime_throughput": NaN}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 5668, "fault_tolerance": {"num_healthy_workers": 1, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 1}, "done": false, "training_iteration": 2, "trial_id": "89bba_00001", "date": "2025-11-20_15-29-28", "timestamp": 1763623768, "time_this_iter_s": 17.01814579963684, "time_total_s": 35.648674726486206, "pid": 35679, "hostname": "CS-ubuntu", "node_ip": "10.207.136.136", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MARL_EXO_ENV", "env_config": {"render_mode": "human", "render_bool": false, "frame_skip": 2, "model_path": "/home/chenshuo/PycharmProjects/move_sim/SMPL/data/xml/mj_fullbody_with_exo_carrying_policy_test.xml", "n_stacks": 1, "human_obs_keys": ["qpos", "local_body_pos", "local_body_vel", "local_body_rot_obs", "local_body_angle_vel"], "exo_obs_keys": ["exo_joint_t", "exo_joint_vel_t"], "weighted_reward_keys": {"w_pos_err": 0.5, "w_proprio_err": 0.4, "w_activation": 0.4, "w_exo_energy": 0.2, "w_exo_smooth": 0.2, "theta_pos_err": 0.5, "theta_proprio_err": 0.3, "theta_activation": 0.1, "theta_exo_energy": 0.1, "theta_exo_smooth": 4}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 2, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 120, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 128, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f093060fd90>", "policies_to_train": ["human_policy", "exo_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"human_policy": [null, "Box(-inf, inf, (248,), float32)", "Box(0.0, 1.0, (98,), float32)", {"model": {"custom_model": "human_model"}}], "exo_policy": [null, "Box(-10.0, 10.0, (4,), float32)", "Box(-0.261799, 2.0944, (2,), float32)", {"model": {"custom_model": "exo_model"}}]}, "callbacks": "<class 'SMPL.src.Custom_CallBack.RewardLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 35.648674726486206, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 18.278260869565216, "ram_util_percent": 65.95652173913044, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.001953125}}
{"timers": {"training_iteration": 18.590015881672688, "restore_env_runners": 2.1509205297434164e-05, "training_step": 18.589714095206542, "env_runner_sampling_timer": 15.317985050384797, "learner_update_timer": 3.268336146650402, "synch_weights": 0.0027134941054742286, "synch_env_connectors": 0.0015666790099339778}, "env_runners": {"env_to_module_sum_episodes_length_in": 2621.831824891575, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.202386611339175e-05, "add_time_dim_to_batch_and_zero_pad": 1.840074241659412e-05, "agent_to_module_mapping": 8.305491469104955e-06, "numpy_to_tensor": 8.867020267085624e-05, "add_states_from_episodes_to_batch": 7.6049735961910275e-06, "batch_individual_items": 4.2109182087416433e-05}}, "connector_pipeline_timer": 0.00029201475167147664}, "rlmodule_inference_timer": 0.0004930931186474268, "num_agent_steps_sampled_lifetime": {"human": 8502, "exo": 8502}, "num_module_steps_sampled": {"human_policy": 2834, "exo_policy": 2834}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.00033281378923061494, "remove_single_ts_time_rank_from_batch": 2.460297130142372e-06, "un_batch_to_individual_items": 4.7546248579975426e-05, "listify_data_for_vector_env": 1.9181679518739798e-05, "normalize_and_clip_actions": 0.00017371359145388986, "tensor_to_numpy": 8.240513722374575e-05, "module_to_agent_unmapping": 6.026048079650389e-06}}, "connector_pipeline_timer": 0.0007733453261880693}, "num_episodes_lifetime": 6, "num_env_steps_sampled_lifetime": 8502, "num_agent_steps_sampled": {"human": 2834, "exo": 2834}, "custom": {"human": {"R_a_mean": 0.009145276103743454, "R_proprio_mean": 0.11648685035030411, "R_p_mean": 0.22176390660797315}, "exo": {"R_t_mean": 0.029144198774838082, "R_eas_mean": 0.019440354045991107}}, "env_step_timer": 0.005395066495622228, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.2260647351049556e-05, "add_observations_from_episodes_to_batch": 6.29728971264285e-05, "agent_to_module_mapping": 9.241378318029092e-06, "numpy_to_tensor": 0.00010685435629425228, "add_states_from_episodes_to_batch": 8.379436987752343e-06, "batch_individual_items": 5.171366393833523e-05}}, "episode_return_min": 1046.9369851805304, "episode_len_mean": 1417.0, "agent_steps": {"human": 1417.0, "exo": 1417.0}, "episode_len_min": 1417, "episode_duration_sec_mean": 14.269061857333327, "sample": 15.291094052192696, "episode_return_mean": 1053.3646690448816, "module_episode_returns_mean": {"human_policy": 492.2601788488833, "exo_policy": 561.1044901959981}, "agent_episode_returns_mean": {"human": 492.2601788488833, "exo": 561.1044901959981}, "num_episodes": 2, "num_env_steps_sampled": 2834, "num_module_steps_sampled_lifetime": {"human_policy": 8502, "exo_policy": 8502}, "episode_len_max": 1417, "episode_return_max": 1062.3786543446686, "env_to_module_sum_episodes_length_out": 2621.831824891575, "weights_seq_no": 2.0, "connector_pipeline_timer": 0.0005686298899627219, "env_reset_timer": 0.041851180001898955, "time_between_sampling": 3.3238792128496604, "num_env_steps_sampled_lifetime_throughput": 169.19061607905758}, "learners": {"exo_policy": {"policy_loss": -0.041854843497276306, "num_module_steps_trained_lifetime": 85248, "num_trainable_parameters": 135429, "num_module_steps_trained": 28416, "module_train_batch_size_mean": 128.0, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.025972802191972733, "entropy": 2.9355809688568115, "total_loss": 8.217314720153809, "curr_kl_coeff": 0.675000011920929, "weights_seq_no": 3.0, "vf_loss": 8.247482299804688, "default_optimizer_learning_rate": 0.0005, "vf_explained_var": 0.20469415187835693, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 666.0028076171875, "num_module_steps_trained_lifetime_throughput": 1699.4127220337493}, "__all_modules__": {"num_module_steps_trained_lifetime": 170496, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.2084005926212474, "general_advantage_estimation": 0.027922301756381922, "add_states_from_episodes_to_batch": 9.658032835113773e-06, "add_columns_from_episodes_to_train_batch": 0.08605141957496379, "add_time_dim_to_batch_and_zero_pad": 3.947707888360127e-05, "add_observations_from_episodes_to_batch": 7.493939499049701e-05, "numpy_to_tensor": 0.00028125267512905337, "agent_to_module_mapping": 0.004790758361246207, "add_one_ts_to_episodes_and_truncate": 0.007194903879889534}}, "connector_pipeline_timer": 0.33545521320894484}, "learner_connector_sum_episodes_length_in": 2834.0, "num_trainable_parameters": 445130, "num_env_steps_trained": 629148, "num_non_trainable_parameters": 0, "num_module_steps_trained": 56832, "learner_connector_sum_episodes_length_out": 2834.0, "num_env_steps_trained_lifetime": 1887444, "num_env_steps_trained_lifetime_throughput": 37626.23909478098, "num_module_steps_trained_lifetime_throughput": 3398.822717256037}, "human_policy": {"policy_loss": -0.11777683347463608, "num_module_steps_trained_lifetime": 85248, "num_module_steps_trained": 28416, "module_train_batch_size_mean": 128.0, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.10170971602201462, "entropy": 139.46844482421875, "total_loss": 7.37600564956665, "curr_kl_coeff": 0.675000011920929, "weights_seq_no": 3.0, "vf_loss": 7.4480133056640625, "default_optimizer_learning_rate": 0.0005, "vf_explained_var": 0.450711190700531, "num_trainable_parameters": 309701, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 273.9653015136719, "num_module_steps_trained_lifetime_throughput": 1699.4131048854008}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 8502, "fault_tolerance": {"num_healthy_workers": 1, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 1}, "done": false, "training_iteration": 3, "trial_id": "89bba_00001", "date": "2025-11-20_15-29-45", "timestamp": 1763623785, "time_this_iter_s": 16.702067375183105, "time_total_s": 52.35074210166931, "pid": 35679, "hostname": "CS-ubuntu", "node_ip": "10.207.136.136", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MARL_EXO_ENV", "env_config": {"render_mode": "human", "render_bool": false, "frame_skip": 2, "model_path": "/home/chenshuo/PycharmProjects/move_sim/SMPL/data/xml/mj_fullbody_with_exo_carrying_policy_test.xml", "n_stacks": 1, "human_obs_keys": ["qpos", "local_body_pos", "local_body_vel", "local_body_rot_obs", "local_body_angle_vel"], "exo_obs_keys": ["exo_joint_t", "exo_joint_vel_t"], "weighted_reward_keys": {"w_pos_err": 0.5, "w_proprio_err": 0.4, "w_activation": 0.4, "w_exo_energy": 0.2, "w_exo_smooth": 0.2, "theta_pos_err": 0.5, "theta_proprio_err": 0.3, "theta_activation": 0.1, "theta_exo_energy": 0.1, "theta_exo_smooth": 4}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 2, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 120, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 128, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f093060fac0>", "policies_to_train": ["human_policy", "exo_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"human_policy": [null, "Box(-inf, inf, (248,), float32)", "Box(0.0, 1.0, (98,), float32)", {"model": {"custom_model": "human_model"}}], "exo_policy": [null, "Box(-10.0, 10.0, (4,), float32)", "Box(-0.261799, 2.0944, (2,), float32)", {"model": {"custom_model": "exo_model"}}]}, "callbacks": "<class 'SMPL.src.Custom_CallBack.RewardLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 52.35074210166931, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 17.66363636363636, "ram_util_percent": 65.92727272727274, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.001953125}}
{"timers": {"training_iteration": 18.57385968500596, "restore_env_runners": 2.1485163243107764e-05, "training_step": 18.57355694907448, "env_runner_sampling_timer": 15.303776994920947, "learner_update_timer": 3.2663883811038987, "synch_weights": 0.00271151735442058, "synch_env_connectors": 0.0015670318598321046}, "env_runners": {"env_to_module_sum_episodes_length_in": 2621.831824891575, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.246003328251325e-05, "add_time_dim_to_batch_and_zero_pad": 1.910073802878484e-05, "agent_to_module_mapping": 8.531900883660546e-06, "numpy_to_tensor": 9.201248641838962e-05, "add_states_from_episodes_to_batch": 7.735303228659177e-06, "batch_individual_items": 4.278154602071612e-05}}, "connector_pipeline_timer": 0.00029764356582290665}, "rlmodule_inference_timer": 0.00048807678439481445, "num_agent_steps_sampled_lifetime": {"human": 11336, "exo": 11336}, "num_module_steps_sampled": {"human_policy": 2834, "exo_policy": 2834}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.0003226411920051038, "remove_single_ts_time_rank_from_batch": 2.365849840289732e-06, "un_batch_to_individual_items": 4.6561315221509624e-05, "listify_data_for_vector_env": 1.8949595427549237e-05, "normalize_and_clip_actions": 0.00016955894707277127, "tensor_to_numpy": 8.129363251355889e-05, "module_to_agent_unmapping": 5.682000035677133e-06}}, "connector_pipeline_timer": 0.0007539809138082354}, "num_episodes_lifetime": 8, "num_env_steps_sampled_lifetime": 11336, "num_agent_steps_sampled": {"human": 2834, "exo": 2834}, "custom": {"human": {"R_a_mean": 0.009142630697879926, "R_proprio_mean": 0.1159935217737044, "R_p_mean": 0.22172027239915612}, "exo": {"R_t_mean": 0.029352531476207415, "R_eas_mean": 0.01954537965096924}}, "env_step_timer": 0.0052441738668984675, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.223440087914878e-05, "add_observations_from_episodes_to_batch": 6.286975815237155e-05, "agent_to_module_mapping": 9.224904536655684e-06, "numpy_to_tensor": 0.00010681474273206686, "add_states_from_episodes_to_batch": 8.368582615028118e-06, "batch_individual_items": 5.160138730111521e-05}}, "episode_return_min": 1041.8770585524194, "episode_len_mean": 1417.0, "agent_steps": {"human": 1417.0, "exo": 1417.0}, "episode_len_min": 1417, "episode_duration_sec_mean": 14.150079603749987, "sample": 15.276965014780766, "episode_return_mean": 1052.2794481508877, "module_episode_returns_mean": {"human_policy": 491.4955540418393, "exo_policy": 560.7838941090483}, "agent_episode_returns_mean": {"human": 491.4955540418393, "exo": 560.7838941090483}, "num_episodes": 2, "num_env_steps_sampled": 2834, "num_module_steps_sampled_lifetime": {"human_policy": 11336, "exo_policy": 11336}, "episode_len_max": 1417, "episode_return_max": 1062.3786543446686, "env_to_module_sum_episodes_length_out": 2621.831824891575, "weights_seq_no": 3.0, "connector_pipeline_timer": 0.0005661060210612504, "env_reset_timer": 0.04177749650187884, "time_between_sampling": 3.3204905927511605, "num_env_steps_sampled_lifetime_throughput": 169.13550849429092}, "learners": {"exo_policy": {"policy_loss": -0.025877900421619415, "num_module_steps_trained_lifetime": 113664, "num_trainable_parameters": 135429, "num_module_steps_trained": 28416, "module_train_batch_size_mean": 128.0, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.01980239525437355, "entropy": 3.0657811164855957, "total_loss": 7.968360900878906, "curr_kl_coeff": 0.675000011920929, "weights_seq_no": 4.0, "vf_loss": 7.98087215423584, "default_optimizer_learning_rate": 0.0005, "vf_explained_var": 0.20997726917266846, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 650.6446533203125, "num_module_steps_trained_lifetime_throughput": 1698.0329595720243}, "__all_modules__": {"num_module_steps_trained_lifetime": 227328, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.20855340384503607, "general_advantage_estimation": 0.02787982976881997, "add_states_from_episodes_to_batch": 9.648322506667227e-06, "add_columns_from_episodes_to_train_batch": 0.08597107518921433, "add_time_dim_to_batch_and_zero_pad": 3.937765809543497e-05, "add_observations_from_episodes_to_batch": 7.49228710436405e-05, "numpy_to_tensor": 0.0002804583283759939, "agent_to_module_mapping": 0.004788110867634483, "add_one_ts_to_episodes_and_truncate": 0.007166972901088691}}, "connector_pipeline_timer": 0.33545004463685374}, "learner_connector_sum_episodes_length_in": 2834.0, "num_trainable_parameters": 445130, "num_env_steps_trained": 629148, "num_non_trainable_parameters": 0, "num_module_steps_trained": 56832, "learner_connector_sum_episodes_length_out": 2834.0, "num_env_steps_trained_lifetime": 2516592, "num_env_steps_trained_lifetime_throughput": 37595.677897021196, "num_module_steps_trained_lifetime_throughput": 3396.06339361973}, "human_policy": {"policy_loss": -0.17699240148067474, "num_module_steps_trained_lifetime": 113664, "num_module_steps_trained": 28416, "module_train_batch_size_mean": 128.0, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.08091402798891068, "entropy": 139.41661071777344, "total_loss": 7.749093055725098, "curr_kl_coeff": 1.0125000476837158, "weights_seq_no": 4.0, "vf_loss": 7.871468544006348, "default_optimizer_learning_rate": 0.0005, "vf_explained_var": 0.5082985758781433, "num_trainable_parameters": 309701, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 269.00537109375, "num_module_steps_trained_lifetime_throughput": 1698.0333102780141}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 11336, "fault_tolerance": {"num_healthy_workers": 1, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 1}, "done": false, "training_iteration": 4, "trial_id": "89bba_00001", "date": "2025-11-20_15-30-02", "timestamp": 1763623802, "time_this_iter_s": 16.97966766357422, "time_total_s": 69.33040976524353, "pid": 35679, "hostname": "CS-ubuntu", "node_ip": "10.207.136.136", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MARL_EXO_ENV", "env_config": {"render_mode": "human", "render_bool": false, "frame_skip": 2, "model_path": "/home/chenshuo/PycharmProjects/move_sim/SMPL/data/xml/mj_fullbody_with_exo_carrying_policy_test.xml", "n_stacks": 1, "human_obs_keys": ["qpos", "local_body_pos", "local_body_vel", "local_body_rot_obs", "local_body_angle_vel"], "exo_obs_keys": ["exo_joint_t", "exo_joint_vel_t"], "weighted_reward_keys": {"w_pos_err": 0.5, "w_proprio_err": 0.4, "w_activation": 0.4, "w_exo_energy": 0.2, "w_exo_smooth": 0.2, "theta_pos_err": 0.5, "theta_proprio_err": 0.3, "theta_activation": 0.1, "theta_exo_energy": 0.1, "theta_exo_smooth": 4}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 2, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 120, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 128, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f093063bd00>", "policies_to_train": ["human_policy", "exo_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"human_policy": [null, "Box(-inf, inf, (248,), float32)", "Box(0.0, 1.0, (98,), float32)", {"model": {"custom_model": "human_model"}}], "exo_policy": [null, "Box(-10.0, 10.0, (4,), float32)", "Box(-0.261799, 2.0944, (2,), float32)", {"model": {"custom_model": "exo_model"}}]}, "callbacks": "<class 'SMPL.src.Custom_CallBack.RewardLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 69.33040976524353, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 17.127272727272725, "ram_util_percent": 66.02727272727272, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.001953125}}
{"timers": {"training_iteration": 18.554817311775903, "restore_env_runners": 2.144604160763072e-05, "training_step": 18.55451274509373, "env_runner_sampling_timer": 15.287688861901735, "learner_update_timer": 3.263435829362861, "synch_weights": 0.0027057415008774352, "synch_env_connectors": 0.0015692038112329477}, "env_runners": {"env_to_module_sum_episodes_length_in": 2621.831824891575, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.255321052457016e-05, "add_time_dim_to_batch_and_zero_pad": 1.9528220538213746e-05, "agent_to_module_mapping": 8.626193028652033e-06, "numpy_to_tensor": 9.030068627289954e-05, "add_states_from_episodes_to_batch": 7.730097340567575e-06, "batch_individual_items": 4.2713362235441494e-05}}, "connector_pipeline_timer": 0.00029673728829264967}, "rlmodule_inference_timer": 0.0004865990058206297, "num_agent_steps_sampled_lifetime": {"human": 14170, "exo": 14170}, "num_module_steps_sampled": {"human_policy": 2834, "exo_policy": 2834}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.00032184579760668894, "remove_single_ts_time_rank_from_batch": 2.4036092189744796e-06, "un_batch_to_individual_items": 4.68324802645323e-05, "listify_data_for_vector_env": 1.8826143247961828e-05, "normalize_and_clip_actions": 0.0001717604203752358, "tensor_to_numpy": 8.124563421915904e-05, "module_to_agent_unmapping": 5.781170672540306e-06}}, "connector_pipeline_timer": 0.0007561501132926728}, "num_episodes_lifetime": 10, "num_env_steps_sampled_lifetime": 14170, "num_agent_steps_sampled": {"human": 2834, "exo": 2834}, "custom": {"human": {"R_a_mean": 0.009140990357435076, "R_proprio_mean": 0.11569823362353648, "R_p_mean": 0.22172735215351058}, "exo": {"R_t_mean": 0.02938226538929186, "R_eas_mean": 0.020102705841712046}}, "env_step_timer": 0.005285475346076819, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.220912686900595e-05, "add_observations_from_episodes_to_batch": 6.278037056996028e-05, "agent_to_module_mapping": 9.212505492673457e-06, "numpy_to_tensor": 0.0001066123153034745, "add_states_from_episodes_to_batch": 8.361436788886954e-06, "batch_individual_items": 5.1496843428576095e-05}}, "episode_return_min": 1041.8770585524194, "episode_len_mean": 1417.0, "agent_steps": {"human": 1417.0, "exo": 1417.0}, "episode_len_min": 1417, "episode_duration_sec_mean": 14.037025255799971, "sample": 15.260924487972954, "episode_return_mean": 1052.289880999455, "module_episode_returns_mean": {"human_policy": 491.08483838256126, "exo_policy": 561.2050426168937}, "agent_episode_returns_mean": {"human": 491.08483838256126, "exo": 561.2050426168937}, "num_episodes": 2, "num_env_steps_sampled": 2834, "num_module_steps_sampled_lifetime": {"human_policy": 14170, "exo_policy": 14170}, "episode_len_max": 1417, "episode_return_max": 1062.3786543446686, "env_to_module_sum_episodes_length_out": 2621.831824891575, "weights_seq_no": 4.0, "connector_pipeline_timer": 0.000563464720847825, "env_reset_timer": 0.041712996106862264, "time_between_sampling": 3.3184807455736482, "num_env_steps_sampled_lifetime_throughput": 169.11568676947465}, "learners": {"exo_policy": {"policy_loss": 0.045483700931072235, "num_module_steps_trained_lifetime": 142080, "num_trainable_parameters": 135429, "num_module_steps_trained": 28416, "module_train_batch_size_mean": 128.0, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.01793062500655651, "entropy": 3.096041679382324, "total_loss": 8.160935401916504, "curr_kl_coeff": 0.675000011920929, "weights_seq_no": 5.0, "vf_loss": 8.103349685668945, "default_optimizer_learning_rate": 0.0005, "vf_explained_var": 0.1192139983177185, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 645.7858276367188, "num_module_steps_trained_lifetime_throughput": 1698.24352264079}, "__all_modules__": {"num_module_steps_trained_lifetime": 284160, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.20697315290658236, "general_advantage_estimation": 0.027842104431129607, "add_states_from_episodes_to_batch": 9.643709283197826e-06, "add_columns_from_episodes_to_train_batch": 0.08596633389732367, "add_time_dim_to_batch_and_zero_pad": 3.9294161516421176e-05, "add_observations_from_episodes_to_batch": 7.530025233323254e-05, "numpy_to_tensor": 0.0002797812350940737, "agent_to_module_mapping": 0.004785894398955224, "add_one_ts_to_episodes_and_truncate": 0.007170998242077515}}, "connector_pipeline_timer": 0.33382538334048323}, "learner_connector_sum_episodes_length_in": 2834.0, "num_trainable_parameters": 445130, "num_env_steps_trained": 629148, "num_non_trainable_parameters": 0, "num_module_steps_trained": 56832, "learner_connector_sum_episodes_length_out": 2834.0, "num_env_steps_trained_lifetime": 3145740, "num_env_steps_trained_lifetime_throughput": 37600.33234043281, "num_module_steps_trained_lifetime_throughput": 3396.4846339803935}, "human_policy": {"policy_loss": -0.09690472483634949, "num_module_steps_trained_lifetime": 142080, "num_module_steps_trained": 28416, "module_train_batch_size_mean": 128.0, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.05856554955244064, "entropy": 139.69967651367188, "total_loss": 6.895997047424316, "curr_kl_coeff": 1.5187500715255737, "weights_seq_no": 5.0, "vf_loss": 6.933604717254639, "default_optimizer_learning_rate": 0.0005, "vf_explained_var": 0.5776897668838501, "num_trainable_parameters": 309701, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 144.10202026367188, "num_module_steps_trained_lifetime_throughput": 1698.2438614811222}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 14170, "fault_tolerance": {"num_healthy_workers": 1, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 1}, "done": false, "training_iteration": 5, "trial_id": "89bba_00001", "date": "2025-11-20_15-30-19", "timestamp": 1763623819, "time_this_iter_s": 16.67472529411316, "time_total_s": 86.00513505935669, "pid": 35679, "hostname": "CS-ubuntu", "node_ip": "10.207.136.136", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MARL_EXO_ENV", "env_config": {"render_mode": "human", "render_bool": false, "frame_skip": 2, "model_path": "/home/chenshuo/PycharmProjects/move_sim/SMPL/data/xml/mj_fullbody_with_exo_carrying_policy_test.xml", "n_stacks": 1, "human_obs_keys": ["qpos", "local_body_pos", "local_body_vel", "local_body_rot_obs", "local_body_angle_vel"], "exo_obs_keys": ["exo_joint_t", "exo_joint_vel_t"], "weighted_reward_keys": {"w_pos_err": 0.5, "w_proprio_err": 0.4, "w_activation": 0.4, "w_exo_energy": 0.2, "w_exo_smooth": 0.2, "theta_pos_err": 0.5, "theta_proprio_err": 0.3, "theta_activation": 0.1, "theta_exo_energy": 0.1, "theta_exo_smooth": 4}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 2, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 120, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 128, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f09304c84c0>", "policies_to_train": ["human_policy", "exo_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"human_policy": [null, "Box(-inf, inf, (248,), float32)", "Box(0.0, 1.0, (98,), float32)", {"model": {"custom_model": "human_model"}}], "exo_policy": [null, "Box(-10.0, 10.0, (4,), float32)", "Box(-0.261799, 2.0944, (2,), float32)", {"model": {"custom_model": "exo_model"}}]}, "callbacks": "<class 'SMPL.src.Custom_CallBack.RewardLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 86.00513505935669, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 17.872727272727275, "ram_util_percent": 65.97272727272728, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.001953125}}
{"timers": {"training_iteration": 18.533891914468146, "restore_env_runners": 2.1400301189882427e-05, "training_step": 18.533586478512795, "env_runner_sampling_timer": 15.27031004548272, "learner_update_timer": 3.25989331694923, "synch_weights": 0.002700139735871851, "synch_env_connectors": 0.0015696953231218056}, "env_runners": {"env_to_module_sum_episodes_length_in": 2621.831824891575, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.120545953080589e-05, "add_time_dim_to_batch_and_zero_pad": 1.8969160347535394e-05, "agent_to_module_mapping": 8.546612041033008e-06, "numpy_to_tensor": 8.960724759473421e-05, "add_states_from_episodes_to_batch": 7.508977117197869e-06, "batch_individual_items": 4.244661546548359e-05}}, "connector_pipeline_timer": 0.0002924683474977404}, "rlmodule_inference_timer": 0.0004825333776157174, "num_agent_steps_sampled_lifetime": {"human": 17004, "exo": 17004}, "num_module_steps_sampled": {"human_policy": 2834, "exo_policy": 2834}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.0003214716046808691, "remove_single_ts_time_rank_from_batch": 2.3370891155920104e-06, "un_batch_to_individual_items": 4.631809713787527e-05, "listify_data_for_vector_env": 1.8712497530109457e-05, "normalize_and_clip_actions": 0.00016855592755627381, "tensor_to_numpy": 7.91737783806824e-05, "module_to_agent_unmapping": 5.654929607288159e-06}}, "connector_pipeline_timer": 0.0007483255411872239}, "num_episodes_lifetime": 12, "num_env_steps_sampled_lifetime": 17004, "num_agent_steps_sampled": {"human": 2834, "exo": 2834}, "custom": {"human": {"R_a_mean": 0.009132355870254233, "R_proprio_mean": 0.11609126648832546, "R_p_mean": 0.22179117023754477}, "exo": {"R_t_mean": 0.02932097823302325, "R_eas_mean": 0.02027644045026519}}, "env_step_timer": 0.0052100518193464625, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.2288595598976996e-05, "add_observations_from_episodes_to_batch": 6.280920686402163e-05, "agent_to_module_mapping": 9.208740440083862e-06, "numpy_to_tensor": 0.0001065549921503484, "add_states_from_episodes_to_batch": 8.363582423546424e-06, "batch_individual_items": 5.147619499170534e-05}}, "episode_return_min": 1041.8770585524194, "episode_len_mean": 1417.0, "agent_steps": {"human": 1417.0, "exo": 1417.0}, "episode_len_min": 1417, "episode_duration_sec_mean": 13.93773663449997, "sample": 15.243612647803225, "episode_return_mean": 1053.7194644916365, "module_episode_returns_mean": {"human_policy": 491.71996110870833, "exo_policy": 561.9995033829281}, "agent_episode_returns_mean": {"human": 491.71996110870833, "exo": 561.9995033829281}, "num_episodes": 2, "num_env_steps_sampled": 2834, "num_module_steps_sampled_lifetime": {"human_policy": 17004, "exo_policy": 17004}, "episode_len_max": 1417, "episode_return_max": 1064.7884614000072, "env_to_module_sum_episodes_length_out": 2621.831824891575, "weights_seq_no": 5.0, "connector_pipeline_timer": 0.0005614681036373477, "env_reset_timer": 0.041646444595795744, "time_between_sampling": 3.3156211126079156, "num_env_steps_sampled_lifetime_throughput": 169.21632011063784}, "learners": {"exo_policy": {"policy_loss": 0.003967639058828354, "num_module_steps_trained_lifetime": 170496, "num_trainable_parameters": 135429, "num_module_steps_trained": 28416, "module_train_batch_size_mean": 128.0, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.009209204465150833, "entropy": 3.16095232963562, "total_loss": 7.1531877517700195, "curr_kl_coeff": 0.675000011920929, "weights_seq_no": 6.0, "vf_loss": 7.143004894256592, "default_optimizer_learning_rate": 0.0005, "vf_explained_var": 0.22337687015533447, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 573.267333984375, "num_module_steps_trained_lifetime_throughput": 1699.4488086927895}, "__all_modules__": {"num_module_steps_trained_lifetime": 340992, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.20540168234751474, "general_advantage_estimation": 0.027810652306818968, "add_states_from_episodes_to_batch": 9.646262189425843e-06, "add_columns_from_episodes_to_train_batch": 0.08593469854835135, "add_time_dim_to_batch_and_zero_pad": 3.920839990414895e-05, "add_observations_from_episodes_to_batch": 7.52834298097764e-05, "numpy_to_tensor": 0.000278912532741988, "agent_to_module_mapping": 0.00478271807496613, "add_one_ts_to_episodes_and_truncate": 0.007145695799659941}}, "connector_pipeline_timer": 0.3321574751970779}, "learner_connector_sum_episodes_length_in": 2834.0, "num_trainable_parameters": 445130, "num_env_steps_trained": 629148, "num_non_trainable_parameters": 0, "num_module_steps_trained": 56832, "learner_connector_sum_episodes_length_out": 2834.0, "num_env_steps_trained_lifetime": 3774888, "num_env_steps_trained_lifetime_throughput": 37627.01124326584, "num_module_steps_trained_lifetime_throughput": 3398.895276654726}, "human_policy": {"policy_loss": -0.11781851947307587, "num_module_steps_trained_lifetime": 170496, "num_module_steps_trained": 28416, "module_train_batch_size_mean": 128.0, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.0424533411860466, "entropy": 139.5839385986328, "total_loss": 5.779403209686279, "curr_kl_coeff": 2.278125047683716, "weights_seq_no": 6.0, "vf_loss": 5.832746505737305, "default_optimizer_learning_rate": 0.0005, "vf_explained_var": 0.543060839176178, "num_trainable_parameters": 309701, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 159.00498962402344, "num_module_steps_trained_lifetime_throughput": 1699.4491402685178}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 17004, "fault_tolerance": {"num_healthy_workers": 1, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 1}, "done": false, "training_iteration": 6, "trial_id": "89bba_00001", "date": "2025-11-20_15-30-35", "timestamp": 1763623835, "time_this_iter_s": 16.467451572418213, "time_total_s": 102.4725866317749, "pid": 35679, "hostname": "CS-ubuntu", "node_ip": "10.207.136.136", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MARL_EXO_ENV", "env_config": {"render_mode": "human", "render_bool": false, "frame_skip": 2, "model_path": "/home/chenshuo/PycharmProjects/move_sim/SMPL/data/xml/mj_fullbody_with_exo_carrying_policy_test.xml", "n_stacks": 1, "human_obs_keys": ["qpos", "local_body_pos", "local_body_vel", "local_body_rot_obs", "local_body_angle_vel"], "exo_obs_keys": ["exo_joint_t", "exo_joint_vel_t"], "weighted_reward_keys": {"w_pos_err": 0.5, "w_proprio_err": 0.4, "w_activation": 0.4, "w_exo_energy": 0.2, "w_exo_smooth": 0.2, "theta_pos_err": 0.5, "theta_proprio_err": 0.3, "theta_activation": 0.1, "theta_exo_energy": 0.1, "theta_exo_smooth": 4}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 2, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 120, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 128, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f0930638160>", "policies_to_train": ["human_policy", "exo_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"human_policy": [null, "Box(-inf, inf, (248,), float32)", "Box(0.0, 1.0, (98,), float32)", {"model": {"custom_model": "human_model"}}], "exo_policy": [null, "Box(-10.0, 10.0, (4,), float32)", "Box(-0.261799, 2.0944, (2,), float32)", {"model": {"custom_model": "exo_model"}}]}, "callbacks": "<class 'SMPL.src.Custom_CallBack.RewardLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 102.4725866317749, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 17.563636363636363, "ram_util_percent": 64.76363636363637, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.001953125}}
{"timers": {"training_iteration": 18.519904906563465, "restore_env_runners": 2.135341817958984e-05, "training_step": 18.51959864689767, "env_runner_sampling_timer": 15.258655906867894, "learner_update_timer": 3.2575552065597386, "synch_weights": 0.002703347398513876, "synch_env_connectors": 0.0015708020898906857}, "env_runners": {"env_to_module_sum_episodes_length_in": 2621.831824891575, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.2593478348645976e-05, "add_time_dim_to_batch_and_zero_pad": 1.9353293699888028e-05, "agent_to_module_mapping": 8.57245658026664e-06, "numpy_to_tensor": 9.209301937612324e-05, "add_states_from_episodes_to_batch": 7.618706659952218e-06, "batch_individual_items": 4.334648974329881e-05}}, "connector_pipeline_timer": 0.00029980454985490133}, "rlmodule_inference_timer": 0.000516943261235481, "num_agent_steps_sampled_lifetime": {"human": 19838, "exo": 19838}, "num_module_steps_sampled": {"human_policy": 2834, "exo_policy": 2834}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.0003287159825900456, "remove_single_ts_time_rank_from_batch": 2.3738123888074694e-06, "un_batch_to_individual_items": 4.720569669649799e-05, "listify_data_for_vector_env": 1.908774822256361e-05, "normalize_and_clip_actions": 0.00017329550256271558, "tensor_to_numpy": 8.17486553405795e-05, "module_to_agent_unmapping": 5.807727487258346e-06}}, "connector_pipeline_timer": 0.0007669085088486283}, "num_episodes_lifetime": 14, "num_env_steps_sampled_lifetime": 19838, "num_agent_steps_sampled": {"human": 2834, "exo": 2834}, "custom": {"human": {"R_a_mean": 0.009142492840810467, "R_proprio_mean": 0.11608142368706031, "R_p_mean": 0.22178975470131673}, "exo": {"R_t_mean": 0.029310493684581766, "R_eas_mean": 0.020238102927140116}}, "env_step_timer": 0.005344385455396483, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.225726964533666e-05, "add_observations_from_episodes_to_batch": 6.296458479536898e-05, "agent_to_module_mapping": 9.197703033471818e-06, "numpy_to_tensor": 0.00010626980222988968, "add_states_from_episodes_to_batch": 8.353286601329045e-06, "batch_individual_items": 5.138513304025243e-05}}, "episode_return_min": 1041.8770585524194, "episode_len_mean": 1417.0, "agent_steps": {"human": 1417.0, "exo": 1417.0}, "episode_len_min": 1417, "episode_duration_sec_mean": 13.946108002142832, "sample": 15.232023563925194, "episode_return_mean": 1053.6471056623272, "module_episode_returns_mean": {"human_policy": 491.7183721317587, "exo_policy": 561.9287335305686}, "agent_episode_returns_mean": {"human": 491.7183721317587, "exo": 561.9287335305686}, "num_episodes": 2, "num_env_steps_sampled": 2834, "num_module_steps_sampled_lifetime": {"human_policy": 19838, "exo_policy": 19838}, "episode_len_max": 1417, "episode_return_max": 1064.7884614000072, "env_to_module_sum_episodes_length_out": 2621.831824891575, "weights_seq_no": 6.0, "connector_pipeline_timer": 0.0005590662426028375, "env_reset_timer": 0.0415891159598371, "time_between_sampling": 3.3120419981318365, "num_env_steps_sampled_lifetime_throughput": 169.06998634691806}, "learners": {"exo_policy": {"policy_loss": 0.008948247879743576, "num_module_steps_trained_lifetime": 198912, "num_trainable_parameters": 135429, "num_module_steps_trained": 28416, "module_train_batch_size_mean": 128.0, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.005780128296464682, "entropy": 3.21928334236145, "total_loss": 7.5887651443481445, "curr_kl_coeff": 0.675000011920929, "weights_seq_no": 7.0, "vf_loss": 7.575915336608887, "default_optimizer_learning_rate": 0.0005, "vf_explained_var": 0.3144628405570984, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 495.50177001953125, "num_module_steps_trained_lifetime_throughput": 1697.2759753706582}, "__all_modules__": {"num_module_steps_trained_lifetime": 397824, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.2038577503040382, "general_advantage_estimation": 0.02780839750374895, "add_states_from_episodes_to_batch": 9.646489568177632e-06, "add_columns_from_episodes_to_train_batch": 0.08587277059286798, "add_time_dim_to_batch_and_zero_pad": 3.911868590429743e-05, "add_observations_from_episodes_to_batch": 7.54690555142228e-05, "numpy_to_tensor": 0.00027849685741643715, "agent_to_module_mapping": 0.004780321414215641, "add_one_ts_to_episodes_and_truncate": 0.007131214611661985}}, "connector_pipeline_timer": 0.3305285897651051}, "learner_connector_sum_episodes_length_in": 2834.0, "num_trainable_parameters": 445130, "num_env_steps_trained": 629148, "num_non_trainable_parameters": 0, "num_module_steps_trained": 56832, "learner_connector_sum_episodes_length_out": 2834.0, "num_env_steps_trained_lifetime": 4404036, "num_env_steps_trained_lifetime_throughput": 37578.900528590144, "num_module_steps_trained_lifetime_throughput": 3394.5497065491654}, "human_policy": {"policy_loss": -0.0942898616194725, "num_module_steps_trained_lifetime": 198912, "num_module_steps_trained": 28416, "module_train_batch_size_mean": 128.0, "curr_entropy_coeff": 0.0, "mean_kl_loss": 0.030361302196979523, "entropy": 139.7487030029297, "total_loss": 5.370602607727051, "curr_kl_coeff": 3.4171876907348633, "weights_seq_no": 7.0, "vf_loss": 5.395726203918457, "default_optimizer_learning_rate": 0.0005, "vf_explained_var": 0.6764228940010071, "num_trainable_parameters": 309701, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 79.04389953613281, "num_module_steps_trained_lifetime_throughput": 1697.2762861116917}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 19838, "fault_tolerance": {"num_healthy_workers": 1, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 1}, "done": true, "training_iteration": 7, "trial_id": "89bba_00001", "date": "2025-11-20_15-30-52", "timestamp": 1763623852, "time_this_iter_s": 17.140204429626465, "time_total_s": 119.61279106140137, "pid": 35679, "hostname": "CS-ubuntu", "node_ip": "10.207.136.136", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MARL_EXO_ENV", "env_config": {"render_mode": "human", "render_bool": false, "frame_skip": 2, "model_path": "/home/chenshuo/PycharmProjects/move_sim/SMPL/data/xml/mj_fullbody_with_exo_carrying_policy_test.xml", "n_stacks": 1, "human_obs_keys": ["qpos", "local_body_pos", "local_body_vel", "local_body_rot_obs", "local_body_angle_vel"], "exo_obs_keys": ["exo_joint_t", "exo_joint_vel_t"], "weighted_reward_keys": {"w_pos_err": 0.5, "w_proprio_err": 0.4, "w_activation": 0.4, "w_exo_energy": 0.2, "w_exo_smooth": 0.2, "theta_pos_err": 0.5, "theta_proprio_err": 0.3, "theta_activation": 0.1, "theta_exo_energy": 0.1, "theta_exo_smooth": 4}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 1, "create_local_env_runner": true, "num_envs_per_env_runner": 2, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 120, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 128, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f09304cbeb0>", "policies_to_train": ["human_policy", "exo_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"human_policy": [null, "Box(-inf, inf, (248,), float32)", "Box(0.0, 1.0, (98,), float32)", {"model": {"custom_model": "human_model"}}], "exo_policy": [null, "Box(-10.0, 10.0, (4,), float32)", "Box(-0.261799, 2.0944, (2,), float32)", {"model": {"custom_model": "exo_model"}}]}, "callbacks": "<class 'SMPL.src.Custom_CallBack.RewardLoggingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 119.61279106140137, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 18.821739130434786, "ram_util_percent": 64.71739130434783, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.001953125}}
