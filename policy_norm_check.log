======================================================================
ğŸ” æ£€æŸ¥ç­–ç•¥ä¸­çš„æ ‡å‡†åŒ–å®ç°
======================================================================


[EXO_POLICY]
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

âœ“ æ£€æŸ¥: learner_group/learner/rl_module/exo_policy/class_and_ctor_args.pkl
  ç±»: <class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>
  æ„é€ å‡½æ•°å‚æ•°æ•°é‡: 2

  å‚æ•° 0:

  å‚æ•° 1:
      observation_space: Box = Box(-10.0, 10.0, (8,), float32)
      action_space: Box = Box(-1.0, 1.0, (2,), float32)
      inference_only: bool = False
      learner_only: bool = False
      model_config: dict (1 ä¸ªé”®)
          vf_share_layers: bool = False
      catalog_class: type = <class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCa

âœ“ æ£€æŸ¥: learner_group/learner/rl_module/exo_policy/module_state.pkl
  æƒé‡æ•°é‡: 14
  æƒé‡åç§°:
    âœ“ [NORM] encoder.actor_encoder.net.mlp.0.bias
       encoder.actor_encoder.net.mlp.0.weight
    âœ“ [NORM] encoder.actor_encoder.net.mlp.2.bias
       encoder.actor_encoder.net.mlp.2.weight
    âœ“ [NORM] encoder.critic_encoder.net.mlp.0.bias
       encoder.critic_encoder.net.mlp.0.weight
    âœ“ [NORM] encoder.critic_encoder.net.mlp.2.bias
       encoder.critic_encoder.net.mlp.2.weight
    âœ“ [NORM] pi.log_std_clip_param_const
    âœ“ [NORM] pi.net.mlp.0.bias
       pi.net.mlp.0.weight
    âœ“ [NORM] vf.log_std_clip_param_const
    âœ“ [NORM] vf.net.mlp.0.bias
       vf.net.mlp.0.weight

  â­ å‘ç° 8 ä¸ªæ ‡å‡†åŒ–ç›¸å…³çš„æƒé‡ï¼

[HUMAN_POLICY]
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

âœ“ æ£€æŸ¥: learner_group/learner/rl_module/human_policy/class_and_ctor_args.pkl
  ç±»: <class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>
  æ„é€ å‡½æ•°å‚æ•°æ•°é‡: 2

  å‚æ•° 0:

  å‚æ•° 1:
      observation_space: Box = Box(-inf, inf, (496,), float32)
      action_space: Box = Box(-1.0, 1.0, (98,), float32)
      inference_only: bool = False
      learner_only: bool = False
      model_config: dict (1 ä¸ªé”®)
          vf_share_layers: bool = False
      catalog_class: type = <class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCa

âœ“ æ£€æŸ¥: learner_group/learner/rl_module/human_policy/module_state.pkl
  æƒé‡æ•°é‡: 14
  æƒé‡åç§°:
    âœ“ [NORM] encoder.actor_encoder.net.mlp.0.bias
       encoder.actor_encoder.net.mlp.0.weight
    âœ“ [NORM] encoder.actor_encoder.net.mlp.2.bias
       encoder.actor_encoder.net.mlp.2.weight
    âœ“ [NORM] encoder.critic_encoder.net.mlp.0.bias
       encoder.critic_encoder.net.mlp.0.weight
    âœ“ [NORM] encoder.critic_encoder.net.mlp.2.bias
       encoder.critic_encoder.net.mlp.2.weight
    âœ“ [NORM] pi.log_std_clip_param_const
    âœ“ [NORM] pi.net.mlp.0.bias
       pi.net.mlp.0.weight
    âœ“ [NORM] vf.log_std_clip_param_const
    âœ“ [NORM] vf.net.mlp.0.bias
       vf.net.mlp.0.weight

  â­ å‘ç° 8 ä¸ªæ ‡å‡†åŒ–ç›¸å…³çš„æƒé‡ï¼

======================================================================
ğŸ“ æ£€æŸ¥ custom_policy.py ä¸­çš„å®ç°
======================================================================

ğŸ” ä»£ç ä¸­çš„å…³é”®è¯æœç´¢:

âœ— [æ ‡å‡†åŒ–å®ç°] æœªå‘ç°
âœ“ [è¾“å…¥å¤„ç†] å‘ç°: ['input']
    ç¬¬ 23 è¡Œ: def forward(self, input_dict, state, seq_lens):
    ç¬¬ 25 è¡Œ: x = input_dict["obs_flat"]
    ç¬¬ 55 è¡Œ: def forward(self, input_dict, state, seq_lens):
    ç¬¬ 57 è¡Œ: x = input_dict["obs_flat"]
âœ— [ç»Ÿè®¡ä¿¡æ¯] æœªå‘ç°
âœ— [æ»¤æ³¢å™¨] æœªå‘ç°

âœ“ ç±»å®šä¹‰æ£€æŸ¥:
  âœ“ å‘ç°: class HumanModel
  âœ“ å‘ç°: class ExoModel
  âœ“ å‘ç°: def forward

======================================================================
ğŸŒ æ£€æŸ¥ç¯å¢ƒä¸­çš„æ ‡å‡†åŒ–
======================================================================

ğŸ” ç¯å¢ƒä¸­çš„æ–¹æ³•æ£€æŸ¥:

âœ“ å‘ç°æ–¹æ³•: reset()
  âš  å¯èƒ½åŒ…å«æ ‡å‡†åŒ–é€»è¾‘
âœ“ å‘ç°æ–¹æ³•: step()
  âš  å¯èƒ½åŒ…å«æ ‡å‡†åŒ–é€»è¾‘

âœ“ å…¨å±€æœç´¢æ ‡å‡†åŒ–å®ç°:

  ç¬¬ 144 è¡Œ: "human": gym.spaces.Box(low=-np.inf * np.ones(len(observations["human"])),
  ç¬¬ 145 è¡Œ: high=np.inf * np.ones(len(observations["human"])),
  ç¬¬ 147 è¡Œ: "exo": gym.spaces.Box(low = -10 * np.ones(len(observations["exo"])),
  ç¬¬ 148 è¡Œ: high = 10 * np.ones(len(observations["exo"])),
  ç¬¬ 286 è¡Œ: human_obs = self.get_obs(class_name="human",**kwargs)
  ç¬¬ 287 è¡Œ: exo_obs = self.get_obs(class_name="exo",**kwargs)
  ç¬¬ 332 è¡Œ: def get_obs(self,class_name=None, **kwargs):
  ç¬¬ 475 è¡Œ: obs_dict['qpos_error'] = obs_dict['qpos_gt'] - obs_dict['qpos']
  ç¬¬ 504 è¡Œ: (obs_dict['local_body_pos_gt'] - obs_dict['local_body_pos']).ravel(),
  ç¬¬ 505 è¡Œ: (obs_dict['local_body_rot_gt'] - obs_dict['local_body_rot_obs']).ravel(),
  ç¬¬ 506 è¡Œ: (obs_dict['local_body_vel_gt'] - obs_dict['local_body_vel']).ravel(),
  ç¬¬ 507 è¡Œ: (obs_dict['local_body_angle_vel_gt'] - obs_dict['local_body_angle_vel']).ravel()],
  ç¬¬ 540 è¡Œ: exo_smooth = np.sum((obs_dict['exo_joint_set_t'] - 2 * obs_dict['exo_joint_set_t1'] + obs_dict['exo_
  ç¬¬ 887 è¡Œ: - `root_h_obs`: Root height observation.
  ç¬¬ 889 è¡Œ: - `local_body_rot_obs`: Local body rotations in tangent-normalized format.
  ç¬¬ 928 è¡Œ: body_rot.shape[0], body_rot.shape[1] * flat_local_body_rot_obs.shape[1]
  ç¬¬ 934 è¡Œ: obs["local_body_vel"] = flat_local_body_vel.reshape(body_vel.shape[0], body_vel.shape[1] * body_vel.
  ç¬¬ 938 è¡Œ: obs["local_body_angle_vel"] = flat_local_body_ang_vel.reshape(body_ang_vel.shape[0], body_ang_vel.sh

======================================================================
ğŸ“Œ æ£€æŸ¥æ€»ç»“ä¸å»ºè®®
======================================================================


æ ¹æ®æ£€æŸ¥ç»“æœï¼Œæ ‡å‡†åŒ–å¯èƒ½å‡ºç°åœ¨ä»¥ä¸‹ä½ç½®ï¼š

â”Œâ”€ æƒ…å†µ A: æ ‡å‡†åŒ–åœ¨ç­–ç•¥ä¸­å®ç°
â”‚  â”œâ”€ è¡¨ç°: æƒé‡ä¸­åŒ…å« BatchNormã€LayerNorm ç­‰å±‚
â”‚  â”œâ”€ å½±å“: æ¨ç†æ—¶æ— éœ€é¢å¤–å¤„ç†
â”‚  â””â”€ éªŒè¯: æŸ¥çœ‹æƒé‡åç§°æ˜¯å¦åŒ…å« 'norm'
â”‚
â”œâ”€ æƒ…å†µ B: æ ‡å‡†åŒ–åœ¨ç¯å¢ƒä¸­å®ç°
â”‚  â”œâ”€ è¡¨ç°: MARL_env.py çš„ reset()/step() è¿”å›æ ‡å‡†åŒ–åçš„è§‚æµ‹å€¼
â”‚  â”œâ”€ å½±å“: æ¨ç†æ—¶éœ€è¦ä½¿ç”¨ç›¸åŒçš„æ ‡å‡†åŒ–é€»è¾‘
â”‚  â””â”€ éªŒè¯: æŸ¥çœ‹ç¯å¢ƒä»£ç çš„è§‚æµ‹å€¼å¤„ç†
â”‚
â””â”€ æƒ…å†µ C: æ— æ ‡å‡†åŒ–å¤„ç†
   â”œâ”€ è¡¨ç°: ç›´æ¥ä½¿ç”¨åŸå§‹è§‚æµ‹å€¼
   â”œâ”€ å½±å“: æ¨ç†æ—¶æ— éœ€ä»»ä½•å¤„ç†
   â””â”€ éªŒè¯: æƒé‡å’Œä»£ç ä¸­éƒ½æœªå‘ç°æ ‡å‡†åŒ–

ğŸ”§ ä¸‹ä¸€æ­¥å»ºè®®ï¼š

1ï¸âƒ£ å¦‚æœå‘ç°æƒé‡åŒ…å« 'norm':
   â””â”€ âœ“ æ¨ç†æ—¶æ— éœ€é¢å¤–å¤„ç†

2ï¸âƒ£ å¦‚æœç¯å¢ƒä»£ç åŒ…å«æ ‡å‡†åŒ–:
   â””â”€ éœ€è¦æå–å¹³å‡å€¼å’Œæ ‡å‡†å·®
   â””â”€ åœ¨æ¨ç†æ—¶åº”ç”¨ç›¸åŒçš„å˜æ¢

3ï¸âƒ£ å¦‚æœéƒ½æ²¡æœ‰å‘ç°:
   â””â”€ ç›´æ¥ä½¿ç”¨åŸå§‹è§‚æµ‹å€¼è¿›è¡Œæ¨ç†

